<!DOCTYPE html>
<html lang="en" ng-app="jpm">

	<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="/releases/5.3.0/css/style.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="/js/releases.js"></script>
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>-maven-release (‘local’ ‘remote’) ( ‘,’ option )* | bnd</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="-maven-release (‘local’ ‘remote’) ( ‘,’ option )*" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The -maven-release instruction provides the context for a release to Maven repository. In the Maven world it is customary that a release has a JAR with sources and a JAR with Javadoc. In the OSGi world this is unnecessary because the sources can be packaged inside the bundle. (Since the source is placed at a standard location, the IDEs can take advantage of this.) However, putting an artifact on Maven Central requires that these extra JARs are included. This instruction allows you to specify additional parameters for this release process." />
<meta property="og:description" content="The -maven-release instruction provides the context for a release to Maven repository. In the Maven world it is customary that a release has a JAR with sources and a JAR with Javadoc. In the OSGi world this is unnecessary because the sources can be packaged inside the bundle. (Since the source is placed at a standard location, the IDEs can take advantage of this.) However, putting an artifact on Maven Central requires that these extra JARs are included. This instruction allows you to specify additional parameters for this release process." />
<meta property="og:site_name" content="bnd" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="-maven-release (‘local’ ‘remote’) ( ‘,’ option )*" />
<script type="application/ld+json">
{"url":"/releases/5.3.0/instructions/maven-release.html","headline":"-maven-release (‘local’ ‘remote’) ( ‘,’ option )*","description":"The -maven-release instruction provides the context for a release to Maven repository. In the Maven world it is customary that a release has a JAR with sources and a JAR with Javadoc. In the OSGi world this is unnecessary because the sources can be packaged inside the bundle. (Since the source is placed at a standard location, the IDEs can take advantage of this.) However, putting an artifact on Maven Central requires that these extra JARs are included. This instruction allows you to specify additional parameters for this release process.","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

</head>


<body>

	
<ul class="container12 menu-bar">
	<li span=11><a class=menu-link href="/releases/5.3.0/"><img
			class=menu-logo src="/releases/5.3.0/img/bnd-80x40-white.png"></a>
			<a href="/releases/5.3.0/chapters/110-introduction.html">Intro
			</a><a href="/releases/5.3.0/chapters/800-headers.html">Headers
			</a><a href="/releases/5.3.0/chapters/825-instructions-ref.html">Instructions
			</a><a href="/releases/5.3.0/chapters/855-macros-ref.html">Macros
			</a><a href="/releases/5.3.0/chapters/400-commands.html">Commands
			</a><div class="releases"><button class="dropbtn">5.3.0</button><div class="dropdown-content"></div></div>
	<li class=menu-link span=1>
			<a href="https://github.com/bndtools/bnd" target="_"><img
	style="position:absolute;top:0;right:0;margin:0;padding:0;z-index:100"
	src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67"
	alt="Fork me on GitHub"
	data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
</ul>


					

	<ul class=container12>
		<li span=3>
			<div>
			<ul class="side-nav">
	
		
			<li><a href="/releases/5.3.0/chapters/110-introduction.html">Introduction</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/120-install.html">How to install bnd</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/123-tour-workspace.html">Guided Tour</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/125-tour-features.html">Guided Tour Workspace & Projects</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/130-concepts.html">Concepts</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/140-best-practices.html">Best practices</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/150-build.html">Build</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/155-project-setup.html">Project Setup</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/160-jars.html">Generating JARs</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/170-versioning.html">Versioning</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/180-baselining.html">Baselining</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/200-components.html">Service Components</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/210-metatype.html">Metatype</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/220-contracts.html">Contracts</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/230-manifest-annotations.html">Bundle Annotations</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/235-accessor-properties.html">Accessor Properties</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/240-spi-annotations.html">SPI Annotations</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/250-resolving.html">Resolving Dependencies</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/300-launching.html">Launching</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/305-startlevels.html">Startlevels</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/310-testing.html">Testing</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/315-launchpad-testing.html">Testing with Launchpad</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/320-packaging.html">Packaging Applications</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/330-jpms.html">JPMS Libraries</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/390-wrapping.html">Wrapping Libraries to OSGi Bundles</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/395-generating-documentation.html">Generating Documentation</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/400-commands.html">Commands</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/600-developer.html">For Developers</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/650-windows.html">Tips for Windows users</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/700-tools.html">Tools bound to bnd</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/800-headers.html">Headers</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/820-instructions.html">Instruction Reference</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/825-instructions-ref.html">Instruction Index</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/850-macros.html">Macro Reference</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/855-macros-ref.html">Macro Index</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/870-plugins.html">Plugins</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/875-external-plugins.html">External Plugins</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/880-settings.html">Settings</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/900-errors.html">Errors</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/910-warnings.html">Warnings</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/920-faq.html">Frequently Asked Questions</a>
	  	
  	
</ul>

			</div>
			
		<li span=9>
			<div class=notes-margin>
				<h1> -maven-release ('local'|'remote') ( ',' option )*</h1>
				<p>The <code class="language-plaintext highlighter-rouge">-maven-release</code> instruction provides the context for a release to Maven repository. In the Maven world it is customary that a release has a JAR with sources and a JAR with Javadoc. In the OSGi world this is unnecessary because the sources can be packaged inside the bundle. (Since the source is placed at a standard location, the IDEs can take advantage of this.) However, putting an artifact on Maven Central requires that these extra JARs are included. This instruction allows you to specify additional parameters for this release process.</p>

<p>Though this instruction is not specific for a plugin, it was developed in conjunction with the <a href="/plugins/maven">Maven Bnd Repository Plugin</a>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-maven-release ::= ( 'local'|'remote' ( ';' snapshot )? ) ( ',' option )*
snapshot       ::= &lt;value to be used for timestamp&gt;
option         ::= sources | javadoc | pom | sign
sources        ::= 'sources' 
                   ( ';path=' ( 'NONE' | PATH ) )?
                   ( ';force=' ( 'true' | 'false' ) )?
                   ( ';-sourcepath=' PATH ( ',' PATH )* )?
javadoc        ::= 'javadoc'
                   ( ';path=' ( 'NONE' | PATH ) )?
                   ( ';packages=' ( 'EXPORTS' | 'ALL' ) )?
                   ( ';force=' ( 'true' | 'false' ) )?
                   ( ';' javadoc-option )*
javadoc-option ::= '-' NAME '=' VALUE
pom            ::= 'pom'
                   ( ';path=' ( 'JAR' | PATH ) )?
sign            ::= 'sign'
                   ( ';passphrase=' VALUE )?
</code></pre></div></div>

<p>If <code class="language-plaintext highlighter-rouge">sources</code> or <code class="language-plaintext highlighter-rouge">javadoc</code> has the attribute <code class="language-plaintext highlighter-rouge">force=true</code>, either one will be release to the maven repository even if no <code class="language-plaintext highlighter-rouge">releaseUrl</code> or <code class="language-plaintext highlighter-rouge">snapshotUrl</code> is set or <code class="language-plaintext highlighter-rouge">maven-release=local</code>.</p>

<p>The <code class="language-plaintext highlighter-rouge">aQute.maven.bnd.MavenBndRepository</code> is a bnd plugin that represent the local and a remote Maven repository. The locations of both repositories can be configured. The local repository is always used as a cache for the remote repository.</p>

<p>The repository has the following parameters:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">url</code> – The remote repository URL. Credentials and proxy can be set with the [Http Client options]. The url should be the base url of a Maven repository. If no URL is configured, there is no remote repository.</li>
  <li><code class="language-plaintext highlighter-rouge">local</code>  – (<code class="language-plaintext highlighter-rouge">~/.m2/repository</code>) The location of the local repository. By default this is <code class="language-plaintext highlighter-rouge">~/.m2/repository</code>. It is not possible to not have a local repository because it acts as the cache.</li>
  <li><code class="language-plaintext highlighter-rouge">generate</code> – (<code class="language-plaintext highlighter-rouge">JAVADOC,SOURCES</code>) A combination of <code class="language-plaintext highlighter-rouge">JAVADOC</code> and/or <code class="language-plaintext highlighter-rouge">SOURCES</code>. If no <code class="language-plaintext highlighter-rouge">-maven-release</code> instruction is found and the released artifact contains source code, then the given classifiers are used to generate them.</li>
  <li><code class="language-plaintext highlighter-rouge">readOnly</code> – (<code class="language-plaintext highlighter-rouge">false</code>) Indicates if this is a read only repository</li>
  <li><code class="language-plaintext highlighter-rouge">name</code> – The name of the repository</li>
</ul>

<p>If the Maven Bnd Repository is asked to put a file, it will look up the <code class="language-plaintext highlighter-rouge">-maven-release</code> instruction using merged properties. The property is looked up from the bnd file that built the artifact. However, it should in general be possible to define this header in the workspace using macros like <code class="language-plaintext highlighter-rouge">${project}</code> to specify relative paths.</p>

<h1 id="signing">Signing</h1>

<p>If the instruction contains the sign attribute  and release build is detected the repository tries to apply <a href="https://gnupg.org/">gnupg</a> via a command process to create <code class="language-plaintext highlighter-rouge">.asc</code> files for all deployed artifacts. This requires a Version of <a href="https://gnupg.org/">gnupg</a> installed on your build system. By default it uses the <code class="language-plaintext highlighter-rouge">gpg</code> command. If the <code class="language-plaintext highlighter-rouge">passphrase</code> is configured, it will hand it over to the command as standard input. The command will be constructed as follows: <code class="language-plaintext highlighter-rouge">gpg --batch --passphrase-fd 0 --output &lt;filetosign&gt;.asc --detach-sign --armor &lt;filetosign&gt;</code>. Some newer gnupg versions will ignore the passphrase via standard input for the first try and ask again with password screen. This will crash the process. Have a look <a href="https://stackoverflow.com/questions/19895122/how-to-use-gnupgs-passphrase-fd-argument">here</a> to teach gnupg otherwise. The command can be exchanged or amended with additional options by defining a property named <code class="language-plaintext highlighter-rouge">gpg</code> in your workspace (e.g. <code class="language-plaintext highlighter-rouge">build.bnd</code> or somewhere in the ext directory).</p>

<p>Example config could look like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># use the env macro to avoid to set the passphrase somehwere in your project
-maven-release: pom,sign;passphrase=${env;GNUPG_PASSPHRASE}
gpg: gpg --homedir /mnt/n/tmp/gpg/.gnupg --pinentry-mode loopback
</code></pre></div></div>


			</div>
	</ul>

	
<nav class=next-prev>
	<a href='/releases/5.3.0/instructions/maven-dependencies.html'></a> <a href='/releases/5.3.0/instructions/maven-scope.html'></a>
</nav>
<footer class="container12" style="border-top: 1px solid black;padding:10px 0">
	<ul span=12 row>
		<li span=12>
			<ul>
				<li><a href="/releases/5.3.0/">GitHub</a>
			</ul>
	</ul>
</footer>

</body>
</html>
