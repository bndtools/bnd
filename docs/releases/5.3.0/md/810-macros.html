<!DOCTYPE html>
<html lang="en" ng-app="jpm">

	<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="/releases/5.3.0/css/style.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="/js/releases.js"></script>
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>bnd | Bnd/Bndtools. Tooling to build OSGi bundles including Eclipse, Maven, and Gradle plugins.</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="bnd" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Bnd/Bndtools. Tooling to build OSGi bundles including Eclipse, Maven, and Gradle plugins." />
<meta property="og:description" content="Bnd/Bndtools. Tooling to build OSGi bundles including Eclipse, Maven, and Gradle plugins." />
<meta property="og:site_name" content="bnd" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="bnd" />
<script type="application/ld+json">
{"url":"/releases/5.3.0/md/810-macros.html","headline":"bnd","description":"Bnd/Bndtools. Tooling to build OSGi bundles including Eclipse, Maven, and Gradle plugins.","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

</head>


<body>

	
<ul class="container12 menu-bar">
	<li span=11><a class=menu-link href="/releases/5.3.0/"><img
			class=menu-logo src="/releases/5.3.0/img/bnd-80x40-white.png"></a>
			<a href="/releases/5.3.0/chapters/110-introduction.html">Intro
			</a><a href="/releases/5.3.0/chapters/800-headers.html">Headers
			</a><a href="/releases/5.3.0/chapters/825-instructions-ref.html">Instructions
			</a><a href="/releases/5.3.0/chapters/855-macros-ref.html">Macros
			</a><a href="/releases/5.3.0/chapters/400-commands.html">Commands
			</a><div class="releases"><button class="dropbtn">5.3.0</button><div class="dropdown-content"></div></div>
	<li class=menu-link span=1>
			<a href="https://github.com/bndtools/bnd" target="_"><img
	style="position:absolute;top:0;right:0;margin:0;padding:0;z-index:100"
	src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67"
	alt="Fork me on GitHub"
	data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
</ul>


					

	<ul class=container12>
		<li span=3>
			<div>
			<ul class="side-nav">
	
		
			<li><a href="/releases/5.3.0/chapters/110-introduction.html">Introduction</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/120-install.html">How to install bnd</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/123-tour-workspace.html">Guided Tour</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/125-tour-features.html">Guided Tour Workspace & Projects</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/130-concepts.html">Concepts</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/140-best-practices.html">Best practices</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/150-build.html">Build</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/155-project-setup.html">Project Setup</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/160-jars.html">Generating JARs</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/170-versioning.html">Versioning</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/180-baselining.html">Baselining</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/200-components.html">Service Components</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/210-metatype.html">Metatype</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/220-contracts.html">Contracts</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/230-manifest-annotations.html">Bundle Annotations</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/235-accessor-properties.html">Accessor Properties</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/240-spi-annotations.html">SPI Annotations</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/250-resolving.html">Resolving Dependencies</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/300-launching.html">Launching</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/305-startlevels.html">Startlevels</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/310-testing.html">Testing</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/315-launchpad-testing.html">Testing with Launchpad</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/320-packaging.html">Packaging Applications</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/330-jpms.html">JPMS Libraries</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/390-wrapping.html">Wrapping Libraries to OSGi Bundles</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/395-generating-documentation.html">Generating Documentation</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/400-commands.html">Commands</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/600-developer.html">For Developers</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/650-windows.html">Tips for Windows users</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/700-tools.html">Tools bound to bnd</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/800-headers.html">Headers</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/820-instructions.html">Instruction Reference</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/825-instructions-ref.html">Instruction Index</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/850-macros.html">Macro Reference</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/855-macros-ref.html">Macro Index</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/870-plugins.html">Plugins</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/875-external-plugins.html">External Plugins</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/880-settings.html">Settings</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/900-errors.html">Errors</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/910-warnings.html">Warnings</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/920-faq.html">Frequently Asked Questions</a>
	  	
  	
</ul>

			</div>
			
		<li span=9>
			<div class=notes-margin>
				<h1> </h1>
				<hr />
<hr />
<h1 id="macros">Macros</h1>

<p>A simple macro processor is added to the header processing. Variables allow a single definition of a value, and the use of derivations. Each header is a macro that can be expanded. Notice that headers that do not start with an upper case character will not be copied to the manifest, so they can be used as working variables. Variables are expanded by enclosing the name of the variable in <code class="language-plaintext highlighter-rouge">${&lt;name&gt;}</code> (curly braces) or <code class="language-plaintext highlighter-rouge">$(&lt;name&gt;)</code> (parenthesis). Additionally, square brackets [], angled brackets &lt;&gt;, double guillemets «», and single guillemets ‹› are also allowed for brackets. If brackets are nested, that is $[replace;acaca;a(.*)a;[$1]] will return <code class="language-plaintext highlighter-rouge">[cac]</code>.</p>

<p>There are also a number of macros that perform basic functions. All these functions have the following basic syntax:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> macro ::= '${' function '}' 
     | '$\[' function '\]'
     | '$(' function ')'
     | '$&lt;' function '&gt;'

 function ::= name ( ';' argument ) *
</code></pre></div></div>

<p>For example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>version=1.23.87.200109111023542
Bundle-Version= ${version}
Bundle-Description= This bundle has version ${version}
</code></pre></div></div>

<h2 id="arguments">Arguments</h2>
<p>@Since(“2.3”) Macros can contain arguments. These arguments are available in the expansion as ${0} to ${9}. ${0} is the name of the macro, so the actual arguments start at 1. The name is also available as ${@}. The arguments as an array (without the name of the macro) is available as ${#}. The more traditional * could not be used because it clashes with wildcard keys, it means ALL values.</p>

<p>For example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>foo: Hello ${1} -&gt; ${foo;Peter} -&gt; "Hello Peter"
</code></pre></div></div>

<h2 id="wildcarded-keys">Wildcarded Keys</h2>
<p>Keys can be wildcarded. For example, if you want to set -plugin from different places, then you can set the <code class="language-plaintext highlighter-rouge">plugin.xxx</code> properties in different places and combine them with <code class="language-plaintext highlighter-rouge">-plugins= ${plugins.*}</code>.</p>

<h2 id="types">Types</h2>
<p>@TODO</p>

<h2 id="base-macros">Base Macros</h2>
<p>The following macros are always available.</p>

<h2 id="build-macros">Build Macros</h2>

<h3 id="bsn">`bsn</h3>
<p>Return the current Bundle Symbolic Name assumed by the code. This tries to load the current <code class="language-plaintext highlighter-rouge">Bundle-SymblicName</code> property, or reverts an inferred name from the file system.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>local = ${bsn}
</code></pre></div></div>

<h2 id="project-macros">Project Macros</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>${basename;arg
</code></pre></div></div>
<td>`arg ( ';' arg )*`</td>
<td>Return a comma separated list with all the file names (not directory) of the arguments. Non existent files are skipped.</td>

<p>[[#cat]]<code class="language-plaintext highlighter-rouge">cat</code></p>
<td>`arg`</td>
<td>If arg is a directory, return the contents of the directory. If it is a file, return the contents of the file.</td>

<p>[[#classes]]<code class="language-plaintext highlighter-rouge">classes</code></p>
<td>QUERY</td>
<td>Provides a query function to find classes to fulfill certain criteria. See the [classes][#classesx] macro</td>

<p>[[#def]]<code class="language-plaintext highlighter-rouge">def</code></p>
<td>`arg`</td>
<td>Provide the empty string if arg is not defined, otherwise it provides the value of the property `arg`.</td>

<p>[[#dir]]<code class="language-plaintext highlighter-rouge">dir</code></p>
<td>`arg ( ';' arg ) *</td>
<td>Get the directory names of the arguments in a comma separated format. For example, ${dir;${project}} should provide the directory path (absolute) of the directory that contains the project</td>

<p>[[#env]]<code class="language-plaintext highlighter-rouge">env</code></p>
<td>; name</td>
<td>Provide the value of the given environment variable</td>

<p>[[#error]]<code class="language-plaintext highlighter-rouge">error</code></p>
<td>`arg ( ';' arg ) *`</td>
<td>Generate an error for each `arg`.</td>

<p>[[#if]]<code class="language-plaintext highlighter-rouge">if</code></p>
<td>; condition ; true ( ; false ) ? </td>
<td>If the condition is not empty, the true part is returned, else the false part is returned. If not false part is supplied, the empty string is returned. The condition is trimmed before tested. For example:</td>

<p>Comment: ${if;${version};Ok;Version is NOT set###!}</p>

<p>[[#isdir]]<code class="language-plaintext highlighter-rouge">isdir</code></p>
<td>`arg`</td>
<td>Returns "true" when arg is an existing directory, otherwise "false".</td>

<p>[[#isfile]]<code class="language-plaintext highlighter-rouge">isfile</code></p>
<td>`arg`</td>
<td>Returns "true" when arg is an existing file, otherwise "false".</td>

<p>[[#filter]]<code class="language-plaintext highlighter-rouge">filter</code></p>
<td>';' list ';' regex</td>
<td>The filter macro iterates over the given list and only includes elements that match the given regular expression (regex). The following example includes only the jar files from the list: \\</td>
<p><code class="language-plaintext highlighter-rouge">list= a,b,c,d,x.jar,z.jar \\
List= ${filter;${list};.*\\.jar}</code></p>

<p>[[#filterout]]<code class="language-plaintext highlighter-rouge">filterout</code></p>
<td>; list ; regex</td>
<td>The filterout macro iterates over the given list and removes elements that match the given regular expression (regex). The following example strips the jar files from the list:  \\</td>
<p><code class="language-plaintext highlighter-rouge">list= a,b,c,d,x.jar,z.jar \\
List= ${filterout:${list};.*\\.jar}</code></p>

<p>[[#findname]]<code class="language-plaintext highlighter-rouge">findname</code></p>
<td>; regex [ ; replacement ]  </td>
<td>Find the paths to any resources that matches the regular expression, replace the name with the replacement of the regex. Notice that the regex is only executed on the name of the resource, that is, without the slashes.</td>

<p>[[#findpath]]<code class="language-plaintext highlighter-rouge">findpath</code></p>
<td>; regex [ ; replacement ]  </td>
<td>Find the paths to any resources that matches the regular expression, replace the path with the replacement of the regex. Notice that the regex is executed on the path of the resource, that is, with the slashes.</td>

<p>[[#fmodified]]<code class="language-plaintext highlighter-rouge">fmodified</code></p>
<td>; file-path-list </td>
<td>Return the highest modification time of the given file path. The returned value is based on the epoch of Java, it is therefore a long.  \\</td>
<p><code class="language-plaintext highlighter-rouge">Last-Modified: ${long2date;${fmodified;${files}})</code></p>

<p>[[#githead]]<code class="language-plaintext highlighter-rouge">githead</code></p>
<td></td>
<td>Returns the SHA of the head. This is either HEAD or the contents of the sym-ref. \\</td>
<p><code class="language-plaintext highlighter-rouge">Git-HEAD: ${githead}</code></p>
<td>2.3</td>

<p>[[#join]]<code class="language-plaintext highlighter-rouge">join</code></p>
<td>( ; list ) *</td>
<td>Joins a number of lists into one. It may seem that this can be easily accomplished by just placing two macro expansions after each other. The result of this will not be a list, unless a ',' (colon) is placed in between. However, when one of the lists is empty, the colon will be superfluous. The join handles these cases correctly. Any number of lists may be given as arguments. \\</td>
<p><code class="language-plaintext highlighter-rouge">List= ${join;a,b,c;d,e,f}</code></p>

<p>[[#literal]]<code class="language-plaintext highlighter-rouge">literal</code></p>
<td>`arg`</td>
<td>Provide a literal macro for arg. For example, `${literal;"project"}` results in `"${project}"`. Can be useful if information must be created for other systems that uses the macro syntax.</td>

<p>[[#lsa]]<code class="language-plaintext highlighter-rouge">lsa</code></p>
<td>`dir` ( ';' PATTERN ( ',' PATTERN )* )?</td>
<td>Return the contents of the given directory filtered by the patterns. The result is a comma separated list of absolute file names.</td>

<p>[[#lsr]]<code class="language-plaintext highlighter-rouge">lsr</code></p>
<td>`dir` ( ';' PATTERN ( ',' PATTERN )* )?</td>
<td>Return the contents of the given directory filtered by the patterns. The result is a comma separated list of relative file names.</td>

<p>[[#long2date]]<code class="language-plaintext highlighter-rouge">long2date</code></p>
<td>; long </td>
<td>Parse the long and turn it into a date.  \\</td>
<p><code class="language-plaintext highlighter-rouge">Last-Modified: ${long2date:${fmodified:${files}})</code></p>

<p>[[#maven_version]]<code class="language-plaintext highlighter-rouge">maven_version</code></p>
<td>version</td>
<td>Clean up a maven version so it conforms to the OSGi specification.</td>
<td></td>

<p>[[#now]]<code class="language-plaintext highlighter-rouge">now</code></p>
<td></td>
<td>Returns the current Date as string.  \\</td>
<p><code class="language-plaintext highlighter-rouge">Created-When: ${now}</code></p>

<p>[[#osfile]]<code class="language-plaintext highlighter-rouge">osfile</code></p>
<td>`base (';' PATH )*`</td>
<td>Return a comma separated list of absolute file paths in the current's OS' format. If the PATH is relative, it is calculated from the base directory.</td>

<p>[[#path]]<code class="language-plaintext highlighter-rouge">path</code></p>
<td>LIST (';' LIST )*`</td>
<td>Return a platform specific path (File.pathSeparator) from the given lists.</td>

<p>[[#pathseparator]]<code class="language-plaintext highlighter-rouge">pathseparator</code></p>
<td></td>
<td>Returns the current path separator as defined by `File.pathSeparator`</td>

<p>[[#permissions]]<code class="language-plaintext highlighter-rouge">permissions</code></p>
<td>`(all|packages|admin)+`</td>
<td>Generates a permission file. If packages is specified, it provides PackagePermission for imports and exports. `admin` adds an AdminPermission, `all` adds them all</td>
<td></td>

<p>[[#range]]<code class="language-plaintext highlighter-rouge">range</code></p>
<td>; ('[' | '(') MASK ',' MASK (']' | ')') [ ; VERSION]</td>
<td>Create a version range from a version. The MASK is defined in [${version}][#version].</td>

<p>[[#replace]]<code class="language-plaintext highlighter-rouge">replace</code></p>
<td>; list ; regex ; replacement </td>
<td>Replace all elements of the list that match the regular expression regex with the replacement. The replacement can use the `$[0-9]` back references defined in the regular expressions. The macro uses `item.replaceAll(regex,replacement)` method to do the replacement.For example, to add a `.jar` extension to all files listed, use the following: \\</td>
<p><code class="language-plaintext highlighter-rouge">List = ${replace;${impls};$;.jar}</code></p>

<p>[[#sort]]<code class="language-plaintext highlighter-rouge">sort</code></p>
<td>; list</td>
<td>Sort the given list using string sorting collation. For example: \\</td>
<p><code class="language-plaintext highlighter-rouge">List= ${sort:acme.jar, harry.jar, runner.jar, alpha.jar, bugs.jar}</code></p>

<p>[[#system]]<code class="language-plaintext highlighter-rouge">system</code></p>
<td>system cmd</td>
<td>Execute a command via `System.exec` and return the result as the macro's value.</td>

<p>[[#toclassname]]<code class="language-plaintext highlighter-rouge">toclassname</code></p>
<td>; list</td>
<td>Replace a class path (with slashes and class at the end) to a class name (with dots).</td>

<p>[[#toclasspath]]<code class="language-plaintext highlighter-rouge">toclasspath</code></p>
<td>; list  [ ; suffix ]</td>
<td>Replace a class name (with dots) to a classpath (with slashes and `suffix` at the end). The default suffix is `.class`. The suffix may be empty</td>

<p>[[#tstamp]]<code class="language-plaintext highlighter-rouge">tstamp</code></p>
<td> ( date pattern )?</td>
<td>Answer a time stamp based on the pattern. The pattern is defined by the [SimpleDateFormat][http://download.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html]. The default pattern is `yyyyMMddHHmm`.</td>

<p>[[#unique]]<code class="language-plaintext highlighter-rouge">unique</code></p>
<td>; list ( ; list ) *</td>
<td>Split all the given lists on their commas, combine them in one list and remove any duplicates. The ordering is not preserved, see [${sort}][#sort] For example:</td>

<p>${unique; 1,2,3,1,2; 1,2,4 } ~ “2,4,3,1”</p>

<p>[[#version]]<code class="language-plaintext highlighter-rouge">version</code></p>
<td>; mask ; version</td>
<td>This macro can modify a version by dropping parts from the end, incrementing parts, or decrementing parts. The mask is a string containing from 1 to 4 characters. The characters have the following meaning: \\</td>
<p>= the actual version part \</p>
<ul>
  <li>increment the actual version part \</li>
  <li>decrement the actual version part <br />
For example, ${version;=+;1.2.3.q} will become 1.3.</li>
</ul>

<p>[[#warning]]<code class="language-plaintext highlighter-rouge">warning</code></p>
<td>`arg ( ';' arg ) *`</td>
<td>Generate a warning for each `arg`.</td>

<p>(:tableend:)</p>


			</div>
	</ul>

	
<nav class=next-prev>
	<a href='/releases/5.3.0'></a> <a href='/releases/5.3.0'></a>
</nav>
<footer class="container12" style="border-top: 1px solid black;padding:10px 0">
	<ul span=12 row>
		<li span=12>
			<ul>
				<li><a href="/releases/5.3.0/">GitHub</a>
			</ul>
	</ul>
</footer>

</body>
</html>
