<!DOCTYPE html>
<html lang="en" ng-app="jpm">

	<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="/releases/5.3.0/css/style.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="/js/releases.js"></script>
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>bnd | Bnd/Bndtools. Tooling to build OSGi bundles including Eclipse, Maven, and Gradle plugins.</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="bnd" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Bnd/Bndtools. Tooling to build OSGi bundles including Eclipse, Maven, and Gradle plugins." />
<meta property="og:description" content="Bnd/Bndtools. Tooling to build OSGi bundles including Eclipse, Maven, and Gradle plugins." />
<meta property="og:site_name" content="bnd" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="bnd" />
<script type="application/ld+json">
{"url":"/releases/5.3.0/md/805-instructions.html","headline":"bnd","description":"Bnd/Bndtools. Tooling to build OSGi bundles including Eclipse, Maven, and Gradle plugins.","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

</head>


<body>

	
<ul class="container12 menu-bar">
	<li span=11><a class=menu-link href="/releases/5.3.0/"><img
			class=menu-logo src="/releases/5.3.0/img/bnd-80x40-white.png"></a>
			<a href="/releases/5.3.0/chapters/110-introduction.html">Intro
			</a><a href="/releases/5.3.0/chapters/800-headers.html">Headers
			</a><a href="/releases/5.3.0/chapters/825-instructions-ref.html">Instructions
			</a><a href="/releases/5.3.0/chapters/855-macros-ref.html">Macros
			</a><a href="/releases/5.3.0/chapters/400-commands.html">Commands
			</a><div class="releases"><button class="dropbtn">5.3.0</button><div class="dropdown-content"></div></div>
	<li class=menu-link span=1>
			<a href="https://github.com/bndtools/bnd" target="_"><img
	style="position:absolute;top:0;right:0;margin:0;padding:0;z-index:100"
	src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67"
	alt="Fork me on GitHub"
	data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
</ul>


					

	<ul class=container12>
		<li span=3>
			<div>
			<ul class="side-nav">
	
		
			<li><a href="/releases/5.3.0/chapters/110-introduction.html">Introduction</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/120-install.html">How to install bnd</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/123-tour-workspace.html">Guided Tour</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/125-tour-features.html">Guided Tour Workspace & Projects</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/130-concepts.html">Concepts</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/140-best-practices.html">Best practices</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/150-build.html">Build</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/155-project-setup.html">Project Setup</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/160-jars.html">Generating JARs</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/170-versioning.html">Versioning</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/180-baselining.html">Baselining</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/200-components.html">Service Components</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/210-metatype.html">Metatype</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/220-contracts.html">Contracts</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/230-manifest-annotations.html">Bundle Annotations</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/235-accessor-properties.html">Accessor Properties</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/240-spi-annotations.html">SPI Annotations</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/250-resolving.html">Resolving Dependencies</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/300-launching.html">Launching</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/305-startlevels.html">Startlevels</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/310-testing.html">Testing</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/315-launchpad-testing.html">Testing with Launchpad</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/320-packaging.html">Packaging Applications</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/330-jpms.html">JPMS Libraries</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/390-wrapping.html">Wrapping Libraries to OSGi Bundles</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/395-generating-documentation.html">Generating Documentation</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/400-commands.html">Commands</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/600-developer.html">For Developers</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/650-windows.html">Tips for Windows users</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/700-tools.html">Tools bound to bnd</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/800-headers.html">Headers</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/820-instructions.html">Instruction Reference</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/825-instructions-ref.html">Instruction Index</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/850-macros.html">Macro Reference</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/855-macros-ref.html">Macro Index</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/870-plugins.html">Plugins</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/875-external-plugins.html">External Plugins</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/880-settings.html">Settings</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/900-errors.html">Errors</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/910-warnings.html">Warnings</a>
	  	
  	
		
			<li><a href="/releases/5.3.0/chapters/920-faq.html">Frequently Asked Questions</a>
	  	
  	
</ul>

			</div>
			
		<li span=9>
			<div class=notes-margin>
				<h1> </h1>
				<hr />
<p>layout: default
___</p>
<h1 id="instructions">Instructions</h1>

<p>The bnd format is very similar to the manifest. Though it is read with the Properties class, you can actually use the ‘:’ as separator to make it look more like a manifest file. The only thing you should be aware of is that the line continuation method of the Manifest (a space as the first character on the line) is not supported. Line continuations are indicated with the backslash (‘' \u005C) as the last character of the line. Lines may have any length.</p>

<p>The most common mistake is missing the escape. The following does not what people expect it to do:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Header: abc=def,
  gih=jkl
</code></pre></div></div>

<p>This is actually defining 2 headers. You can fold lines by escaping the newline:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Header: abc=def, \\
  gih=jkl
</code></pre></div></div>

<p>You can add comments with a # on the first character of the line:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># This is a comment
</code></pre></div></div>

<p>White spaces around the key and value are trimmed.</p>

<p>See [  Properties][http://java.sun.com/j2se/1.4.2/docs/api/java/util/Properties.html ] for more information about the format.</p>

<h2 id="types-of-instructions">Types of Instructions</h2>
<p>There are different instructions in the properties file:</p>

<table>
  <tbody>
    <tr>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>!Type</td>
      <td> </td>
      <td>!Example</td>
      <td> </td>
      <td>!Description</td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>Manifest headers</td>
      <td> </td>
      <td>Bundle-Description: …</td>
      <td> </td>
      <td>When the first character is a upper case character. These headers are copied to the manifest or augmented by bnd.</td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>Variables</td>
      <td> </td>
      <td>version=3.0</td>
      <td> </td>
      <td>Variables are lower case headers. Headers can contain references to other headers using macro expansion. Variables are not copied to the manifest. See [Macros][#macros]</td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td>Directives</td>
      <td> </td>
      <td>-include: deflts.bnd</td>
      <td> </td>
      <td>Directives start with a ‘-‘ sign. A directive is an instruction to bnd to do something special. See [Directives][#directives]</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>[[#directives]]</p>
<h2 id="bnd-directives">Bnd Directives</h2>

<p>||
||!Directive ||!Format ||!Description ||
||<code class="language-plaintext highlighter-rouge">-classpath</code>||[ LIST][#list ] ||Add the listed files to the current class path. The files must be addressed relative to the properties file. The files must be either a JAR file or a directory. For example:<br />
<code class="language-plaintext highlighter-rouge">-classpath= acme.jar, junit.jar, bin</code> ||
||<code class="language-plaintext highlighter-rouge">-debug</code>||<code class="language-plaintext highlighter-rouge">true|false</code>||Generate debugging information. This will save embedded jar files in the target directory when they are generated on the fly.||
||<code class="language-plaintext highlighter-rouge">-donotcopy</code>||[ REGEX][#regex ] ||During copying of files from the classpath, file system, or other places, this filter is used to prevent copies. For example, normally <code class="language-plaintext highlighter-rouge">CVS</code> and <code class="language-plaintext highlighter-rouge">.svn</code> directories should not be copied. The default is therefore <code class="language-plaintext highlighter-rouge">(CVS|.svn)</code>. Example:  <br />
<code class="language-plaintext highlighter-rouge">-donotcopy= (CVS|.svn|.+.bak|~.+)</code> ||
||<code class="language-plaintext highlighter-rouge">-exportcontents</code>||[ PATTERN][#LIST|LIST]] of [[#PATTERN ]||The content of this header augments the Export-Package header, but only for the manifest calculation. That is, Export-Package is used to calculate the contents of the JAR, but then this instruction can be used change or add instructions for the manifest generation.||
||-failok ||true | false ||In certain cases, errors should not abort the creation of the bundle. For example test cases often require the creation of an invalid JAR. If this flag is set to true, errors will create a target bundle (when possible) and errors are only listed. When failok is false, the default, any error will not create a target bundle and will delete the bundle file. Example:  <br />
<code class="language-plaintext highlighter-rouge">-failok= true</code> ||
||-include ||[ LIST][#list ] ||This property will include the list of files in the given order. The files are relative from the bnd file itself. If this directive is used inside an included properties file, then the including file is the base. Includes are very useful to keep headers like Bundle-Vendor, Bundle-Copyright central. If the extension of the file is .mf, then the file is parsed as a manifest file. By default, a property defined in an include file override earlier definitions, this implies that any property in the bnd file is overridden if defined in an include file. The include files are read in the order they are listed where later files override earlier files. If there are multiple definitions for the same property, then the last definitions wins. If the path of an included file starts with a ~, then it will ‘'’not’’’ override earlier set properties.<br />
You can use properties like ${user.home} in file names. If the file does not exist, an error is generated. If the filename is prefixed with a ‘-‘ sign then no error is generated when the file is absent. For example:  <br />
<br />
<code class="language-plaintext highlighter-rouge">-include= ~${user.home}/deflts.bnd, META-INF/MANIFEST.MF</code><br />
<code class="language-plaintext highlighter-rouge">-include= a.props, ~META-INF/MANIFEST.MF</code> ||
||<code class="language-plaintext highlighter-rouge">-manifest</code>||FILE||Overrides the generation of a manifest and uses the given file instead.||
||<code class="language-plaintext highlighter-rouge">-metatype</code>||[Analyzes the classes in the JAR for metatype interfaces (Metadata.OCD annotation). See [[MetaType][#LIST | LIST]] of [[#PATTERN | PATTERN]]|].||
||<code class="language-plaintext highlighter-rouge">-nomanifest</code>||false|true||Generate a JAR without a manifest||
||<code class="language-plaintext highlighter-rouge">-nodefaultversion</code>||false|true||If true, do not make exported packages without a version inherit the bundle version. See [[Versioning]]||
||<code class="language-plaintext highlighter-rouge">-nope</code>||true|false||Do not build a bundle, deprecated use <code class="language-plaintext highlighter-rouge">-nobundles=true</code>||
||<code class="language-plaintext highlighter-rouge">-nouses</code>||<code class="language-plaintext highlighter-rouge">true|false</code>||Do not calculate the <code class="language-plaintext highlighter-rouge">uses:</code> directive.||
||<code class="language-plaintext highlighter-rouge">-output</code>||PATH||Store the file (if applicable) under the path||
||<code class="language-plaintext highlighter-rouge">-plugin</code>||[plugins][#LIST|LIST]] of [[#PLUGIN|PLUGIN]]||Define the plugins that bnd should use. A plugin is a class that is used at certain phases in the bundle generation. That place is defined by the interfaces it implements. Plugins are defined in [[#plugins].||
||<code class="language-plaintext highlighter-rouge">-removeheaders</code>||[LIST][#LIST] of string||Removes the given headers from the output manifest. This feature can be useful if you are wrapping a bundle and it contains for example a Require-Bundle header.||
||<code class="language-plaintext highlighter-rouge">-snapshot</code>||<code class="language-plaintext highlighter-rouge">repl</code>||Replacement for the .SNAPSHOT qualifier used in maven. If a Bundle version uses SNAPSHOT as the qualifier then bnd will replace this with whatever <code class="language-plaintext highlighter-rouge">-snapshot</code> is set to. For example:<br />
<br />
  <code class="language-plaintext highlighter-rouge">-snapshot: ${tstamp}</code><br />
<br />
This replaces the .SNAPSHOT qualifier with a timestamp. If -snapshot is not set the SNAPSHOT qualifier will not be replaced.||
||<code class="language-plaintext highlighter-rouge">-sources</code>||<code class="language-plaintext highlighter-rouge">true|false</code>||Include sources||
||<code class="language-plaintext highlighter-rouge">-wab</code>||[-wablib][#LIST|LIST]] of iclause||Turn a bundle into a Web Archive Bundle (WAB) that can also be used as a WAR, See [[#wab|-wab]] and [[#wablib]||
||<code class="language-plaintext highlighter-rouge">-wablib</code>||[-wablib][#LIST|LIST]] of [[#PATTERN|PATTERN]]||Turn a bundle into a Web Archive Bundle (WAB) that can also be used as a WAR, See [[#wab|-wab]] and [[#wablib]||</p>

<h2 id="headers">Headers</h2>
<p>||!Headers ||!Format ||!Description ||
||<code class="language-plaintext highlighter-rouge">Bundle-ClassPath</code>|| ||Defines the internal bundle class path, is taken into accont by bnd. That is, classes will be analyzed according to this path. The files/directories on the Bundle-ClassPath must be present in the bundle. Use Include-Resource to include these jars/directories in your bundle. In general you should not use Bundle-ClassPath since it makes things more complicated than necessary. Use the @ option in the Include-Resource to unroll the jars into the JAR.||
||<code class="language-plaintext highlighter-rouge">Bundle-\\
ManifestVersion</code>||2 ||The Bundle-ManifestVersion is always set to 2, there is no way to override this. ||
||<code class="language-plaintext highlighter-rouge">Bundle-Name</code>|| ||If the Bundle-Name is not set, it will default to the Bundle-SymbolicName. ||
||<code class="language-plaintext highlighter-rouge">Bundle-\\
SymbolicName</code>|| ||The Bundle-SymbolicName header can be set by the user. The default is the name of the main bnd file, or if the main bnd file is called bnd.bnd, it will be the name of the directory of the bnd file. An interesting variable is ${project} that will be set to this default name. ||
||<code class="language-plaintext highlighter-rouge">Bundle-Version</code>||VERSION ||The version of the bundle. If no such header is provided, a version of 0 will be set. ||
||<code class="language-plaintext highlighter-rouge">Conditional-Package</code>||[PATTERN][#LIST|LIST]] of [[#PATTERN] || ‘'’experimental’’’ Works as private package but will only include the packages when they are imported. When this header is used, bnd will recursively add packages that match the patterns until there are no more additions.||
||<code class="language-plaintext highlighter-rouge">Export-Package</code>||[See ExportPackage][#LIST | LIST]] of [[#PATTERN | PATTERN]] ||The Export-Package header lists the packages that the bundle should export, and thus contain. [[#export-package].||
||<code class="language-plaintext highlighter-rouge">Fragment-Host</code>|| ||Ignored by bnd||
||<code class="language-plaintext highlighter-rouge">Import-Package</code>||[See Import Package][#LIST | LIST]] of [[#PATTERN | PATTERN]] ||The Import-Package header lists the packages that are required by the contained packages. [[#import-package].||
||<code class="language-plaintext highlighter-rouge">Include-Resource</code>||[See Include Resource][#LIST|LIST]] of iclause||The Include-Resource instruction makes it possible to include arbitrary resources; it contains a list of resource paths. [[#include-resource].||
||<code class="language-plaintext highlighter-rouge">Private-Package</code>||[See Private Package][#LIST | LIST]] of [[#PATTERN | PATTERN]] ||The Private-Package header lists the packages that the bundle should contain but not export. [[#private-package].||
||<code class="language-plaintext highlighter-rouge">Require-Bundle</code>|| ||Ignored by bnd||
||<code class="language-plaintext highlighter-rouge">Service-Component</code>||[Service Component Header][#LIST | LIST]] of <code class="language-plaintext highlighter-rouge">component</code> || See [[#component].||</p>

<h2 id="basic-types">Basic Types</h2>
<p>||[[#list]][[#LIST]]LIST||A comma separated list. Items should be quoted with ‘”’ if the contain commas. In general, a list item can also define attributes and directives on an item.||
||[[#pattern]][[#PATTERN]]PATTERN||A pattern matches some entity: a package, a directory, etc. Patterns are based on Java regular expressions but are preprocessed before compiled. Any dots (‘.’) are replaced with . to make them match the input and not act as the ‘any character’ operator. Any ‘?’ or ‘<em>’ is prefixed with a dot to make it match any character. As an extra convenience, if the string ends with ..</em>, an additional pattern is added to match the complete string with out the ..<em>. The effect is that something like com.acme.</em> matches com.acme and all its sub packages. It is also to negate a pattern by prefixing it with an exclamation mark (‘!’). For example:<br />
   <code class="language-plaintext highlighter-rouge">Import-Package: !com.sun.*, *</code> <br />
indicates that any imports to com.sun should not be imported.||
||[[#regex]]REGEX||A regular expressions||</p>

<p>[[#export-package]]</p>
<h2 id="export-package">Export-Package</h2>
<p>The bnd definition allows the specification to be done using ‘‘patterns’’, a modified regular expression. All patterns in the definition are matched against every package on the [ class path][#CLASSPATH ]. If the pattern is a negating pattern (starts with !) and it is matched, then the package is completely excluded. Normal patterns cause the package to be included in the resulting bundle. Patterns can include both directives and attributes, these items will be copied to the output. The list is ordered, earlier patterns take effect before later patterns. The following examples copies everything on the class path except for packages starting with <code class="language-plaintext highlighter-rouge">com</code>. The default for Export-Package is “*”, which can result in quite large bundles. If the source packages have an associated version (from their manifest of packageinfo file), then this version is automatically added to the clauses.</p>

<p>Export-Package= !com.*, *</p>

<p>Exports are automatically imported. This features can be disabled with a special directive on the export instruction: <code class="language-plaintext highlighter-rouge">-noimport:=true</code>. For example:</p>

<p>Export-Package= com.acme.impl.*;-noimport:=true, *</p>

<p>Bnd will automatically calculate the <code class="language-plaintext highlighter-rouge">uses:</code> directive. This directive is used by the OSGi framework to create a consistent class space for a bundle. The Export-Package statement allows this directive to be overridden on a package basis by specifying the directive in an Export-Package instruction.</p>

<p>Export-package = com.acme.impl.*;uses=”my.special.import”</p>

<p>However, in certain cases it is necessary to augment the uses clause. It is therefore possible to use the special name <code class="language-plaintext highlighter-rouge">&lt;&lt;USES&gt;&gt;</code> in the clause. Bnd will replace this special name with the calculated uses set. Bnd will remove any extraneous commas when the <code class="language-plaintext highlighter-rouge">&lt;&lt;USES&gt;&gt;</code> is empty.</p>

<p>Export-package = com.acme.impl.*;uses:=”my.special.import,«USES»”</p>

<p>Directives that are not part of the OSGi specification will give a warning unless they are prefixed with a ‘x-‘.</p>

<p>###Split packages
Bnd traverse the packages on the classpath and copies them to the output based on the instructions given by the Export-Package and Private-Package headers. This opens up for the possibility that there are multiple packages with the same name on the class path. It is better to avoid this situation because it means there is no cohesive definition of the package and it is just, eh, messy. However, there are valid cases that packages should be merged from different sources. For example, when a standard package needs to be merged with implementation code like the osgi packages sometimes (unfortunately) do. Without any extra instructions, bnd will merge multiple packages where the last one wins if the packages contain duplicate resources, but it will give a warning to notify the unwanted case of split packages.</p>

<p>The <code class="language-plaintext highlighter-rouge">-split-package:</code> directive on the Export-Package/Private-Package clause allows fine grained control over what should be done with split packages. The following values are architected:</p>

<table>
  <tbody>
    <tr>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">merge-first</code></td>
      <td> </td>
      <td>Merge split packages but do not add resources that come later in the classpath. That is, the first resource wins. This is the default, although the default will generate a warning</td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">merge-last</code></td>
      <td> </td>
      <td>Merge split packages but overwrite resources that come earlier in the classpath. That is, the last resource wins.</td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">first</code></td>
      <td> </td>
      <td>Do not merge, only use the first package found</td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">error</code></td>
      <td> </td>
      <td>Generate an error when a split package is detected</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>For example:</p>

<p>Private-Package: test.pack;-split-package:=merge-first</p>

<p>[[#private-package]]</p>
<h2 id="private-package">Private Package</h2>
<p>The method of inclusion is identical to the Export-Package header, the only difference is, is that these packages are not exported. This header will be copied to the manifest. If a package is selected by noth the export and private package headers, then the export takes precedence.</p>

<p>Private-Package= com.*</p>

<p>[[#import-package]]</p>
<h2 id="import-package">Import Package</h2>
<p>The Import-Package header lists the packages that are required by the contained packages. The default for this header is “*”, resulting in importing all referred packages. This header therefore rarely has to be specified. However, in certain cases there is an unwanted import. The import is caused by code that the author knows can never be reached. This import can be removed by using a negating pattern. A pattern is inserted in the import as an extra import when it contains no wildcards and there is no referral to that package. This can be used to add an import statement for a package that is not referred to by your code but is still needed, for example, because the class is loaded by name.</p>

<p>For example:
  Import-Package: !org.apache.commons.log4j, com.acme.*,
     com.foo.extra</p>

<p>During processing, bnd will attempt to find the exported version of imported packages. If no version or version range is specified on the import instruction, the exported version will then be used though the micro part and the qualifier are dropped. That is, when the exporter is <code class="language-plaintext highlighter-rouge">1.2.3.build123</code>, then the import version will be 1.2. If a specific version (range) is specified, this will override any found version. This default an be overridden with the [-versionpolicy][#versionpolicy] command.</p>

<p>If an explicit version is given, then ${@} can be used to substitute the found version in a range. In those cases, the version macro can be very useful to calculate ranges or drop specific parts of the version. For example:</p>

<p>Import-Package: org.osgi.framework;version=”[1.3,2.0)”
  Import-Package: org.osgi.framework;version=${@}
  Import-Package: org.osgi.framework;version=”[${version;==;${@}},${version;=+;${@}})”</p>

<p>If an imported package uses mandatory attributes, then bnd will attempt to add those attributes to the import statement. However, in certain (bizarre!) cases this is not wanted. It is therefore possible to remove an attribute from the import clause. This is done with the <code class="language-plaintext highlighter-rouge">-remove-attribute:</code> directive or by setting the value of an attribute to !. The parameter of the <code class="language-plaintext highlighter-rouge">-remove-attribute</code> directive is an instruction and can use the standard options with !, *, ?, etc.</p>

<p>Import-Package: org.eclipse.core.runtime;-remove-attribute:common,*</p>

<p>Or</p>

<p>Import-Package: org.eclipse.core.runtime;common=!,*</p>

<p>Directives that are not part of the OSGi specification will give a warning unless they are prefixed with a ‘x-‘.</p>

<p>[[#include-resource]]</p>
<h2 id="include-resource">Include Resource</h2>
<p>The resources will be copied into the target jar file. The iclause can have the following forms:</p>

<p>iclause    ::= inline | copy
  copy       ::= ‘{‘ process ‘}’ | process
  process    ::= assignment | simple
  assignment ::= PATH ‘=’ simple
  simple     ::= PATH parameter*
  inline     ::= ‘@’ PATH ( ‘!/’ PATH? (‘/<em>*’ | ‘/</em>’)? )?
  parameters ::= ‘flatten’ | ‘recursive’ | ‘filter’</p>

<p>In the case of <code class="language-plaintext highlighter-rouge">assignment</code> or <code class="language-plaintext highlighter-rouge">simple</code>, the PATH parameter can point to a file or directory. It is also possible to use the name.ext path of a JAR file on the classpath, that is, ignoring the directory. The <code class="language-plaintext highlighter-rouge">simple</code> form will place the resource in the target JAR with only the file name, therefore without any path components. That is, including src/a/b.c will result in a resource b.c in the root of the target JAR.</p>

<p>If the PATH points to a directory, the directory name itself is not used in the target JAR path. If the resource must be placed in a subdirectory of the target jar, use the <code class="language-plaintext highlighter-rouge">assignment</code> form. If the file is not found, bnd will traverse the classpath to see of any entry on the classpath matches the given file name (without the directory) and use that when it matches. The <code class="language-plaintext highlighter-rouge">inline</code> requires a ZIP or JAR file, which will be completely expanded in the target JAR (except the manifest), unless followed with a file specification. The file specification can be a specific file in the jar or a directory followed by ** or *. The ** indicates recursively and the * indicates one level. If just a directory name is given, it will mean **.</p>

<p>The <code class="language-plaintext highlighter-rouge">simple</code> and <code class="language-plaintext highlighter-rouge">assigment</code> forms can be encoded with curly braces, like <code class="language-plaintext highlighter-rouge">{foo.txt}</code>. This indicates that the file should be preprocessed (or filtered as it is sometimes called). Preprocessed files can use the same variables and macros as defined in the [macro section][#macros].</p>

<p>The <code class="language-plaintext highlighter-rouge">recursive:</code> directive indicates that directories must be recursively included.</p>

<p>The <code class="language-plaintext highlighter-rouge">flatten:</code> directive indicates that if the directories are recursively searched, the output must not create any directories. That is all resources are flattened in the output directory.</p>

<p>The <code class="language-plaintext highlighter-rouge">filter:</code> directive is an optional filter on the resources. This uses the same format as the instructions. Only the file name is verified against this instruction.</p>

<p>Include-Resource: @osgi.jar,[=\ =]
    {LICENSE.txt},[=\ =]
    acme/Merge.class=src/acme/Merge.class</p>

<p>[[#wab]]</p>
<h2 id="web-archive-bundles">Web Archive Bundles</h2>
<p>In OSGi Enterprise 4.2 the concept of Web Archive Bundles were introduced. Web Archive Bundles are 100% normal bundles following all the rules of OSGi. Their speciality is that they can be mapped to a web server following several of the rules of Java Enterprise Edition’s Servlet model. The big difference is that the WARs of the servlet model have a rather strict layout of their archive because the servlet container also handles class loading. In OSGi, the class loading is very well specified and it would therefore be wrong to create special rules.</p>

<p>However, the OSGi supports the Bundle-Classpath header. This header allows the organization of the internal layout. It turns out that it is possible to create a valid Web Application Bundle (WAB) that is also a valid Web ARchive (WAR). Being deploy an archive both to OSGi and an application server obviously has advantages. bnd therefore supports a number of instructions that make it easy to create these dual mode archives.</p>

<p>The <code class="language-plaintext highlighter-rouge">-wab</code> instruction instructs bnd to move the root of the created archive to WEB-INF/classes. That is, you build your bundle in the normal way,not using the <code class="language-plaintext highlighter-rouge">Bundle-ClassPath</code>. The <code class="language-plaintext highlighter-rouge">-wab</code> command then moves the root of the archive so the complete class path for the bundle is no inside the WEB-INF/classes directory. It then adjusts the <code class="language-plaintext highlighter-rouge">Bundle-ClassPath</code> header to reflect this new location of the classes and resources.</p>

<p>The new root now only contains WEB-INF. In the Servlet specification, the root of the archive is mapped to the server’s context URL. It is therefore often necessary to place static files in the root. For this reason, the <code class="language-plaintext highlighter-rouge">-wab</code> instruction has the same form as [Include-Resource][#include-resource] header, and performs the same function. However, it performs this function of copying resources from the file system after the classes and resources of the original bundle have been moved to WEB-INF.</p>

<p>For example, the following code creates a simple WAB/WAR:</p>

<p>Private-Package:   com.example.impl.*
  Export-Package:    com.example.service.myapi
  Include-Resource:  resources/
  -wab:              static-pages/</p>

<p>The layout of the resulting archive is:</p>

<p>WEB-INF/classes/com/example/impl/
  WEB-INF/classes/com/example/service/myapi/
  WEB-INF/classes/resources/
  index.html // from static-pages</p>

<p>The <code class="language-plaintext highlighter-rouge">Bundle-ClassPath</code> is <code class="language-plaintext highlighter-rouge">WEB-INF/classes</code>.</p>

<p>WARs can carry a WEB-INF/lib directory. Any archive in this directory is mapped to the class path of the WAR. The OSGi specifications do not recognize directories with archives it is therefore necessary to list these archives also on the <code class="language-plaintext highlighter-rouge">Bundle-ClassPath</code> header. This is cumbersome to do by hand so the <code class="language-plaintext highlighter-rouge">-wablib</code> command will take a list of paths.</p>

<p>Private-Package:   com.example.impl.*
  Export-Package:    com.example.service.myapi
  Include-Resource:  resources/
  -wab:              static-pages/
  -wablib:			 lib/a.jar, lib/b.jar</p>

<p>This results in a layout of:</p>

<p>WEB-INF/classes/com/example/impl/
  WEB-INF/classes/com/example/service/myapi/
  WEB-INF/classes/resources/
  WEB-INF/lib/
    a.jar
    b.jar
  index.html ( from static-pages)</p>

<p>The <code class="language-plaintext highlighter-rouge">Bundle-ClassPath</code> is now set to <code class="language-plaintext highlighter-rouge">WEB-INF/classes,WEB-INF/lib/a.jar,WEB-INF/lib/a.jar</code></p>

			</div>
	</ul>

	
<nav class=next-prev>
	<a href='/releases/5.3.0'></a> <a href='/releases/5.3.0'></a>
</nav>
<footer class="container12" style="border-top: 1px solid black;padding:10px 0">
	<ul span=12 row>
		<li span=12>
			<ul>
				<li><a href="/releases/5.3.0/">GitHub</a>
			</ul>
	</ul>
</footer>

</body>
</html>
