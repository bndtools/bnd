<!DOCTYPE html>
<html lang="en" ng-app="jpm">

	<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="/releases/5.2.0/css/style.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="/js/releases.js"></script>
<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Baselining</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Baselining" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Baselining compares a bundle with another bundle, the baseline, to find mistakes in the semantic versioning. For example, there is a binary incompatible change in the new bundle but the version has not been bumped. Baselining can be run from the command line (see bnd help baseline) or it can be run as part of a project build." />
<meta property="og:description" content="Baselining compares a bundle with another bundle, the baseline, to find mistakes in the semantic versioning. For example, there is a binary incompatible change in the new bundle but the version has not been bumped. Baselining can be run from the command line (see bnd help baseline) or it can be run as part of a project build." />
<script type="application/ld+json">
{"url":"/releases/5.2.0/chapters/180-baselining.html","headline":"Baselining","description":"Baselining compares a bundle with another bundle, the baseline, to find mistakes in the semantic versioning. For example, there is a binary incompatible change in the new bundle but the version has not been bumped. Baselining can be run from the command line (see bnd help baseline) or it can be run as part of a project build.","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


	

	

	

	

	

	

	

	

	

	

	
		<style>
			 body {
				counter-reset: h1 11;
			}
		</style>
	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

</head>


<body>

	
<ul class="container12 menu-bar">
	<li span=11><a class=menu-link href="/releases/5.2.0/"><img
			class=menu-logo src="/releases/5.2.0/img/bnd-80x40-white.png"></a>
			<a href="/releases/5.2.0/chapters/110-introduction.html">Intro
			</a><a href="/releases/5.2.0/chapters/800-headers.html">Headers
			</a><a href="/releases/5.2.0/chapters/825-instructions-ref.html">Instructions
			</a><a href="/releases/5.2.0/chapters/855-macros-ref.html">Macros
			</a><a href="/releases/5.2.0/chapters/400-commands.html">Commands
			</a><div class="releases"><button class="dropbtn">5.2.0</button><div class="dropdown-content"></div></div>
	<li class=menu-link span=1>
			<a href="https://github.com/bndtools/bnd" target="_"><img
	style="position:absolute;top:0;right:0;margin:0;padding:0;z-index:100"
	src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67"
	alt="Fork me on GitHub"
	data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
</ul>


					

	<ul class=container12>
		<li span=3>
			<div>
			<ul class="side-nav">
	
		
			<li><a href="/releases/5.2.0/chapters/110-introduction.html">Introduction</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/120-install.html">How to install bnd</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/123-tour-workspace.html">Guided Tour</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/125-tour-features.html">Guided Tour Workspace & Projects</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/130-concepts.html">Concepts</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/140-best-practices.html">Best practices</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/150-build.html">Build</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/155-project-setup.html">Project Setup</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/160-jars.html">Generating JARs</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/170-versioning.html">Versioning</a>
	  	
  	
		
			<li class=selected>Baselining
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/200-components.html">Service Components</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/210-metatype.html">Metatype</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/220-contracts.html">Contracts</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/230-manifest-annotations.html">Bundle Annotations</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/235-accessor-properties.html">Accessor Properties</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/240-spi-annotations.html">SPI Annotations</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/250-resolving.html">Resolving Dependencies</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/300-launching.html">Launching</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/305-startlevels.html">Startlevels</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/310-testing.html">Testing</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/315-launchpad-testing.html">Testing with Launchpad</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/320-packaging.html">Packaging Applications</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/330-jpms.html">JPMS Libraries</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/390-wrapping.html">Wrapping Libraries to OSGi Bundles</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/395-generating-documentation.html">Generating Documentation</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/400-commands.html">Commands</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/600-developer.html">For Developers</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/650-windows.html">Tips for Windows users</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/700-tools.html">Tools bound to bnd</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/800-headers.html">Headers</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/820-instructions.html">Instruction Reference</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/825-instructions-ref.html">Instruction Index</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/850-macros.html">Macro Reference</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/855-macros-ref.html">Macro Index</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/870-plugins.html">Plugins</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/875-external-plugins.html">External Plugins</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/880-settings.html">Settings</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/900-errors.html">Errors</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/910-warnings.html">Warnings</a>
	  	
  	
		
			<li><a href="/releases/5.2.0/chapters/920-faq.html">Frequently Asked Questions</a>
	  	
  	
</ul>

			</div>
			
		<li span=9>
			<div class=notes-margin>
				<h1> Baselining</h1>
				<p>Baselining compares a bundle with another bundle, the <em>baseline</em>, to find mistakes in the semantic versioning. For example, there is a binary incompatible change in the new bundle but the version has not been bumped. Baselining can be run from the command line (see <code class="language-plaintext highlighter-rouge">bnd help baseline</code>) or it can be run as part of a project build.</p>

<p>APIs are compared for backward compatibility using the semantic versioning rules defined in this chapter. Baselining is aware of the <code class="language-plaintext highlighter-rouge">@ConsumerType</code> and <code class="language-plaintext highlighter-rouge">@ProviderType</code> rules. Proper versions are calculated and suggested.</p>

<h2 id="setting-up-a-project-for-baselining">Setting Up a Project for Baselining</h2>

<p>During the build, bnd will check the <code class="language-plaintext highlighter-rouge">-baseline</code> instruction at the end of the build when the JAR is ready. This instruction is a selector on the symbolic name of the building bundle. If it matches, the baselining is started with one exception: the bundle version must be more than 1.0.0. If the version is less no baselining is possible, the purpose is to allow the primordial baseline to be established without errors.</p>

<p>By default the baseline is a bundle from one of the repositories with the same symbolic name as the building bundle and the highest possible version. However, it is possible to specify the version or to baseline against a file, see <a href="../instructions/baseline.html">-baseline</a>.</p>

<p>It is recommended to enable baselining per project since not all project requires baselining. For example, baselining is overkill for a project that is always compiled with all its dependencies and thus has no external dependencies. The recommended practice is therefore to add the following instruction to a project that requires baselining (usually API bundles):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-baseline: *
</code></pre></div></div>

<p>The default baseline is the bundle with the highest version in the <em>baseline repository</em>. The selector can specify a <code class="language-plaintext highlighter-rouge">version</code> or a <code class="language-plaintext highlighter-rouge">file</code> attribute when the default baseline is not applicable.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">version</code> – Baseline against the first bundle in the baseline repository that has the given version or higher.</li>
  <li><code class="language-plaintext highlighter-rouge">file</code> – The file is the baseline.</li>
</ul>

<p>The baseline bundle is looked up in the <em>baseline repository</em>. The baseline repository is by default the <em>release repository</em> unless overridden by the <a href="../instructions/baselinerepo.html">-baselinerepo</a> instruction. The release repository is set with the <a href="../instructions/releaserepo.html">-releaserepo</a> instruction.</p>

<p>Only bundles that are not <em>staging</em> are considered for the baseline, this means that it is possible to release the current bundle and compare against the previous version until the bundle is released and becomes master.</p>

<p>By default the bundle and baseline are compared (<em>diffed</em>) and then analyzed for semantic version violations. Certain headers always change because they contain time or digest information. Most of these headers are already automatically ignored but the <a href="../instructions/diffignore.html">-diffignore</a> instruction can add more ignorance. You can use the 
<a href="../instructions/diffpackages.html">-diffpackages</a> instruction to specify the names of exported packages to be baseline compared. The default is to baseline compare all exported packages.</p>

<h2 id="example-baselining-project-instructions">Example baselining Project Instructions</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Bundle-Version: 1.0.2
  -baseline: *
  -baselinerepo: Released
</code></pre></div></div>

<p>In this example, the last version in the Released repository for the project’s bsn is supposed to be the previous version. Make sure you do not always release staging versions to this repository since this will create false changes. During a development cycle, the baseline version must remain constant until the current development bundle is released, at which points it becomes the baseline of the next cycle.</p>

<p>Since an error is raised when the baselining detects a semantic version violation it is possible to release a snapshot in a build only when there is a correctly baselined bundle built.</p>

<h3 id="baselineignore---fine-grained-control"><code class="language-plaintext highlighter-rouge">@BaselineIgnore</code> - Fine grained control</h3>

<p>Occasionally, scenarios arise where a language construct or change is not accounted for in bnd (bnd developers are humans too), or where a developer wants to overrule the strict opinion of the baseline logic for whatever reason (not recommended but it does happen) for instance in the grey areas of binary compatibility.</p>

<p>Instead of forcing developers to make a choice between disabling baseline (in order to avoid build warnings or failures) and keeping it enabled it’s important to know that there is fine grained control available using bnd’s <code class="language-plaintext highlighter-rouge">@aQute.bnd.annotation.baseline.BaselineIgnore</code> annotation.</p>

<p>The value of the <code class="language-plaintext highlighter-rouge">@BaselineIgnore</code> annotation is a valid OSGi version string.</p>

<p>e.g.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@BaselineIgnore</span><span class="o">(</span><span class="s">"2.4.12"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Foo</span> <span class="nf">getFoo</span><span class="o">();</span>
</code></pre></div></div>

<p>When the <code class="language-plaintext highlighter-rouge">@BaselineIgnore</code> annotation is applied to a <em>baselined</em> element, the <em>baseliner</em> will ignore the annotated element when baselining against a baseline package whose version is less than the specified version. This means the annotated element will not produce a baselining mismatch. The correct baseline information about the element will be in the baseline report, but the element will not cause baselining to fail. When baselining against a baseline package whose version is greater than or equal to the specified version, this annotation is ignored and the annotated element will be included in the baselining.</p>

<p>The annotation should be used in a scope that is as narrow as possible by applying it to the most specific member causing the baseline <em>issue</em>.</p>

			</div>
	</ul>

	
<nav class=next-prev>
	<a href='/releases/5.2.0/chapters/170-versioning.html'></a> <a href='/releases/5.2.0/chapters/200-components.html'></a>
</nav>
<footer class="container12" style="border-top: 1px solid black;padding:10px 0">
	<ul span=12 row>
		<li span=12>
			<ul>
				<li><a href="/releases/5.2.0/">GitHub</a>
			</ul>
	</ul>
</footer>

</body>
</html>
