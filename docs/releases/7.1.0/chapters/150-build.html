<!DOCTYPE html>
<html lang="en" ng-app="jpm">

	<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="/release//css/style.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="/js/releases.js"></script>

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Build | bnd</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Build" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This chapter lays out the rules of the file system for bnd projects. It discusses the workspace layout and the projects layout as well as the properties." />
<meta property="og:description" content="This chapter lays out the rules of the file system for bnd projects. It discusses the workspace layout and the projects layout as well as the properties." />
<meta property="og:site_name" content="bnd" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Build" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"This chapter lays out the rules of the file system for bnd projects. It discusses the workspace layout and the projects layout as well as the properties.","headline":"Build","url":"/release/chapters/150-build.html"}</script>
<!-- End Jekyll SEO tag -->


	

	

	

	

	

	

	
		<style>
			 body {
				counter-reset: h1 7;
			}
		</style>
	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

</head>


<body>

	
<ul class="container12 menu-bar" style="display:flex;align-items:center">
	<li span=8><a class=menu-link href="/release//"><img
			class=menu-logo src="/release//img/bnd-80x40-white.png"></a>
			<a href="/release//chapters/110-introduction.html">Intro
			</a><a href="/release//chapters/800-headers.html">Headers
			</a><a href="/release//chapters/825-instructions-ref.html">Instructions
			</a><a href="/release//chapters/855-macros-ref.html">Macros
			</a><a href="/release//chapters/400-commands.html">Commands
			</a><div class="releases">
			         <button class="dropbtn"><span class="fa fa-bars"></span> </button>
			         <div class="dropdown-content"></div>
			   </div>
    <li span=4>     
        <div class="search-container">
			<form method="get" id="search" action="https://google.com/search" target="_blank">
			    <input type="hidden" name="as_q" value="site:bndtools.org OR site:bnd.discourse.group"/>
			    <input type="text" name="q" placeholder="Searchâ€¦" aria-label="Search https://google.com for bnd specific"/>
			    <button type="submit" class="fa fa-search"></button>
            </form>
       </div>
</ul>
<div class=menu-link span=0><a
	id="repo-link"
	href="https://github.com/bndtools/bnd/blob/master/docs/_chapters/150-build.md"
	target="_blank"
>
	<img
		style="
			position: absolute;
			top: 0;
			right: 0;
			margin: 0;
			padding: 4px;
			z-index: 100;
			width: 45px;
		"
		src="/img/github-mark.svg"
		alt="Fork me on GitHub"
		title="Fork me on GitHub"
/></a>
</div>



					

	<ul class=container12>
		<li span=3>
			<div class="side-nav">
			
	
	<ul class="side-nav">
	<li><span class="side-nav-section">Getting Started</span>
		<ul class="side-nav">
		
			
				
				
			
				

					
					<li><a href="/release//chapters/120-install.html">How to install bnd</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/123-tour-workspace.html">Guided Tour</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/125-tour-features.html">Guided Tour Workspace & Projects</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/920-faq.html">FAQ - Frequently Asked Questions</a></li>
					

				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Concepts and Practices</span>
		<ul class="side-nav">
		
			
				

					
					<li><a href="/release//chapters/110-introduction.html">Introduction</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/130-concepts.html">Concepts</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/140-best-practices.html">Best practices</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Build and Development</span>
		<ul class="side-nav">
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/155-project-setup.html">Project Setup</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/160-jars.html">Generating JARs</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/170-versioning.html">Versioning</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/180-baselining.html">Baselining</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/200-components.html">Service Components</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/210-metatype.html">Metatype</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/220-contracts.html">Contracts</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/230-manifest-annotations.html">Bundle Annotations</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/235-accessor-properties.html">Accessor Properties</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/240-spi-annotations.html">SPI Annotations</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Dependency and Launching</span>
		<ul class="side-nav">
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/250-resolving.html">Resolving Dependencies</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/300-launching.html">Launching</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/305-startlevels.html">Startlevels</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Testing</span>
		<ul class="side-nav">
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/310-testing.html">Testing</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/315-launchpad-testing.html">Testing with Launchpad</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Packaging and Distribution</span>
		<ul class="side-nav">
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/320-packaging.html">Packaging Applications</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/330-jpms.html">JPMS Libraries</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/390-wrapping.html">Wrapping Libraries to OSGi Bundles</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Documentation and Tools</span>
		<ul class="side-nav">
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/395-generating-documentation.html">Generating Documentation</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/400-commands.html">Commands</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/600-developer.html">For Developers</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/620-template-fragments.html">Templates for Workspaces</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/650-windows.html">Tips for Windows users</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/700-tools.html">Tools bound to bnd</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Reference Material</span>
		<ul class="side-nav">
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/790-reference.html">Reference</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/800-headers.html">Headers</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/820-instructions.html">Instruction Reference</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/825-instructions-ref.html">Instruction Index</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/850-macros.html">Macro Reference</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/855-macros-ref.html">Macro Index</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/870-plugins.html">Plugins</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/875-external-plugins.html">External Plugins</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Configuration and Troubleshooting</span>
		<ul class="side-nav">
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/880-settings.html">Settings</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/900-errors.html">Errors</a></li>
					

				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/910-warnings.html">Warnings</a></li>
					

				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>




			</div>
			
		<li span=9>
			<div class=notes-margin>
			
				<h1> Build                    
				</h1>
				<p>This chapter lays out the rules of the file system for bnd projects. It discusses the workspace layout and the projects layout as well as the properties.</p>

<h2 id="workspace">Workspace</h2>
<p>A Workspace is a single directory with all its sub-directories and their files, similar to a git workspace. The core idea of the workspace is that it is easy to move around, that is, it allows the use of relative file names. It also prevents a lot of potential problems that occur when you allow projects to be anywhere on the file system. KISS!</p>

<p>Workspaces should be named according to the bundle symbolic names of its projects. Using such a naming strategy will simplify finding the correct namespace given a bundle symbolic name.</p>

<p>A bndlib workspace is a <em>valid</em> workspace when it contains a <code class="language-plaintext highlighter-rouge">cnf</code> file. If this is a text file, its content is read and interpreted as a path to the <code class="language-plaintext highlighter-rouge">cnf</code> directory (which can again be a path to a cnf directory, ad infinitum). The retrieved path is trimmed after which it is resolved relative to its parent directory.</p>

<p>However, the advised model is to use a directory with a <code class="language-plaintext highlighter-rouge">cnf/build.bnd</code> file. The purpose of the <code class="language-plaintext highlighter-rouge">cnf</code> directory is to provide a place for shared information. Though this includes bndlib setup information, it also can be used to define for example shared licensing, copyright, and vendor headers for your organization.</p>

<h3 id="the-cnfext-directory">The cnf/ext directory</h3>

<p>The <code class="language-plaintext highlighter-rouge">cnf</code> directory can have an <code class="language-plaintext highlighter-rouge">ext</code> directory. Files in this directory are added to the properties
of the workspace. They can have the following extensions:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">.bnd</code> â€“ Contain bnd properties</li>
  <li><code class="language-plaintext highlighter-rouge">.pmvn</code> â€“ An index file for a <a href="/plugins/maven.html">Maven Bnd Repository</a>. The first lines can contain properties for this plugin in the format of <code class="language-plaintext highlighter-rouge"># key = value</code>, e.g. <code class="language-plaintext highlighter-rouge"># name = OSGi R8</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">.pobr</code> â€“ An OSGi Repository file in XML.</li>
</ul>

<h4 id="automatically-registering-repositories">Automatically registering repositories</h4>

<p>Files with <code class="language-plaintext highlighter-rouge">.pmvn</code> or <code class="language-plaintext highlighter-rouge">.pobr</code> will be automatically registered as a Repository and show up in the Repository browser (means, no Plugin configuration needed). This is a convenience shortcut to add a repository with almost no configuration.</p>

<p><strong>Example /cnf/ext/central.pmvn file:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># name = My Maven Central Repo
# releaseUrl = https://repo.maven.apache.org/maven2/
# tags = resolve
biz.aQute.bnd:biz.aQute.bndlib:7.0.0
biz.aQute.bnd:aQute.libg:7.0.0

</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">ext</code> directory is a convenient way to add add reusable components. See <a href="620-template-fragments.html">template fragments</a> how they can be used to manage workspaces. When files change in this directory the workspace will be reloaded.</p>

<h3 id="the-cnfcache-directory">The cnf/cache directory</h3>

<p>To cache some intermediate files, bndlib will create a <code class="language-plaintext highlighter-rouge">cnf/cache/</code> directory, this file should not be under source control. E.g. in Git it should be defined in the <code class="language-plaintext highlighter-rouge">.gitignore</code> file.</p>

<h3 id="folder-structure">Folder structure</h3>

<p>Overall, this gives us the following layout for a workspace:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>com.acme.prime/                     workspace
  cnf/                              configuration/setup
    ext/                            extensions
      maven.bnd                     maven setup extension
    build.bnd                       organization setup
    plugins/                        directory for plugins
    cache/                          bnd cache directory, should not be saved in an scm
  com.acme.prime.speaker/           project directory	  
</code></pre></div></div>

<p>The root of the workspace is generally used to hold other files. For example the <code class="language-plaintext highlighter-rouge">.git</code> directory for Git, or gradle and ant files for continuous integration. However, designers that add functionality to the workspace should strive to minimize the clutter in the root. For example, the bnd gradle support adds a few files to the root but these link to a <code class="language-plaintext highlighter-rouge">cnf/gradle</code> directory for their actual content.</p>

<p>Other directories in the workspace represent <em>projects</em>. The name of the project is the bundle symbolic name of the bundle that it produces (or the prefix of the bundle symbolic name when it produces multiple bundles).</p>

<h3 id="workspace-properties">Workspace Properties</h3>

<p>Properties are used for headers, macros, and instructions in bndlib, they are quite fundamental. To simplify maintenance, bndlib provides an elaborate mechanism to provide these properties from different places and <em>inherit</em> them. The workspace resides at the top of this inheritance chain (ok, after the built-in defaults).</p>

<p>When a workspace is created, it will first read in the properties in the <code class="language-plaintext highlighter-rouge">.bnd</code> files in the <code class="language-plaintext highlighter-rouge">cnf/ext</code> directory. These are called the <em>extension files</em> since they in general setup plugins and other extensions. The order in which they are read is the lexical sorting order of their file names.</p>

<h2 id="target-build-directory">Target build directory</h2>

<p>The <code class="language-plaintext highlighter-rouge">target-dir</code> defines where the build process places the build output artifacts. By default this folder is named <code class="language-plaintext highlighter-rouge">generated</code>.</p>

<h3 id="avoiding-target-dir-conflicts-between-different-build-tools">Avoiding target-dir conflicts between different build tools</h3>

<p>In the default setup of the workspace, the gradle build tool &amp; eclipse share the same output directories. In general, this means you always have to clean in each tool and in the case of Eclipse stop the incremental builder (otherwise eclipse will start rebuilding the whole workspace when you do a <code class="language-plaintext highlighter-rouge">gradle clean build</code>).</p>

<p>All the output directories are defined in macros. In general, the <code class="language-plaintext highlighter-rouge">${target-dir}</code> is the main output directory and the <code class="language-plaintext highlighter-rouge">${bin}</code> and <code class="language-plaintext highlighter-rouge">${testbin}</code> are placed inside this directory. So by redefining <code class="language-plaintext highlighter-rouge">${target-dir}</code> in <code class="language-plaintext highlighter-rouge">cnf/build.bnd</code> we can redirect all output.</p>

<p>bnd has a macro <code class="language-plaintext highlighter-rouge">${driver}</code> that indicates which build tool (a.k.a. the driver) is used. We can then use this as follows, to use a separate output directory for each build tool (e.g. eclipse, gradle, maven):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>target-dir              generated${if;${driver;eclipse};;/${driver}}
bin                     ${target-dir}/classes
testbin                 ${target-dir}/test-classes
</code></pre></div></div>

<p>This example configuration, placed in <code class="language-plaintext highlighter-rouge">cnf/build.bnd</code> means:</p>

<ul>
  <li>eclipse build puts the build output directly into  the <code class="language-plaintext highlighter-rouge">generated</code> folder of each project.</li>
  <li>gradle build puts the build outputs in <code class="language-plaintext highlighter-rouge">generated/gradle</code>.</li>
</ul>

<h3 id="extension-files">Extension Files</h3>

<p>Extension files allow you to separate configuration concerns. Its primary purpose is to allow third party extensions. These extensions can then put their properties in one place. The contents of these files should therefore not be touched so that a new version can override them. Each extension file is read as a bnd file, this means that full power of bndlib is available. The bnd command line tool has facilities to add and remove files from this directory.</p>

<p>For example, the Maven plugin that is built-in to bndlib has an extension file called maven.bnd which looks as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#
# Plugin maven setup
#
-plugin.maven = aQute.bnd.plugin.maven.MavenPlugin


#
# Change disk layout to fit maven
#

-outputmask = ${@bsn}-${versionmask;===S;${@version}}.jar
src=src/main/java
bin=target/classes
testsrc=src/test/java
testbin=target/test-classes
target-dir=target
</code></pre></div></div>

<p>We will not explain this plugin here (you can find it in the <a href="/chapters/870-plugins.html">plugin sections</a>), it only illustrates here how it is possible to setup the environment for a specific optional functionality like a plugin.</p>

<p>If you create local extension files then you should use a prefix to identify this is your file, like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>com.acme-local.bnd
</code></pre></div></div>

<p>It is possible to use file links to maintain these files in one place when you have many workspaces.</p>

<h3 id="extension-file-loading-mechanism-and-order">Extension File loading mechanism and order</h3>

<p>Extension files will be loaded in alphabetical order. If a files defines a property that was already defined in another previously loaded file or the <code class="language-plaintext highlighter-rouge">build.bnd</code>, the property will be assigned a namespace. <code class="language-plaintext highlighter-rouge">-plugin</code> in <code class="language-plaintext highlighter-rouge">/cnf/ext/test.bnd</code> will become <code class="language-plaintext highlighter-rouge">-plugin.test</code>. Please note that this mechanism is just a best guess courtesy and has its limits. If <code class="language-plaintext highlighter-rouge">-plugin.test</code> was already defined previously, the old value will be overwritten.</p>

<h3 id="local-customizations">Local customizations</h3>

<p>After reading the extension files, bndlib reads the <code class="language-plaintext highlighter-rouge">cnf/build.bnd</code> file, this file is supposed to hold the organization specific properties. Out of the box, this file comes empty, ready to be filled by you.</p>

<h3 id="workspace-plugins">Workspace Plugins</h3>

<p>A <em>plugin</em> is a piece of code that runs inside bnd. The workspace provides a number of standard built-in plugins like an Executor, a Randum number generator, itself, etc. Additional plugins can be added with the <code class="language-plaintext highlighter-rouge">-plugin.*</code> instructions.</p>

<h2 id="project-properties">Project Properties</h2>
<p>There are a number of built in properties that are set by bnd:</p>

<table>
  <thead>
    <tr>
      <th>Property name</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">project</code></td>
      <td style="text-align: left">Name of the project. This is the name of the bnd file without</td>
    </tr>
    <tr>
      <td>Â </td>
      <td style="text-align: left">the .bnd extension. If this name is bnd.bnd, then the directory</td>
    </tr>
    <tr>
      <td>Â </td>
      <td style="text-align: left">name is used.</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">project.file</code></td>
      <td style="text-align: left">Absolute path of the main bnd file.</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">project.name</code></td>
      <td style="text-align: left">Just the name part of the file path</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">project.dir</code></td>
      <td style="text-align: left">The absolute path of the directory in which the bnd file resides.</td>
    </tr>
  </tbody>
</table>

<h2 id="run-instructions">Run instructions</h2>
<p>Run instructions are used to start OSGi tests and OSGi runs.</p>

<table>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">-runbundles</code></td>
      <td><code class="language-plaintext highlighter-rouge">LIST SPEC</code></td>
      <td>Additional bundles that will be installed and started when the framework is launched. This property is normally part of the projectâ€™s <code class="language-plaintext highlighter-rouge">bnd.bnd</code> file.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">-runvm</code></td>
      <td><code class="language-plaintext highlighter-rouge">PROPERTIES</code></td>
      <td>Properties given to the VM before launching. This property is normally set in the <code class="language-plaintext highlighter-rouge">cnf/build.bnd</code> file and only in rare cases overridden in the <code class="language-plaintext highlighter-rouge">bnd.bnd</code> file.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">-runproperties</code></td>
      <td><code class="language-plaintext highlighter-rouge">PROPERTIES</code></td>
      <td>Properties given to the framework when launching. Usually project specific.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">-runsystempackages</code></td>
      <td><code class="language-plaintext highlighter-rouge">PACKAGES</code></td>
      <td>A declaration like Import-Package that specifies additional system packages to import from the class path. Usually given in the <code class="language-plaintext highlighter-rouge">cnf/build.bnd</code> file.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">-runpath</code></td>
      <td><code class="language-plaintext highlighter-rouge">LIST SPEC</code></td>
      <td>A path description of artifacts that must be on the classpath of the to be launched framework.  Usually given in the <code class="language-plaintext highlighter-rouge">cnf/build.bnd</code> file. This path should contain the framework. Any packages that a bundle on the <code class="language-plaintext highlighter-rouge">-runpath</code> should specify should be listed in the <code class="language-plaintext highlighter-rouge">export</code> attribute.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">-runtrace</code></td>
      <td><code class="language-plaintext highlighter-rouge">true|false</code></td>
      <td>Trace the startup of the framework to the console. Usually used during testing and development so project specific.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">-runframework</code></td>
      <td><code class="language-plaintext highlighter-rouge">none|services</code></td>
      <td><code class="language-plaintext highlighter-rouge">NONE</code> indicates that a mini built in framework should be used. <code class="language-plaintext highlighter-rouge">SERVICES</code> indicates that the <code class="language-plaintext highlighter-rouge">META-INF/services</code> model must be followed for the <code class="language-plaintext highlighter-rouge">org.osgi.framework.launch.FrameworkFactory</code> class. Project specific.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">-testpath</code></td>
      <td><code class="language-plaintext highlighter-rouge">LIST SPEC</code></td>
      <td>A path used to specify the test plugin.</td>
    </tr>
  </tbody>
</table>

<h2 id="launching">Launching</h2>
<p>Launching is needed when the projectâ€™s <code class="language-plaintext highlighter-rouge">run</code> action or <code class="language-plaintext highlighter-rouge">test</code> action is executed. The project creates a Project Launcher. A Project Launcher must launch a new VM and set up this VM correctly. The VM is launched with the following information:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">java</code> - The command to launch a new VM is by default <code class="language-plaintext highlighter-rouge">java</code>. However, this can be overridden by setting a property called <code class="language-plaintext highlighter-rouge">java</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">classpath</code> - The classpath set for the VM is derived from the <code class="language-plaintext highlighter-rouge">-runpath</code> property. Notice that this is supposed to contain the JAR with the framework. The <code class="language-plaintext highlighter-rouge">-runpath</code> requires bundle symbolic names for the JAR and an optional version range. bnd will use the latest version found in the repository. Any packages that should be exported by the system bundle should have an <code class="language-plaintext highlighter-rouge">export</code> attribute containing the exported packages, like <code class="language-plaintext highlighter-rouge">junit.osgi;version=3.8;export="junit.framework;version=3.8,junit.misc;version=3.8"</code>.</li>
  <li>VM options - These options can be set in the <code class="language-plaintext highlighter-rouge">-runvm</code> property. They are usually in the form of <code class="language-plaintext highlighter-rouge">-Dxya=15</code> or <code class="language-plaintext highlighter-rouge">-X:agent=bla</code>. Options should be separated by commas.</li>
  <li><code class="language-plaintext highlighter-rouge">main</code> - The class implementing the main type is defined by the launcher plugin.</li>
</ul>

<p>An example of a launcher set is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-runvm:   -Xmn100M, -Xms500M, -Xmx500M
-runpath: \
	org.apache.felix.framework; version=3.0, \
	junit.osgi;export="junit.framework;version=3.8"
-runtrace: true
-runproperties: launch=42, trace.xyz=true
-runbundles: org.apache.felix.configadmin,\
	org.apache.felix.log,\
	org.apache.felix.scr,\
	org.apache.felix.http.jetty,\
	org.apache.felix.metatype,\
	org.apache.felix.webconsole
</code></pre></div></div>

<p>Debugging the launcher is greatly simplified with the <code class="language-plaintext highlighter-rouge">-runtrace</code> property set to <code class="language-plaintext highlighter-rouge">true</code>. This provides a lot of feedback what the launcher is doing.</p>

<h3 id="access-to-arguments">Access to arguments</h3>
<p>When the Framework is started the Launcher will register itself as a service of type <code class="language-plaintext highlighter-rouge">java.lang.Object</code> with the property <code class="language-plaintext highlighter-rouge">launcher.arguments</code> to provide access the arguments handed to the launcher. After all Bundles have been installed and started the ServiceRegistration will be updated with the property <code class="language-plaintext highlighter-rouge">launcher.ready=true</code>.</p>

<h3 id="access-to-main-thread">Access to main thread</h3>
<p>In certain cases it is necessary to grab the main thread after launching. The default launcher will launch all the bundles and then wait for any of those bundles to register a <code class="language-plaintext highlighter-rouge">Runnable</code> service with a service property <code class="language-plaintext highlighter-rouge">main.thread=true</code>. If such  service is registered, the launcher will call the run method and exit when this method returns.</p>

<h3 id="timeout">Timeout</h3>
<p>The launcher will timeout after an hour. There is currently no way to override this timeout.</p>

<h3 id="mini-framework">Mini Framework</h3>
<p>The bnd launcher contains a mini framework that implements the bare bones of an OSGi framework. The purpose of this mini framework is to allow tests and runs that want to launch their own framework. A launch that wants to take advantage of this can launch with the following property:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-runframework: none
</code></pre></div></div>

<h3 id="ant">Ant</h3>
<p>In Ant, the following task provides the run facility.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;target name="run" depends="compile"&gt;
	&lt;bnd command="run" exceptions="true" basedir="${project}" /&gt;
&lt;/target&gt;
</code></pre></div></div>

<p>These targets provide commands for <code class="language-plaintext highlighter-rouge">ant run</code>.</p>

<h2 id="testing">Testing</h2>
<p>Testing is in principle the same as launching, it actually uses the launcher. Testing commences with the <code class="language-plaintext highlighter-rouge">test</code> action in the project. This creates a Project Tester. bnd carries a default Project Tester but this can be overridden.</p>

<p>The basic model of the default Project Tester plugin is to look for bundles that have a <code class="language-plaintext highlighter-rouge">Test-Cases</code> manifest header after launching. The value of this header is a comma separated list of JUnit test case class names. For example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Test-Cases: test.LaunchTest, test.OtherTest
</code></pre></div></div>

<p>Maintaining this list can be cumbersome and for that reason the <code class="language-plaintext highlighter-rouge">${classes}</code> macro can be used to calculate its contents:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Test-Cases: ${classes;extending;junit.framework.TestCase;concrete}
</code></pre></div></div>

<p>See <a href="../macros/classes.html">classes macro</a> for more information.</p>

<h3 id="ant-1">Ant</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;target name="test" depends="compile"&gt;
	&lt;bnd command="test" exceptions="true" basedir="${project}" /&gt;
&lt;/target&gt;
</code></pre></div></div>

<h2 id="overriding-the-plugins">Overriding the plugins</h2>
<p>Both the Project Launcher and Project Tester are plugins. Defaults are provided by bnd itself (bnd carries a mini cache repo that is expanded in the <code class="language-plaintext highlighter-rouge">cnf</code> directory), it is possible to add new launchers and testers as needed.</p>

<p>Launcher or tester plugins are found on the <code class="language-plaintext highlighter-rouge">-runpath</code> or the <code class="language-plaintext highlighter-rouge">-testpath</code> properties, respectively. To detect a plugin, bnd will look for an appropriate manifest header. The header value is a class name. Bnd will then instantiate the class and use it as a launcher/tester. The classes must extend an abstract base class. Each plugin has access to the <code class="language-plaintext highlighter-rouge">Project</code> object, containing all the details of the project.</p>

<table>
  <thead>
    <tr>
      <th>Plugin</th>
      <th>Manifest header</th>
      <th>Base Class</th>
      <th>Where searched</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Project Launcher</td>
      <td>Launcher-Plugin</td>
      <td>ProjectLauncher</td>
      <td>-runpath</td>
    </tr>
    <tr>
      <td>Project Tester</td>
      <td>Tester-Plugin</td>
      <td>ProjectLauncher</td>
      <td>-testpath</td>
    </tr>
  </tbody>
</table>

<p>The plugin gets complete control and can implement many different strategies.</p>

			</div>
	</ul>

	
<nav class=next-prev>
	<a href='/release//chapters/140-best-practices.html'></a> <a href='/release//chapters/155-project-setup.html'></a>
</nav>
<footer class="container12" style="border-top: 1px solid black;padding:10px 0">
	<ul span=12 row>
		<li span=12>
			<ul>
				<li><a href="/release//">Home</a>
			</ul>
	</ul>
</footer>

</body>
</html>
