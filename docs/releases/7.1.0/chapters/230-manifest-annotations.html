<!DOCTYPE html>
<html lang="en" ng-app="jpm">

	<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="/release//css/style.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="/js/releases.js"></script>

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Bundle Annotations | bnd</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Bundle Annotations" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Manifest headers are challenging to keep in sync with the code in the bundle. It often takes several attempts to get all the details correct." />
<meta property="og:description" content="Manifest headers are challenging to keep in sync with the code in the bundle. It often takes several attempts to get all the details correct." />
<meta property="og:site_name" content="bnd" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Bundle Annotations" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Manifest headers are challenging to keep in sync with the code in the bundle. It often takes several attempts to get all the details correct.","headline":"Bundle Annotations","url":"/release/chapters/230-manifest-annotations.html"}</script>
<!-- End Jekyll SEO tag -->


	

	

	

	

	

	

	

	

	

	

	

	

	

	

	
		<style>
			 body {
				counter-reset: h1 15;
			}
		</style>
	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

</head>


<body>

	
<ul class="container12 menu-bar" style="display:flex;align-items:center">
	<li span=8><a class=menu-link href="/release//"><img
			class=menu-logo src="/release//img/bnd-80x40-white.png"></a>
			<a href="/release//chapters/110-introduction.html">Intro
			</a><a href="/release//chapters/800-headers.html">Headers
			</a><a href="/release//chapters/825-instructions-ref.html">Instructions
			</a><a href="/release//chapters/855-macros-ref.html">Macros
			</a><a href="/release//chapters/400-commands.html">Commands
			</a><div class="releases">
			         <button class="dropbtn"><span class="fa fa-bars"></span> </button>
			         <div class="dropdown-content"></div>
			   </div>
    <li span=4>     
        <div class="search-container">
			<form method="get" id="search" action="https://google.com/search" target="_blank">
			    <input type="hidden" name="as_q" value="site:bndtools.org OR site:bnd.discourse.group"/>
			    <input type="text" name="q" placeholder="Searchâ€¦" aria-label="Search https://google.com for bnd specific"/>
			    <button type="submit" class="fa fa-search"></button>
            </form>
       </div>
</ul>
<div class=menu-link span=0><a
	id="repo-link"
	href="https://github.com/bndtools/bnd/blob/master/docs/_chapters/230-manifest-annotations.md"
	target="_blank"
>
	<img
		style="
			position: absolute;
			top: 0;
			right: 0;
			margin: 0;
			padding: 4px;
			z-index: 100;
			width: 45px;
		"
		src="/img/github-mark.svg"
		alt="Fork me on GitHub"
		title="Fork me on GitHub"
/></a>
</div>



					

	<ul class=container12>
		<li span=3>
			<div class="side-nav">
			
	
	<ul class="side-nav">
	<li><span class="side-nav-section">Getting Started</span>
		<ul class="side-nav">
		
			
				
				
			
				

					
					<li><a href="/release//chapters/120-install.html">How to install bnd</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/123-tour-workspace.html">Guided Tour</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/125-tour-features.html">Guided Tour Workspace & Projects</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/920-faq.html">FAQ - Frequently Asked Questions</a></li>
					

				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Concepts and Practices</span>
		<ul class="side-nav">
		
			
				

					
					<li><a href="/release//chapters/110-introduction.html">Introduction</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/130-concepts.html">Concepts</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/140-best-practices.html">Best practices</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Build and Development</span>
		<ul class="side-nav">
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/155-project-setup.html">Project Setup</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/160-jars.html">Generating JARs</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/170-versioning.html">Versioning</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/180-baselining.html">Baselining</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/200-components.html">Service Components</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/210-metatype.html">Metatype</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/220-contracts.html">Contracts</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li class=selected>Bundle Annotations</li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/235-accessor-properties.html">Accessor Properties</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/240-spi-annotations.html">SPI Annotations</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Dependency and Launching</span>
		<ul class="side-nav">
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/250-resolving.html">Resolving Dependencies</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/300-launching.html">Launching</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/305-startlevels.html">Startlevels</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Testing</span>
		<ul class="side-nav">
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/310-testing.html">Testing</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/315-launchpad-testing.html">Testing with Launchpad</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Packaging and Distribution</span>
		<ul class="side-nav">
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/320-packaging.html">Packaging Applications</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/330-jpms.html">JPMS Libraries</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/390-wrapping.html">Wrapping Libraries to OSGi Bundles</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Documentation and Tools</span>
		<ul class="side-nav">
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/395-generating-documentation.html">Generating Documentation</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/400-commands.html">Commands</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/600-developer.html">For Developers</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/620-template-fragments.html">Templates for Workspaces</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/650-windows.html">Tips for Windows users</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/700-tools.html">Tools bound to bnd</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Reference Material</span>
		<ul class="side-nav">
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/790-reference.html">Reference</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/800-headers.html">Headers</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/820-instructions.html">Instruction Reference</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/825-instructions-ref.html">Instruction Index</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/850-macros.html">Macro Reference</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/855-macros-ref.html">Macro Index</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/870-plugins.html">Plugins</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/875-external-plugins.html">External Plugins</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>

	
	<ul class="side-nav">
	<li><span class="side-nav-section">Configuration and Troubleshooting</span>
		<ul class="side-nav">
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/880-settings.html">Settings</a></li>
					

				
				
			
				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/900-errors.html">Errors</a></li>
					

				
				
			
				
				
			
				
				
			
			
		
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				
				
			
				

					
					<li><a href="/release//chapters/910-warnings.html">Warnings</a></li>
					

				
				
			
				
				
			
			
		
		</ul>
	</li>
	</ul>




			</div>
			
		<li span=9>
			<div class=notes-margin>
			
				<h1> Bundle Annotations                    
				</h1>
				<p>Manifest headers are challenging to keep in sync with the code in the bundle. It often takes several attempts to get all the details correct.</p>

<p>One of the goals of bnd is to eliminate such issues by relying on Javaâ€™s type system to express the semantics of OSGi metadata.</p>

<p>To address this bnd pioneered <em>manifest annotations</em> which evolved into OSGiâ€™s <a href="https://osgi.org/specification/osgi.core/7.0.0/framework.api.html#org.osgi.annotation.bundle"><em>bundle annotations</em></a>. A <strong>bundle annotation</strong> is used to express metadata that cannot otherwise be derived from code.</p>

<p>A <em>bundle annotation</em> is applied to a type or package and when processed by bnd will cause the generation of corresponding manifest headers (and header clauses). Generating manifest headers from type safe structures is far less likely to result in errors, simplifies the developers life and is more conducive to code refactoring which wonâ€™t result in information loss.</p>

<p>The following example shows the <em>preferred way</em> to handle package versioning by applying the <a href="https://osgi.org/specification/osgi.core/7.0.0/framework.api.html#org.osgi.annotation.bundle.Export"><code class="language-plaintext highlighter-rouge">@Export</code></a> and <a href="https://osgi.org/specification/osgi.core/7.0.0/framework.api.html#org.osgi.annotation.versioning.Version"><code class="language-plaintext highlighter-rouge">@Version</code></a> <em>bundle annotations</em> to <code class="language-plaintext highlighter-rouge">com/acme/package-info.java</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Export</span>
<span class="nd">@Version</span><span class="o">(</span><span class="s">"1.3.4"</span><span class="o">)</span>
<span class="kn">package</span> <span class="nn">com.acme</span><span class="o">;</span>
</code></pre></div></div>

<p>which results in the manifest header:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Export-Package: com.acme;version="1.3.4"
</code></pre></div></div>

<h3 id="meta-infservices-annotations">META-INF/services Annotations</h3>

<p>Some developers do not want to rely on the additional dependency of bnd/OSGi annotations. For this reason, it is possible to also apply the annotations textually in comments to the files in the <code class="language-plaintext highlighter-rouge">META-INF/services</code>.
This trick avoids a compile time dependency. These Service Loader files have the name of a Service Loader <em>service</em> and contain the names of the implementation classes. One fully qualified name per line.</p>

<p>To make these annotations in the comments more readable, it is possible to import the fully qualified name of the annotation.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>META-INF/services/com.example.ServiceType:

   #import aQute.bnd.annotation.spi.ServiceProvider
   #@ServiceProvider(resolution:=optional)
   com.example.impl.Impl2
   #@ServiceProvider(attribute:List&lt;String&gt;="a=1, b=2")
   com.example.impl.Impl1
</code></pre></div></div>
<p>The processing is identical to the normal class based annotation processing. The <code class="language-plaintext highlighter-rouge">#class</code> macro will be set to the implementation class. The <code class="language-plaintext highlighter-rouge">#value</code> will be set in all cases to the service type unless overridden.</p>

<p>This behavior can be controlled with the <a href="/instructions/metainf-services.html">-metainf-services</a> instruction. Default is <code class="language-plaintext highlighter-rouge">annotation</code> which processes the textual annotations above, while the other convenience strategy <code class="language-plaintext highlighter-rouge">auto</code> automatically creates <code class="language-plaintext highlighter-rouge">Provide-Capability</code> headers for services without any textual annotations.</p>

<hr />

<p>While the above is a compromise, clearly using the real class annotation is far superior:</p>

<ul>
  <li>Help from the IDE</li>
  <li>Impossible to make typos</li>
  <li>Not necessary to manually maintain the META-INF/services/</li>
</ul>

<p>The analysis of these files happens after the analyzer plugins have been run. These plugins can add files if so desired.</p>

<p>Since the annotations &amp; imports happen in the comments, it is not possible to diagnose any errors. If the comment does not match its regular expression, it will be silently ignored.</p>

<h3 id="requirement--capability-annotations">@Requirement &amp; @Capability Annotations</h3>

<p>Though Java class files contain enough information to find code dependencies, there are many dependencies that are indirect. OSGi <em>extenders</em> for instance are often a requirement to make a bundle function correctly but often client bundles have no code dependency on the extender. For example, Declarative Services (DS) went out of its way to allow components to be Plain Old Java Objects (POJO). The result is that resolving a closure of bundles starting from a DS client bundle would not drag in the Service Component Runtime (SCR), resulting in a satisfied but rather idle closure.</p>

<p>The solution was to describe the requirement for the runtime SCR dependency using <a href="https://osgi.org/specification/osgi.core/7.0.0/framework.module.html#framework.module.dependencies">Requirements and Capabilities</a>. But again, writing these complex clauses in the manifest by hand is both error prone and painful.</p>

<p>The <a href="https://osgi.org/specification/osgi.core/7.0.0/framework.api.html#org.osgi.annotation.bundle.Requirement"><code class="language-plaintext highlighter-rouge">@Requirement</code></a> and <a href="https://osgi.org/specification/osgi.core/7.0.0/framework.api.html#org.osgi.annotation.bundle.Capability"><code class="language-plaintext highlighter-rouge">@Capability</code></a> annotations were designed to address this issue. These annotations can be used to create <a href="#custom-bundle-annotations"><em>custom bundle annotations</em></a>, described later on. Letâ€™s discuss the DS example.</p>

<p>Recent DS specifications require implementations to provide the following capability:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Provide-Capability: osgi.extender;
    osgi.extender="osgi.component";
    version:Version="1.4.0";
    uses:="org.osgi.service.component"
</code></pre></div></div>

<p>While this provides a capability that can be required, we need a requirement to be generated from client code that uses DS. Enter recent versions of DS annotations which are meta-annotated with <code class="language-plaintext highlighter-rouge">@RequireServiceComponentRuntime</code>, a <em>custom bundle annotation</em> which is specified as:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Requirement</span><span class="o">(</span>
    <span class="n">namespace</span> <span class="o">=</span> <span class="nc">ExtenderNamespace</span><span class="o">.</span><span class="na">EXTENDER_NAMESPACE</span><span class="o">,</span>
	<span class="n">name</span> <span class="o">=</span> <span class="nc">ComponentConstants</span><span class="o">.</span><span class="na">COMPONENT_CAPABILITY_NAME</span><span class="o">,</span>
	<span class="n">version</span> <span class="o">=</span> <span class="nc">ComponentConstants</span><span class="o">.</span><span class="na">COMPONENT_SPECIFICATION_VERSION</span><span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">CLASS</span><span class="o">)</span>	
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">RequireServiceComponentRuntime</span> <span class="o">{</span> <span class="o">}</span>
</code></pre></div></div>

<p>If you inspect the source code for <code class="language-plaintext highlighter-rouge">@Component</code> youâ€™ll find it is meta-annotated with <code class="language-plaintext highlighter-rouge">@RequireServiceComponentRuntime</code>. When you write a DS component using <code class="language-plaintext highlighter-rouge">@Component</code> as follows</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
</code></pre></div></div>

<p>and because of the inherent <em>bundle annotations</em> it holds, the following manifest clause is generated</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Require-Capability: \
	osgi.extender; \
	filter:="(&amp;(osgi.extender=osgi.component)(version&gt;=1.4.0)(!(version&gt;=2.0.0)))"
</code></pre></div></div>

<p>The invisible link created between user code and the indirect requirement is a powerful mechanism that enables automatic validation of a bundle closure.</p>

<p>The actual requirement <code class="language-plaintext highlighter-rouge">filter:</code> directive is constructed from an <code class="language-plaintext highlighter-rouge">AND</code> of the <code class="language-plaintext highlighter-rouge">filter()</code>, <code class="language-plaintext highlighter-rouge">name()</code>, and <code class="language-plaintext highlighter-rouge">version()</code> annotation methods. All fields are optional. The name field will create an assertion that the given namespace equals the value of the <code class="language-plaintext highlighter-rouge">name()</code> annotation method. For example, if the namespace is <code class="language-plaintext highlighter-rouge">com.example.foo</code> and the <code class="language-plaintext highlighter-rouge">name()</code> method has the value <code class="language-plaintext highlighter-rouge">bar</code> then the filter is <code class="language-plaintext highlighter-rouge">(com.example.foo=bar)</code>. If a version is specified, it will be expanded to a filtered version-range expression.  The convention of using the namespace name as the property key is commonly used in OSGi specification. For example, the filter <code class="language-plaintext highlighter-rouge">(osgi.wiring.package=com.example.foo)</code> is the filter for an Import-Package <code class="language-plaintext highlighter-rouge">com.example.foo</code> while <code class="language-plaintext highlighter-rouge">osgi.wiring.package</code> is the namespace for the packages.</p>

<p>For example:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Requirement</span><span class="o">(</span><span class="n">namespace</span> <span class="o">=</span> <span class="s">"NAMESPACE"</span><span class="o">,</span> <span class="n">name</span><span class="o">=</span><span class="s">"NAME"</span><span class="o">,</span> <span class="n">version</span><span class="o">=</span><span class="s">"1.2.3"</span><span class="o">,</span> <span class="n">filter</span><span class="o">=</span><span class="s">"(foo=${#foo})"</span><span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">CLASS</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">RequireSomething</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="nf">foo</span><span class="o">();</span>
<span class="o">}</span>

<span class="nd">@RequireSomething</span><span class="o">(</span><span class="n">foo</span><span class="o">=</span><span class="mi">3</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{...}</span>
</code></pre></div></div>
<p>This will generate a manifest Require-Capability header of:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Require-Capability: \
    NAMESPACE; \
    filter:="(&amp;(foo=3)(NAMESPACE=NAME)(version&gt;=1.2.3)(!(version&gt;=2.0.0)))"   
</code></pre></div></div>

<h3 id="arbitrary-manifest-headers">Arbitrary Manifest Headers</h3>

<p><em>Bundle annotations</em> arenâ€™t just about package versioning or requirements and capabilities. They are about lifting <em>metadata</em> out of our code to avoid, among other things, error prone duplication of information. A common example is the bundle activator. Bundle Activators are require to be described in a manifest header. This association is not visible to refactoring tools and as such can easily end up out of sync.</p>

<p>The <a href="https://osgi.org/specification/osgi.core/7.0.0/framework.api.html#org.osgi.annotation.bundle.Header"><code class="language-plaintext highlighter-rouge">@Header</code></a> annotation exists to address this problem.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.acme</span><span class="o">;</span>

<span class="nd">@Header</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="nc">Constants</span><span class="o">.</span><span class="na">BUNDLE_ACTIVATOR</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"${@class}"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Activator</span> <span class="kd">implements</span> <span class="nc">BundleActivator</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
</code></pre></div></div>

<p>results in the manifest header:</p>

<p><code class="language-plaintext highlighter-rouge">Bundle-Activator: com.acme.Activator</code></p>

<h3 id="macros">Macros</h3>

<p>Youâ€™ll note the string <code class="language-plaintext highlighter-rouge">${@class}</code> used in the above example. String fields in <em>bundle annotations</em> are processed through bndâ€™s macro processor. This macro processor provides access to all default and builder macros. <em>More info on bnd macros can be found in the <a href="/chapters/850-macros.html">macros chapter</a>.</em></p>

<p>Bnd also provides access to certain key properties of the current processing state.</p>

<ul>
  <li><strong><em>@class</em></strong> - gives the fully qualified name of the annotated class</li>
  <li><strong><em>@class-short</em></strong> - gives the simple name of the annotated class</li>
  <li><strong><em>@package</em></strong> - gives the package of the annotated class</li>
  <li><strong><em>@version</em></strong> - gives the package version of the annotated class</li>
</ul>

<p>The <code class="language-plaintext highlighter-rouge">@Header</code> example above used the macro <code class="language-plaintext highlighter-rouge">${@class}</code> which lifted the <code class="language-plaintext highlighter-rouge">@class</code> property holding the class name of the activator into the header to avoid having to duplicate it. This also means that refactoring the activator wonâ€™t cause the manifest to get out of sync.</p>

<p>In the case that a bundle annotation is used as a meta annotation then the methods on the annotated annotation are available as macros as well with a name prefixed with <code class="language-plaintext highlighter-rouge">#</code>. That is, if the annotated annotation has a method <code class="language-plaintext highlighter-rouge">foo()</code>, then the macro <code class="language-plaintext highlighter-rouge">${#foo}</code> can be used to refer to its value. See <a href="235-accessor-properties.html">Accessor Properties</a> for more details.</p>

<h3 id="custom-bundle-annotations">Custom Bundle Annotations</h3>

<p>Certain <em>bundle annotations</em> have a second important use. We know that if applied to a type or package <em>bundle annotations</em> result in a clause in the manifest. However, many can be used as meta-annotations to a second annotation. The second annotation is considered a <strong><em>custom bundle annotation</em></strong>. The <em>custom bundle annotation</em> results in a manifest clause only when applied to a type or package.</p>

<p>This makes it possible to create an annotation for a subsystem. For example, an annotation <code class="language-plaintext highlighter-rouge">@ASL_2_0</code> that sets the <code class="language-plaintext highlighter-rouge">Bundle-License</code> header to the Apache Software License version 2.0.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@BundleLicense</span><span class="o">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"https://www.opensource.org/licenses/apache2.0.php"</span><span class="o">,</span>
    <span class="n">link</span> <span class="o">=</span> <span class="s">"https://www.apache.org/licenses/LICENSE-2.0.html"</span><span class="o">,</span>
    <span class="n">description</span> <span class="o">=</span> <span class="s">"Apache Software License 2.0"</span><span class="o">)</span>
<span class="nd">@interface</span> <span class="no">ASL_2_0</span> <span class="o">{}</span>

<span class="c1">// takes effect when applied to a type</span>

<span class="nd">@ASL_2_0</span>
<span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
</code></pre></div></div>

<h4 id="adding-attributes-and-directives">Adding Attributes and Directives</h4>

<p>When creating <em>custom bundle annotations</em> a common requirement is to make them parameterizable such that the values of the <em>custom bundle annotation</em> feed into the header clauses resulting from the <em>bundle annotation</em> applied to it (<em>remember; a <strong>custom bundle annotation</strong> is meta-annotated with a <strong>bundle annotation</strong></em>.)</p>

<p><a href="https://osgi.org/specification/osgi.core/7.0.0/">OSGi</a> specifies two annotations, <a href="https://osgi.org/specification/osgi.core/7.0.0/framework.api.html#org.osgi.annotation.bundle.Attribute"><code class="language-plaintext highlighter-rouge">@Attribute</code></a> and <a href="https://osgi.org/specification/osgi.core/7.0.0/framework.api.html#org.osgi.annotation.bundle.Directive"><code class="language-plaintext highlighter-rouge">@Directive</code></a>, for this purpose. Any methods of the <strong>custom bundle annotation</strong> annotated with <code class="language-plaintext highlighter-rouge">@Attribute</code> or  <code class="language-plaintext highlighter-rouge">@Directive</code> will result in those becoming additional attributes or directives respectively of the resulting header clause <em>when a value is supplied</em>.</p>

<h5 id="attribute"><code class="language-plaintext highlighter-rouge">@Attribute</code></h5>

<p><code class="language-plaintext highlighter-rouge">@Attribute</code> allows you to add new or update existing attributes from the <em>bundle annotation</em>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Capability</span><span class="o">(</span><span class="n">namespace</span> <span class="o">=</span> <span class="s">"foo.namespace"</span><span class="o">)</span>
<span class="nd">@interface</span> <span class="nc">Extended</span> <span class="o">{</span>
	<span class="nd">@Attribute</span><span class="o">(</span><span class="s">"foo.attribute"</span><span class="o">)</span> <span class="c1">// this attribute enhances the @Capability</span>
	<span class="nc">String</span> <span class="nf">value</span><span class="o">();</span>
<span class="o">}</span>

<span class="c1">// usage</span>

<span class="nd">@Extended</span><span class="o">(</span><span class="s">"bar"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{}</span>
</code></pre></div></div>

<p>which results in the manifest header:</p>

<p><code class="language-plaintext highlighter-rouge">Provide-Capability: foo.namespace;foo.attribute=bar</code></p>

<h5 id="directive"><code class="language-plaintext highlighter-rouge">@Directive</code></h5>

<p><code class="language-plaintext highlighter-rouge">@Directive</code> behaves similarly; with some caveats. You can add new or update existing directives for namespaces <em>not</em> defined by OSGi specifications.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Capability</span><span class="o">(</span><span class="n">namespace</span> <span class="o">=</span> <span class="s">"foo.namespace"</span><span class="o">)</span>
<span class="nd">@interface</span> <span class="nc">Extended</span> <span class="o">{</span>
	<span class="nd">@Directive</span><span class="o">(</span><span class="s">"foo.directive"</span><span class="o">)</span>
	<span class="nc">String</span> <span class="nf">value</span><span class="o">();</span>
<span class="o">}</span>

<span class="c1">// usage</span>

<span class="nd">@Extended</span><span class="o">(</span><span class="s">"bar"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{}</span>
</code></pre></div></div>

<p>results in the manifest header:</p>

<p><code class="language-plaintext highlighter-rouge">Provide-Capability: foo.namespace;foo.directive:=bar</code></p>

<p><strong>However</strong>, namespaces defined by OSGi specifications will be validated and will not accept directives which are not part of the spec <em>unless</em> they are prefixed with <code class="language-plaintext highlighter-rouge">x-</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Capability</span><span class="o">(</span><span class="n">namespace</span> <span class="o">=</span> <span class="s">"osgi.extender"</span><span class="o">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"bar"</span><span class="o">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s">"1.0.0"</span><span class="o">)</span>
<span class="nd">@interface</span> <span class="nc">Extended</span> <span class="o">{</span>
	<span class="nd">@Directive</span><span class="o">(</span><span class="s">"foo"</span><span class="o">)</span>
	<span class="nc">String</span> <span class="nf">value</span><span class="o">();</span>
<span class="o">}</span>

<span class="c1">// usage</span>

<span class="nd">@Extended</span><span class="o">(</span><span class="s">"bar"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{}</span>
</code></pre></div></div>

<p>will result in an error:</p>

<p><code class="language-plaintext highlighter-rouge">Unknown directive 'foo:' for namespace 'osgi.extender' in 'Provide-Capability'. Allowed directives are [effective:,uses:], and 'x-*'.</code></p>

<p><strong>It should be noted</strong> that itâ€™s possible to elide such errors using bndâ€™s <a href="/instructions/fixupmessages.html"><code class="language-plaintext highlighter-rouge">-fixupmessages</code></a> instruction.</p>

<p>This next example however:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Capability</span><span class="o">(</span><span class="n">namespace</span> <span class="o">=</span> <span class="s">"osgi.extender"</span><span class="o">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"bar"</span><span class="o">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s">"1.0.0"</span><span class="o">)</span>
<span class="nd">@interface</span> <span class="nc">Extended</span> <span class="o">{</span>
	<span class="nd">@Directive</span><span class="o">(</span><span class="s">"x-foo"</span><span class="o">)</span>
	<span class="nc">String</span> <span class="nf">value</span><span class="o">();</span>
<span class="o">}</span>

<span class="c1">// usage</span>

<span class="nd">@Extended</span><span class="o">(</span><span class="s">"bar"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{}</span>
</code></pre></div></div>

<p>results in the manifest header:</p>

<p><code class="language-plaintext highlighter-rouge">Provide-Capability: osgi.extender;osgi.extender=bar;version:Version="1.0.0";x-foo:=bar</code></p>

<p><strong>It should be noted</strong> that default values for methods annotated with <code class="language-plaintext highlighter-rouge">@Attribute</code> and <code class="language-plaintext highlighter-rouge">@Directive</code> are deemed to be for documentation purposes only and will not be emitted into resulting headers.</p>

<h4 id="accessor-properties">Accessor Properties</h4>

<p>For more customisation options see chapter on <a href="/chapters/235-accessor-properties.html">Accessor Properties</a>.</p>

<h3 id="where-to-find-bundle-annotations">Where to find Bundle Annotations</h3>

<p><strong>OSGi</strong> <em>bundle annotations</em> can be found in the <code class="language-plaintext highlighter-rouge">osgi.annotation</code> (e.g. <code class="language-plaintext highlighter-rouge">org.osgi:osgi.annotation:7.0.0</code>) bundle.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.osgi<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>osgi.annotation<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>7.0.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<p><strong>Bnd</strong> <em>bundle annotations</em> can be found in the <code class="language-plaintext highlighter-rouge">biz.aQute.bnd.annotations</code> (e.g. <code class="language-plaintext highlighter-rouge">biz.aQute.bnd:biz.aQute.bnd.annotation:5.0.0</code>) bundle.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>biz.aQute.bnd<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>biz.aQute.bnd.annotation<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>${bnd.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<h3 id="list-of-bundle-annotations">List of Bundle Annotations</h3>

<p>OSGi Bundle Annotations:</p>

<ul>
  <li><a href="https://osgi.org/specification/osgi.core/7.0.0/framework.api.html#org.osgi.annotation.bundle.Attribute"><code class="language-plaintext highlighter-rouge">@Attribute</code></a></li>
  <li><a href="https://osgi.org/specification/osgi.core/7.0.0/framework.api.html#org.osgi.annotation.bundle.Capability"><code class="language-plaintext highlighter-rouge">@Capability</code></a></li>
  <li><a href="https://osgi.org/specification/osgi.core/7.0.0/framework.api.html#org.osgi.annotation.bundle.Directive"><code class="language-plaintext highlighter-rouge">@Directive</code></a></li>
  <li><a href="https://osgi.org/specification/osgi.core/7.0.0/framework.api.html#org.osgi.annotation.bundle.Export"><code class="language-plaintext highlighter-rouge">@Export</code></a></li>
  <li><a href="https://osgi.org/specification/osgi.core/7.0.0/framework.api.html#org.osgi.annotation.bundle.Header"><code class="language-plaintext highlighter-rouge">@Header</code></a></li>
  <li><a href="https://osgi.org/specification/osgi.core/7.0.0/framework.api.html#org.osgi.annotation.bundle.Requirement"><code class="language-plaintext highlighter-rouge">@Requirement</code></a></li>
  <li>Many OSGi Specifications also define their own <em>custom bundle annotations</em>
    <ul>
      <li><a href="https://osgi.org/specification/osgi.cmpn/7.0.0/service.cm.html#org.osgi.service.cm.annotations.RequireConfigurationAdmin"><code class="language-plaintext highlighter-rouge">@RequireConfigurationAdmin</code></a></li>
      <li><a href="https://osgi.org/specification/osgi.cmpn/7.0.0/service.metatype.html#org.osgi.service.metatype.annotations.RequireMetaTypeExtender"><code class="language-plaintext highlighter-rouge">@RequireMetaTypeExtender</code></a></li>
      <li><a href="https://osgi.org/specification/osgi.cmpn/7.0.0/service.metatype.html#org.osgi.service.metatype.annotations.RequireMetaTypeImplementation"><code class="language-plaintext highlighter-rouge">@RequireMetaTypeImplementation</code></a></li>
      <li><a href="https://osgi.org/specification/osgi.cmpn/7.0.0/service.component.html#org.osgi.service.component.annotations.RequireServiceComponentRuntime"><code class="language-plaintext highlighter-rouge">@RequireServiceComponentRuntime</code></a></li>
      <li><a href="https://osgi.org/specification/osgi.cmpn/7.0.0/service.event.html#org.osgi.service.event.annotations.RequireEventAdmin"><code class="language-plaintext highlighter-rouge">@RequireEventAdmin</code></a></li>
      <li><a href="https://osgi.org/specification/osgi.cmpn/7.0.0/service.jpa.html#org.osgi.service.jpa.annotations.RequireJPAExtender"><code class="language-plaintext highlighter-rouge">@RequireJPAExtender</code></a></li>
      <li><a href="https://osgi.org/specification/osgi.cmpn/7.0.0/service.http.whiteboard.html#org.osgi.service.http.whiteboard.annotations.RequireHttpWhiteboard"><code class="language-plaintext highlighter-rouge">@RequireHttpWhiteboard</code></a></li>
      <li><a href="https://osgi.org/specification/osgi.cmpn/7.0.0/service.configurator.html#org.osgi.service.configurator.annotations.RequireConfigurator"><code class="language-plaintext highlighter-rouge">@RequireConfigurator</code></a></li>
      <li><a href="https://osgi.org/specification/osgi.cmpn/7.0.0/service.jaxrs.html#org.osgi.service.jaxrs.whiteboard.annotations.RequireJaxrsWhiteboard"><code class="language-plaintext highlighter-rouge">@RequireJaxrsWhiteboard</code></a></li>
      <li><a href="https://osgi.org/specification/osgi.cmpn/7.0.0/service.jaxrs.html#org.osgi.service.jaxrs.whiteboard.propertytypes.JSONRequired"><code class="language-plaintext highlighter-rouge">@JSONRequired</code></a></li>
      <li><a href="https://osgi.org/specification/osgi.enterprise/7.0.0/service.cdi.html#org.osgi.service.cdi.annotations.RequireCDIExtender"><code class="language-plaintext highlighter-rouge">@RequireCDIExtender</code></a></li>
      <li><a href="https://osgi.org/specification/osgi.enterprise/7.0.0/service.cdi.html#org.osgi.service.cdi.annotations.RequireCDIImplementation"><code class="language-plaintext highlighter-rouge">@RequireCDIImplementation</code></a></li>
    </ul>
  </li>
</ul>

<p>Bnd Bundle Annotations:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">@BundleCategory</code> â€“ Sets the bundle category, existing categories are defined in an enum.</li>
  <li><code class="language-plaintext highlighter-rouge">@BundleContributors</code> â€“ Creates an OSGi header for contributors that maps to the Maven contributors element.</li>
  <li><code class="language-plaintext highlighter-rouge">@BundleCopyright</code> â€“ Sets the copyright header.</li>
  <li><code class="language-plaintext highlighter-rouge">@BundleDevelopers</code> â€“ Creates an OSGi header for developers that maps to the Maven developers element.</li>
  <li><code class="language-plaintext highlighter-rouge">@BundleDocUrl</code> â€“ Provides a documentation URL.</li>
  <li><code class="language-plaintext highlighter-rouge">@BundleLicense</code> -  Creates entries in the <code class="language-plaintext highlighter-rouge">Bundle-License</code> header.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">@ASL_2_0</code></li>
      <li><code class="language-plaintext highlighter-rouge">@BSD_2_Clause</code></li>
      <li><code class="language-plaintext highlighter-rouge">@BSD_3_Clause</code></li>
      <li><code class="language-plaintext highlighter-rouge">@CDDL_1_0</code></li>
      <li><code class="language-plaintext highlighter-rouge">@CPL_1_0</code></li>
      <li><code class="language-plaintext highlighter-rouge">@EPL_1_0</code></li>
      <li><code class="language-plaintext highlighter-rouge">@GPL_2_0</code></li>
      <li><code class="language-plaintext highlighter-rouge">@GPL_3_0</code></li>
      <li><code class="language-plaintext highlighter-rouge">@LGPL_2_1</code></li>
      <li><code class="language-plaintext highlighter-rouge">@MIT_1_0</code></li>
      <li><code class="language-plaintext highlighter-rouge">@MPL_2_0</code></li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">@ServiceConsumer</code> - Generates requirements in support of the consumer side of the <a href="https://osgi.org/specification/osgi.cmpn/7.0.0/service.loader.html">Service Loader Mediator</a> specification.</li>
  <li><code class="language-plaintext highlighter-rouge">@ServiceProvider</code> - Generates requirements and capabilities in support of the provider side of the <a href="https://osgi.org/specification/osgi.cmpn/7.0.0/service.loader.html">Service Loader Mediator</a> specification. Also generates <code class="language-plaintext highlighter-rouge">META-INF/service</code> descriptors.</li>
</ul>

			</div>
	</ul>

	
<nav class=next-prev>
	<a href='/release//chapters/220-contracts.html'></a> <a href='/release//chapters/235-accessor-properties.html'></a>
</nav>
<footer class="container12" style="border-top: 1px solid black;padding:10px 0">
	<ul span=12 row>
		<li span=12>
			<ul>
				<li><a href="/release//">Home</a>
			</ul>
	</ul>
</footer>

</body>
</html>
