<!DOCTYPE html>
<html lang="en" ng-app="jpm">

	<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="/releases/4.1.0/css/style.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="/js/releases.js"></script>
<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Instruction</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="Instruction" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A bnd instruction is a property that starts with a minus sign (‘-‘). An instruction instructs bndlib to do something, in general providing parameters to the code. All instructions in bndlib are listed later in this page." />
<meta property="og:description" content="A bnd instruction is a property that starts with a minus sign (‘-‘). An instruction instructs bndlib to do something, in general providing parameters to the code. All instructions in bndlib are listed later in this page." />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-10-12T20:06:21-04:00" />
<script type="application/ld+json">
{"headline":"Instruction","dateModified":"2019-10-12T20:06:21-04:00","datePublished":"2019-10-12T20:06:21-04:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"/releases/4.1.0/chapters/820-instructions.html"},"url":"/releases/4.1.0/chapters/820-instructions.html","description":"A bnd instruction is a property that starts with a minus sign (‘-‘). An instruction instructs bndlib to do something, in general providing parameters to the code. All instructions in bndlib are listed later in this page.","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->



















































		<style>
			 body {
				counter-reset: h1 25;
			}
		</style>




















</head>


<body>


<ul class="container12 menu-bar">
	<li span=11><a class=menu-link href="/releases/4.1.0/"><img
			class=menu-logo src='/releases/4.1.0/img/bnd-80x40-white.png'></a>
			<a href="/releases/4.1.0/chapters/110-introduction.html">Intro
			</a><a href="/releases/4.1.0/chapters/800-headers.html">Headers
			</a><a href="/releases/4.1.0/chapters/825-instructions-ref.html">Instructions
			</a><a href="/releases/4.1.0/chapters/855-macros-ref.html">Macros
			</a><a href="/releases/4.1.0/chapters/860-commands.html">Commands
			</a><div class="releases"><button class="dropbtn">4.1.0</button><div class="dropdown-content"></div></div>

	<li class=menu-link span=1>
			<a href="https://github.com/bndtools/bnd" target="_"><img
	style="position:absolute;top:0;right:0;margin:0;padding:0;z-index:100"
	src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67"
	alt="Fork me on GitHub"
	data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
</ul>




	<ul class=container12>
		<li span=3>
			<div>
			<ul class="side-nav">


			<li><a href="/releases/4.1.0/chapters/110-introduction.html">Introduction</a>



			<li><a href="/releases/4.1.0/chapters/120-install.html">How to install bnd</a>



			<li><a href="/releases/4.1.0/chapters/123-tour-workspace.html">Guided Tour</a>



			<li><a href="/releases/4.1.0/chapters/125-tour-features.html">Guided Tour Workspace & Projects</a>



			<li><a href="/releases/4.1.0/chapters/130-concepts.html">Concepts</a>



			<li><a href="/releases/4.1.0/chapters/140-best-practices.html">Best practices</a>



			<li><a href="/releases/4.1.0/chapters/150-build.html">Build</a>



			<li><a href="/releases/4.1.0/chapters/160-jars.html">Generating JARs</a>



			<li><a href="/releases/4.1.0/chapters/170-versioning.html">Versioning</a>



			<li><a href="/releases/4.1.0/chapters/180-baselining.html">Baselining</a>



			<li><a href="/releases/4.1.0/chapters/200-components.html">Service Components</a>



			<li><a href="/releases/4.1.0/chapters/210-metatype.html">Metatype</a>



			<li><a href="/releases/4.1.0/chapters/220-contracts.html">Contracts</a>



			<li><a href="/releases/4.1.0/chapters/230-manifest-annotations.html">Manifest Annotations</a>



			<li><a href="/releases/4.1.0/chapters/250-resolving.html">Resolving Dependencies</a>



			<li><a href="/releases/4.1.0/chapters/300-launching.html">Launching</a>



			<li><a href="/releases/4.1.0/chapters/310-testing.html">Testing</a>



			<li><a href="/releases/4.1.0/chapters/320-packaging.html">Packaging Applications</a>



			<li><a href="/releases/4.1.0/chapters/390-wrapping.html">Wrapping Libraries to OSGi Bundles</a>



			<li><a href="/releases/4.1.0/chapters/400-commandline.html">From the command line</a>



			<li><a href="/releases/4.1.0/chapters/600-developer.html">For Developers</a>



			<li><a href="/releases/4.1.0/chapters/610-plugin.html">Plugins</a>



			<li><a href="/releases/4.1.0/chapters/700-tools.html">Tools bound to bnd</a>



			<li><a href="/releases/4.1.0/chapters/800-headers.html">Header Reference</a>



			<li class=selected>Instruction



			<li><a href="/releases/4.1.0/chapters/825-instructions-ref.html">Instruction Index</a>



			<li><a href="/releases/4.1.0/chapters/850-macros.html">Macro Reference</a>



			<li><a href="/releases/4.1.0/chapters/855-macros-ref.html">Macro Index</a>



			<li><a href="/releases/4.1.0/chapters/860-commands.html">Command Reference</a>



			<li><a href="/releases/4.1.0/chapters/870-plugins.html">Plugins Reference</a>



			<li><a href="/releases/4.1.0/chapters/880-settings.html">Settings</a>



			<li><a href="/releases/4.1.0/chapters/900-errors.html">Errors</a>



			<li><a href="/releases/4.1.0/chapters/910-warnings.html">Warnings</a>



			<li><a href="/releases/4.1.0/chapters/920-faq.html">Frequently Asked Questions</a>


</ul>

			</div>

		<li span=9>
			<div class=notes-margin>
				<h1> Instruction</h1>
				<p>A bnd instruction is a property that starts with a minus sign (‘-‘). An instruction instructs bndlib to do something, in general providing parameters to the code. All instructions in bndlib are listed later in this page.</p>

<h2 id="syntax">Syntax</h2>

<p>Almost all bndlib instructions follow the general OSGi syntax. However, the bndlib syntax is in general a bit more relaxed, for example you can use either single quotes (‘’’) or double quotes (‘”’) while OSGi only allows double quotes. Dangling comma’s and some other not exactly correct headers are accepted by bndlib without complaining. Values without quotes are accepted as long as they cannot confuse the general syntax. For example, a value like 1.20 does not have to be quoted since the period (‘.’) cannot confuse the parser on that place, however, a value like [1.3,4) must be quoted since it contains a comma.</p>

<p>In this mannual we adhere to the same conventions as the OSGi specification. This is mostly reflected in the names for the terminals in the syntax specifications. As a reminder we repeat the syntax rules and common terminals:</p>

<ul>
  <li><code class="highlighter-rouge">*</code> – Repetition of the previous element zero or more times, e.g. <code class="highlighter-rouge">( ',' element ) *</code></li>
  <li><code class="highlighter-rouge">+</code> – Repetition one or more times</li>
  <li><code class="highlighter-rouge">?</code> – Previous element is optional</li>
  <li><code class="highlighter-rouge">( ... )</code> – Grouping</li>
  <li>‘…’ – Literal</li>
  <li><code class="highlighter-rouge">|</code> – Or</li>
  <li><code class="highlighter-rouge">[...]</code> – Set (one of)</li>
  <li><code class="highlighter-rouge">..</code> – Range</li>
  <li><code class="highlighter-rouge">&lt;...&gt;</code> – Externally defined token, followed with a description</li>
  <li><code class="highlighter-rouge">~</code> – Not, negation</li>
</ul>

<p>The following terminals are pre-defined:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ws               ::= &lt;see Character.isWhitespace&gt;
digit            ::= [0..9]
alpha            ::= [a..zA..Z]
alphanum         ::= alpha | digit
token            ::= ( alphanum | '_' | '-' )+
number           ::= digit+
jletter          ::= &lt;see [JSL][1] for JavaLetter&gt;
jletterordigit   ::= &lt;See [JLS][1] for JavaLetterOrDigit &gt;
qname            ::= &lt;See [JLS][1] for fully qualified class name &gt;
identifier       ::= jletter jletterordigit *
extended         ::= ( alphanum | '_' | '-' | '.' )+
quoted-string-d  ::= '"' ( ~["\#x0D#x0A#x00] | '\"'|'\')* '"'
quoted-string-s  ::= ''' ( ~['\#x0D#x0A#x00] | '\''|'\')* '''
quoted-string    ::= quoted-string-s | quoted-string-d
special-chars    ::= ~["\#x0D#x0A#x00:=;,&lt;See [JLS][1] for whitespace&gt;]
path             ::= special-chars+ | quoted-string
value            ::= quoted-string | path
argument         ::= extended  | quoted-string
parameter        ::= directive | attribute
directive        ::= extended ':=' argument
attribute        ::= extended '=' argument
parameters       ::= parameter ( ',' parameter ) *
unique-name      ::= identifier ( '.' identifier )*
symbolic-name    ::= token('.'token)*
package-name     ::= unique-name

version          ::= major( '.' minor ( '.' micro ( '.' qualifier )? )? )?
major            ::= number
minor            ::= number
micro            ::= number
qualifier        ::= ( alphanum | '_' | '-' )+

version-range    ::= interval | atleast
interval         ::= ( '[' | '(' ) floor ',' ceiling ( ']' | ')' )
atleast          ::= version
floor            ::= version
ceiling          ::= version
</code></pre></div></div>

<p>White spaces between terminals are ignored unless specifically noted. The only exception is the directive, a directive must be connected to the colon (‘:’). That is, bndlib stores attributes and directives in the same map and distinguishes them by the fact that directives end in a colon and attributes do not. For example, using a directive like <code class="highlighter-rouge">foo; path := http://www.xyz.com</code> will not work correctly because the <code class="highlighter-rouge">path :</code> is not a valid attribute nor directive name. Any value that contains a space, a tab, a comma, colon, semicolon, equal sign or any other character that is part of a terminal in the grammar must be quoted.</p>

<p>Almost all bndlib instructions follow the general OSGi syntax for a header.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-instruction     ::= parameters
parameters       ::= clause ( ',' clause ) *
clause           ::= path ( ';' path ) *
                          ( ';' parameter ) *
</code></pre></div></div>

<p>There are a number of short-cuts that are regularly used in bnd commands:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>list             ::= value ( ',' value ) *
url              ::= &lt;URL&gt;
file-path        ::= &lt;file path, using / as separator&gt;
</code></pre></div></div>

<h2 id="merged-instructions">Merged Instructions</h2>

<p>Most instructions that accept multiple clauses are <em>merged instructions</em>. A merged instruction is an instruction which is specified by its prefix but which will merge any property that starts with this prefix followed by a period (‘.’). For example, the <em>base instruction</em> <code class="highlighter-rouge">-plugin</code> instruction accepts <code class="highlighter-rouge">-plugin.git</code> as well. The reason for this merging is that allows to append the base instruction with instructions from other files. For example, the bnd file in the <code class="highlighter-rouge">cnf/ext</code> directory are automatically included in the properties of the workspace. Since there can be many files, there would be a need to coordinate the using of a singleton base instruction. As always, singletons suck and in this case we solved it with merged instructions.</p>

<p>Some instructions put, sometimes very subtle, semantics on their ordering. To prevent different results from run to run, we make order the merge properties by placing the base instruction in front and then followed by the values from the other keys in lexically sorted order. For example, <code class="highlighter-rouge">-a</code>, <code class="highlighter-rouge">-a.x</code>, and <code class="highlighter-rouge">-a.Z</code>, and <code class="highlighter-rouge">-a.1</code> will concatenate the clauses in the order <code class="highlighter-rouge">-a,-a.1,-a.Z,-a.x</code>.</p>

<p>Each of the constituents of the merged properties can be empty, this is properly handled by bndlib and will not create a an empty clause as would easily happen when the same thing was done with macros. Empty clauses can help when there is an optionality that depends on some condition.</p>

<p>As an example, lets set the <code class="highlighter-rouge">-buildpath</code> instruction:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-buildpath: com.example.foo;version=1.2

-buildpath.extra: ${if;${debug};com.example.foo.debug\;version=1.2}
</code></pre></div></div>

<p>This will result in a buildpath of (when debug is not false) of: <code class="highlighter-rouge">com.example.foo;version=1.2, com.example.foo.debug;version=1.2</code>.</p>

<h2 id="selector">SELECTOR</h2>

<p>If a value in an instruction has a <em>scope</em> then you will be able to use a <em>selector</em>. A scope is a well defined, finite, set. For example, if you use the ‘-exportcontents’ instruction you can specify the packages that can be exported. Since you can only export the packages that are inside your bundle, the scope is the set of package names that were collected so far.</p>

<p>The syntax for a selector is:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>selector ::= '!' ?
             '=' ?
                  '*' | ( '.' | '?' | '|' | '$' | . | other ) *
             ( '.*' ) ?
             ( ':i' ) ?
</code></pre></div></div>

<p>A selector is an expression that is matched against all members of the scope. For example, <code class="highlighter-rouge">com.example.*</code> will match any package name that starts with <code class="highlighter-rouge">com.example</code>, for example <code class="highlighter-rouge">com.example.foo</code>, as well as <code class="highlighter-rouge">com.example</code> itself. The syntax used to describe the wildcarding is based on a globbing kind model, however, the selector is translated into a regular expression according to some simple rules.</p>

<p>The replacement rules to build the regular expression are as follows:</p>

<ul>
  <li><code class="highlighter-rouge">*</code> – Is replaced with <code class="highlighter-rouge">.*</code>, matching any number of characters, triggers wildcard match.</li>
  <li><code class="highlighter-rouge">?</code> - Is replaced with <code class="highlighter-rouge">.?</code>, matching any character, triggers wildcard match.</li>
  <li><code class="highlighter-rouge">|</code> – Is inserted as is, triggers wildcard match.</li>
  <li><code class="highlighter-rouge">$</code> – Escaped to <code class="highlighter-rouge">\$</code>.</li>
  <li><code class="highlighter-rouge">.</code> – The dot is treated as a package segment separator. It is escaped with <code class="highlighter-rouge">\.</code>. However, if the match ends with <code class="highlighter-rouge">.*</code>, the replacement will be <code class="highlighter-rouge">(\..*)?</code>.  This triggers a wildcard match.</li>
</ul>

<p>If you want to go ballistic with regular expressions, then you can go ahead. As long as the wildcards are triggered by one of the defined characters, the replaced string will be used as a regular expression.</p>

<p>If the selector ends with <code class="highlighter-rouge">:i</code> then a case insensitive match is requested, this will ignore any case differences.</p>

<p>A selector can be prefixed with an exclamation mark, this indicates that a match must be treated as a removal operation. To understand removal, it is necessary to realize that the selectors are not declarative, the order of the selectors is relevant.</p>

<p>When bndlib has a scope, it will iterator over each element in the scope and then for element it will iterator over each selector. If there is a match on the scope member then it is always removed from the scope, it will not be matched against later selectors. If the selector starts with an exclamation mark then the member is removed. but it is not treated as a result. Ergo, the exclamation mark allows you to remove members before they are actually matched.</p>

<p>For example, you want to match all implementation packages (i.e. they have <code class="highlighter-rouge">impl</code> in their name) except when they start with <code class="highlighter-rouge">com.example</code>. This can be achieved with:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>!com.example.*impl*, *.impl.*
</code></pre></div></div>

<p>Last, and also least, you can prefix the selector with an equal sign (‘=’) (after the exclamation mark if one is present). This will signal a literal match with the string, no globbing will be done.</p>

<p>The way the period (‘.’) is treated is kind of special. The reason is that people expect that the selector <code class="highlighter-rouge">com.example.*</code> actually includes the package <code class="highlighter-rouge">com.example</code> itself. In bndlib this has always been the case although the OSGi Alliance later decided to not follow this pattern when there was a need for the globbing of packages.</p>

<p>In this example, the first selector will remove any match and ignore it, the second selector now only sees scope members that are fitting in the earlier pattern.</p>

<p>Selectors are used in virtually any place where there is a reasonable scope. It is a very powerful feature. However, it is also easy to go overboard. If you find you need to use this feature excessively then you are likely overdoing it.</p>

<h2 id="file">FILE</h2>

<p>One of the most painful thing in making bndlib run anywhere is handling of files. Even though Java has a decent abstraction of the file system, problems with spaces in file names and backslashes in the wrong place have caused an uneven amount of bugs. Ok, this partially because most bndlib developers tend to use Macs, still no excuse and quite embarrassing.</p>

<p>Since bnd files need to be portable across environments we’ve chosen to use the Unix file separator, the slash (or solidus ‘/’) for more reasons than I can reasonably sum up here (what was Bill smoking when he picked the reverse solidus for file separator!). In bndlib, all file paths (ok, should) always go through a single method that actually parses it and turns it into a Java File object. This allows us to support a number of features in a portable way. The syntax of a file path is therefore:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>file      ::=  ( '~/' | '/' )?  (  ~['/']+ '/' ) * ~['/'] *
</code></pre></div></div>

<p>If a file path starts with:</p>

<ul>
  <li>A slash (‘/’) then we go to the root of the current directory’s file system. Sorry, there is no way for a windows user to specify another file system since this would break portability.</li>
  <li>’~/’, then the remainder of the file path is relative to the user’s home directory as defined by Java. To keep your workspace portable, make sure you do not store any information there that might break the build for others. However, this can be useful to store passwords etc.</li>
  <li>Anything else, then the path is relative. It depends in the context what the used root is of the path. In general, if there is a local file that creates this path, then the parent directory of this file is the root. Otherwise, if this path is used in relation a workspace, project, build, or bndrun then the <em>base</em> of each of these entities is used as the root. In other cases it is the actual working directory of the process.</li>
</ul>

<p>You can use the ‘..’ operator for a segment in the file path to indicate a parent directory. It is highly advised to always use relative addressing to keep your workspace portable. However, there are a number of macros that can be used as anchors:</p>

<ul>
  <li><code class="highlighter-rouge">${p}</code>, `${project} – The directory of the current project</li>
  <li><code class="highlighter-rouge">${workspace}</code> – The directory of the current workspace</li>
  <li><code class="highlighter-rouge">${build} – The directory of the </code>cnf` directory.</li>
</ul>

<h2 id="filespec">FILESPEC</h2>

<p>A <code class="highlighter-rouge">FILESPEC</code> defines a set of files relative to a starting point. It can be identical to a FILE for a single file but it has some special syntax to recurse directories. For example, the FILESPEC <code class="highlighter-rouge">foo/bar/**/spec/*.ts</code> finds all files that end in <code class="highlighter-rouge">spec/*.ts</code> somewhere below the <code class="highlighter-rouge">foo/bar</code> directory.</p>

<p>The syntax is as follows:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>FILESPEC  ::= filespec ( ',' filespec )*
filespec  ::= ( segment '/' ) filematch
segment   ::= '**' | GLOB
filematch ::= '**' | '**' GLOB | GLOB
</code></pre></div></div>

<p>If a segment is <code class="highlighter-rouge">**</code> then it will match any directory to any depth. Otherwise it must be a GLOB expression, which can also be a literal. The last segment is the <code class="highlighter-rouge">filematch</code>. This is a GLOB expression on a file name. As a convenience, if it is <code class="highlighter-rouge">**</code>, any file will match in any directory and if it starts with something like <code class="highlighter-rouge">**.ts</code> then it will also recurse and match on <code class="highlighter-rouge">*.ts</code>. That is, the following rules apply to the <code class="highlighter-rouge">filematch</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>prefix/**              prefix/**/*
prefix/**.ts           prefix/**/*.ts
</code></pre></div></div>

<h2 id="path">PATH</h2>

<p>A PATH is a <em>repository specification</em>. It is a specification for a number of JARs and/or bundles from a repository (well, most of the time). A PATH has the following syntax:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PATH      ::= target ( ',' target ) *
target    ::= ( entry | FILE ';' 'version' '=' 'file' )
              ( ';' PARAMETERS ) *
entry     ::= symbolic-name ( ';' version ) ?
version	  ::= 'version' '='
              ( RANGE | 'latest' | 'project')
</code></pre></div></div>

<p>A PATH defines a number of bundles with its <em>entries</em>. Each entry is either a FILE or a symbolic-name. If only a symbolic name is specified, the default will be the import range from 0.0.0. This selects the whole repository for the given symbolic name. Outside the default, the repository entry can be specified in the following ways:</p>

<ul>
  <li>RANGE – A version range limits the entries selected from the active repositories.</li>
  <li><code class="highlighter-rouge">latest</code> – Use the project’s output or, if the project does not exists, get the bundle with the highest version from the repositories.</li>
  <li><code class="highlighter-rouge">project</code> – Mandate the use of the project’s output</li>
</ul>

<h2 id="glob">GLOB</h2>

<p>A <em>glob</em> is a pattern that can be matched against a candidate to see if it <em>matches</em>. To match multiple candidates with
one pattern, the pattern is allowed to contain <em>wildcard</em> characters. A wildcard character is a stand in for zero or
more other characters. For example, a glob like <code class="highlighter-rouge">*.xml</code> matches any name that ends with <code class="highlighter-rouge">.xml</code>, the asterisk <code class="highlighter-rouge">*</code> stands
in for zero or more characters. Therefore, it matches <code class="highlighter-rouge">foo.xml</code>, <code class="highlighter-rouge">xml.xml.xml</code>, but also just <code class="highlighter-rouge">.xml</code>. The other
wildchar is the question mark (<code class="highlighter-rouge">?</code>) which matches exactly one character. For example, <code class="highlighter-rouge">???.xml</code> matches <code class="highlighter-rouge">abc.xml</code> but not <code class="highlighter-rouge">a.xml</code>
or <code class="highlighter-rouge">.xml</code>.</p>

<p>Sometimes it is necessary to match against a number of strings. The vertical bar (<code class="highlighter-rouge">|</code>) can separate these strings. For
example, <code class="highlighter-rouge">abc|def|ghi</code> matches any of <code class="highlighter-rouge">abc</code>, <code class="highlighter-rouge">def</code>, or <code class="highlighter-rouge">ghi</code>.</p>

<p>It is also possible to <em>group</em> strings inside the pattern using parentheses. For example, <code class="highlighter-rouge">foo(a|b)bar</code> matches <code class="highlighter-rouge">fooabar</code>
or <code class="highlighter-rouge">foobbar</code>.</p>

<p>The glob also supports character classes with the square brackets <code class="highlighter-rouge">[</code> and <code class="highlighter-rouge">]</code>. Characters between the square brackets
literally match to any character at that position. These character classes also form a group. For example, <code class="highlighter-rouge">foo[abc]bar</code> matches
<code class="highlighter-rouge">fooabar</code>, <code class="highlighter-rouge">foobbar</code>, or <code class="highlighter-rouge">foocbar</code>.</p>

<p>Groups can be repeated using a question mark (cardinality 0..1), the asterisk (cardinality 0..n), or the plus sign (cardinality 1..n). For example, <code class="highlighter-rouge">(a)*</code>
matches <code class="highlighter-rouge">aaaa</code> but also the empty string. If the standard <em>cardinalities</em> do not suffice, then a group can be suffixed by a
cardinality specification using the curly braces (<code class="highlighter-rouge">{</code> and <code class="highlighter-rouge">}</code>). Inside the curly braces the lower bound and the optional upper
bound can be specified. If no upper bound is specified then the lower bound is also the upper bound.
For example, <code class="highlighter-rouge">(?i)([0-9A-F][0-9A-F]){20}</code> matches a 40 digit SHA digest in hex regardless of case.</p>

<p>There are some special characters that get special treatment:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>special ::= '{' | '}' | '|' | '+' | '*' | '?' | '(' | ')' | '[' | ']'
</code></pre></div></div>

<p>These characters can be escaped with a reverse solidus (<code class="highlighter-rouge">\</code>) to override their special meaning, they will then be matched literally. To
escape a long string,  it is possible to place <code class="highlighter-rouge">\Q</code> at the beginning of a block that needs to be escaped and <code class="highlighter-rouge">\E</code> at the end.
For example, <code class="highlighter-rouge">foo\Q*****\Ebar</code></p>

<p>Some examples:</p>

<p>+——————–+————————————–+————————————–+
| Glob               | Regular Expression                   | Matches                              |
+——————–+————————————–+————————————–+
| <code class="highlighter-rouge">abc.ts</code>           | <code class="highlighter-rouge">abc\.ts</code>                            | <code class="highlighter-rouge">abc.ts</code>                             |
+——————–+————————————–+————————————–+
| <code class="highlighter-rouge">*.ts</code>             | <code class="highlighter-rouge">.*\.ts</code>                             | <code class="highlighter-rouge">abc.ts, def.ts</code>                     |
+——————–+————————————–+————————————–+
| <code class="highlighter-rouge">foo***bar</code>        | <code class="highlighter-rouge">foo.*.*.*bar</code>                       | <code class="highlighter-rouge">foobar, fooXbar, fooXXXXbar</code>        |
+——————–+————————————–+————————————–+
| <code class="highlighter-rouge">foo(A|B|C)*bar</code>   | <code class="highlighter-rouge">foo(A|B|C)*bar</code>                     | <code class="highlighter-rouge">fooAbar, fooBBBAbar,fooCbar</code>        |
+——————–+————————————–+————————————–+
| <code class="highlighter-rouge">foo\{\}bar</code>       |  <code class="highlighter-rouge">foo\{\}bar</code>                        | <code class="highlighter-rouge">foo{}bar</code>                           |
+——————–+————————————–+————————————–+
| <code class="highlighter-rouge">xx(?i)xx</code>         |  <code class="highlighter-rouge">xx(?i)xx</code>                          | <code class="highlighter-rouge">xxXx</code>, <code class="highlighter-rouge">xxXX</code>, <code class="highlighter-rouge">xxxx</code>               |
+——————–+————————————–+————————————–+</p>

<h2 id="special-cases">Special Cases</h2>

<p>Some instruction use the GLOB but provide some convenience. For example, the package selectors of Export-Package et. al.
detect a case like <code class="highlighter-rouge">com.example.*</code> and turn it into a regular expression that matches <code class="highlighter-rouge">com.example.foo</code> but also matches
<code class="highlighter-rouge">com.example</code>. This is generally explained in the instruction.</p>

<h2 id="mapping-a-glob-to-a-regular-expression">Mapping a Glob to a Regular Expression</h2>

<p>This section defines how globs are mapped to regular expressions. Although the globs are quite intuitive to use,
they do expose all regular expression capabilities. A strong advice is to keep it simple. The mapping itself
is actually non-trivial and takes a number of heuristics that can easily go wrong. Basically, if you need this
section you’re likely doing something that is too complex.</p>

<p>For backward compatibility reasons, we support the unix like glob style for or’ing like <code class="highlighter-rouge">{a,b,c}</code>. However, it is
recommended to use the form using the vertical bar since it is more flexible and closer to regular expressions.</p>

<p>A glob is mapped to a regular expression character by character. During this traversal the following states are kept:</p>

<ul>
  <li><code class="highlighter-rouge">SIMPLE</code> – Basic simple glob form. This is the default.</li>
  <li><code class="highlighter-rouge">CURLIES</code>– Inside a curly braces group that is not a cardinality specification. Curly braces can be nested.</li>
  <li><code class="highlighter-rouge">QUOTED</code> – Inside a <code class="highlighter-rouge">\Q...\E</code> block (cannot be nested)</li>
  <li><code class="highlighter-rouge">BRACKETS</code> – Inside a character group enclosed by square brackets (cannot be nested).</li>
</ul>

<p>Character sets:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>escaped     ::= `.` | `$` | `^` | `@` | `%`
special     ::= `?` | `*` | `+`
end         ::= ')' | ']' | '}'
start       ::= '('
</code></pre></div></div>

<p>Escaped characters are escaped in SIMPLE mode and CURLIES mode. In QUOTED or BRACKETS mode no escaping is done. For example
<code class="highlighter-rouge">^$</code> becomes <code class="highlighter-rouge">\^\$</code> matching literally <code class="highlighter-rouge">^$</code>. However, <code class="highlighter-rouge">[^$]</code> becomes <code class="highlighter-rouge">[^$]</code>, matching anything but a dollar sign. In QUOTED
and BRACKETS mode, also the <code class="highlighter-rouge">special</code>, <code class="highlighter-rouge">end</code>, and <code class="highlighter-rouge">start</code> sets are directly inserted without any special handling.</p>

<p>In the SIMPLE and CURLIES mode the <code class="highlighter-rouge">special</code> characters require special handling. For these remaining mappings it is important
to realize that there are <em>groups</em>. There are parenthesized groups, bracketed group, and curly braces groups. For
example, <code class="highlighter-rouge">(a|b)</code>, <code class="highlighter-rouge">[abcd]</code>, or <code class="highlighter-rouge">{a,b,c}</code> respectively. If curly braces are used after a group then it is a quantifier and <em>not</em> considered a group. That is, <code class="highlighter-rouge">{a,b}</code> is
considered a group but <code class="highlighter-rouge">[a,b]{1,2}</code> then the <code class="highlighter-rouge">{1,2}</code> is a quantifier and not a group.</p>

<p>So when a <code class="highlighter-rouge">special</code> character is preceded with a group, it is inserted without any special processing. If it is not
preceded then the following rules apply:</p>

<ul>
  <li><code class="highlighter-rouge">*</code> – mapped to <code class="highlighter-rouge">.*</code>, this matches any number of characters</li>
  <li><code class="highlighter-rouge">?</code> – mapped to <code class="highlighter-rouge">.</code>, this matches one character</li>
  <li><code class="highlighter-rouge">+</code> – mapped to <code class="highlighter-rouge">\+</code>, matches a plus sign!</li>
</ul>

<p>Some examples:</p>

<p>+———–+———————+
| Glob      | Regular Expression  |
+———–+———————+
| <code class="highlighter-rouge">*</code>       | <code class="highlighter-rouge">.*</code>                |
+———–+———————+
| <code class="highlighter-rouge">(a)*</code>    | <code class="highlighter-rouge">(a)*</code>              |
+———–+———————+
| <code class="highlighter-rouge">[abc]+</code>  | <code class="highlighter-rouge">[abc]+</code>            |
+———–+———————+
| <code class="highlighter-rouge">.</code>       | <code class="highlighter-rouge">\.</code>                |
+———–+———————+
| <code class="highlighter-rouge">[.*+|]</code>  | <code class="highlighter-rouge">[.*+|]</code>            |
+———–+———————+
| <code class="highlighter-rouge">+</code>       | <code class="highlighter-rouge">\+</code>                |
+———–+———————+
| <code class="highlighter-rouge">(x|y)+</code>  | <code class="highlighter-rouge">(x|y)+</code>            |
+———–+———————+
| <code class="highlighter-rouge">{x,y}</code>   | <code class="highlighter-rouge">(?:x|y)</code>           |
+———–+———————+
| <code class="highlighter-rouge">{[xa],y}</code>| <code class="highlighter-rouge">(?:[xa]|y)</code>        |
+———–+———————+
| <code class="highlighter-rouge">(?:foo)</code> | <code class="highlighter-rouge">(?:foo)</code>           |
+———–+———————+
| <code class="highlighter-rouge">{foo}</code>   | <code class="highlighter-rouge">(?:foo)</code>           |
+———–+———————+
| <code class="highlighter-rouge">[\p{Lower}]</code>| <code class="highlighter-rouge">[\p{Lower}]</code>    |
+———–+———————+
| <code class="highlighter-rouge">[a-z&amp;&amp;[^bc]]</code>| <code class="highlighter-rouge">[a-z&amp;&amp;[^bc]]</code>  |
+———–+———————+</p>

			</div>
	</ul>


<nav class=next-prev>
	<a href='/releases/4.1.0/chapters/800-headers.html'></a> <a href='/releases/4.1.0/chapters/825-instructions-ref.html'></a>
</nav>
<footer class="container12" style="border-top: 1px solid black;padding:10px 0">
	<ul span=12 row>
		<li span=3>
			<ul>
				<li><a href="/releases/4.1.0/contact.html">Contact</a>
			</ul>
		<li span=3>
			<ul>
				<li><a href="/releases/4.1.0/">Developers</a>
			</ul>
		<li span=3>
			<ul>
				<li><a href="/releases/4.1.0/">More</a>
			</ul>
	</ul>
</footer>

</body>
</html>
