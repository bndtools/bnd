<!DOCTYPE html>
<html lang="en" ng-app="jpm">

	<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="/css/style.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="/js/releases.js"></script>

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>-consumer-policy VERSION-MASK | bnd</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="-consumer-policy VERSION-MASK" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The -consumer-policy instruction defines the semantic versioning policy to be used when a type is a consumer. A consumer is in general a type that is implemented by classes that are just users of the package. In contrast, a provider is the party that is basically responsible for the contract defined in the package. For example, when you implement Event Admin, the org.osgi.service.event package is your responsibility so the types you need to implement like EventAdmin are provider types. (These types are annotated with a @ProviderType annotation.) A casual user of the Event Admin service will be a consumer, the EventHandler type is therefore annotated with a@ConsumerType." />
<meta property="og:description" content="The -consumer-policy instruction defines the semantic versioning policy to be used when a type is a consumer. A consumer is in general a type that is implemented by classes that are just users of the package. In contrast, a provider is the party that is basically responsible for the contract defined in the package. For example, when you implement Event Admin, the org.osgi.service.event package is your responsibility so the types you need to implement like EventAdmin are provider types. (These types are annotated with a @ProviderType annotation.) A casual user of the Event Admin service will be a consumer, the EventHandler type is therefore annotated with a@ConsumerType." />
<meta property="og:site_name" content="bnd" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="-consumer-policy VERSION-MASK" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"The -consumer-policy instruction defines the semantic versioning policy to be used when a type is a consumer. A consumer is in general a type that is implemented by classes that are just users of the package. In contrast, a provider is the party that is basically responsible for the contract defined in the package. For example, when you implement Event Admin, the org.osgi.service.event package is your responsibility so the types you need to implement like EventAdmin are provider types. (These types are annotated with a @ProviderType annotation.) A casual user of the Event Admin service will be a consumer, the EventHandler type is therefore annotated with a@ConsumerType.","headline":"-consumer-policy VERSION-MASK","url":"/instructions/consumer_policy.html"}</script>
<!-- End Jekyll SEO tag -->


	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

</head>


<body>

	
<ul class="container12 menu-bar" style="display:flex;align-items:center">
	<li span=8><a class=menu-link href="/"><img
			class=menu-logo src="/img/bnd-80x40-white.png"></a>
			<a href="/chapters/110-introduction.html">Intro
			</a><a href="/chapters/800-headers.html">Headers
			</a><a href="/chapters/825-instructions-ref.html">Instructions
			</a><a href="/chapters/855-macros-ref.html">Macros
			</a><a href="/chapters/400-commands.html">Commands
			</a><div class="releases">
			         <button class="dropbtn"><span class="fa fa-bars"></span> master</button>
			         <div class="dropdown-content"></div>
			   </div>
    <li span=4>     
        <div class="search-container">
			<form method="get" id="search" action="https://google.com/search" target="_blank">
			    <input type="hidden" name="as_q" value="site:bndtools.org OR site:bnd.discourse.group"/>
			    <input type="text" name="q" placeholder="Search…" aria-label="Search https://google.com for bnd specific"/>
			    <button type="submit" class="fa fa-search"></button>
            </form>
       </div>
</ul>
<div class=menu-link span=0><script>
    window.onload = function() {
      var currentURL = window.location.href;
      var regex = /https:\/\/bnd.bndtools.org\/(.*\.html)/;
      var matches = currentURL.match(regex);
      var filePath = matches[1];
	  if (filePath.includes("/")) 
		  filePath = "_" + filePath;
      var markdownFileURL = 'https://github.com/bndtools/bnd/blob/master/docs/' + filePath.replace(".html", ".md");
      var repoLink = document.getElementById('repo-link');
      repoLink.href = markdownFileURL;		
    };
</script>

<a id="repo-link" href="https://github.com/bndtools/bnd/docs/" target="_"><img
	style="position:absolute;top:0;right:0;margin:0;padding:0;z-index:100"
	src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67"
	alt="Fork me on GitHub"
	data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
</div>



					

	<ul class=container12>
		<li span=3>
			<div>
			<ul class="side-nav">
	
		
			<li><a href="/chapters/110-introduction.html">Introduction</a>
	  	
  	
		
			<li><a href="/chapters/120-install.html">How to install bnd</a>
	  	
  	
		
			<li><a href="/chapters/123-tour-workspace.html">Guided Tour</a>
	  	
  	
		
			<li><a href="/chapters/125-tour-features.html">Guided Tour Workspace & Projects</a>
	  	
  	
		
			<li><a href="/chapters/130-concepts.html">Concepts</a>
	  	
  	
		
			<li><a href="/chapters/140-best-practices.html">Best practices</a>
	  	
  	
		
			<li><a href="/chapters/150-build.html">Build</a>
	  	
  	
		
			<li><a href="/chapters/155-project-setup.html">Project Setup</a>
	  	
  	
		
			<li><a href="/chapters/160-jars.html">Generating JARs</a>
	  	
  	
		
			<li><a href="/chapters/170-versioning.html">Versioning</a>
	  	
  	
		
			<li><a href="/chapters/180-baselining.html">Baselining</a>
	  	
  	
		
			<li><a href="/chapters/200-components.html">Service Components</a>
	  	
  	
		
			<li><a href="/chapters/210-metatype.html">Metatype</a>
	  	
  	
		
			<li><a href="/chapters/220-contracts.html">Contracts</a>
	  	
  	
		
			<li><a href="/chapters/230-manifest-annotations.html">Bundle Annotations</a>
	  	
  	
		
			<li><a href="/chapters/235-accessor-properties.html">Accessor Properties</a>
	  	
  	
		
			<li><a href="/chapters/240-spi-annotations.html">SPI Annotations</a>
	  	
  	
		
			<li><a href="/chapters/250-resolving.html">Resolving Dependencies</a>
	  	
  	
		
			<li><a href="/chapters/300-launching.html">Launching</a>
	  	
  	
		
			<li><a href="/chapters/305-startlevels.html">Startlevels</a>
	  	
  	
		
			<li><a href="/chapters/310-testing.html">Testing</a>
	  	
  	
		
			<li><a href="/chapters/315-launchpad-testing.html">Testing with Launchpad</a>
	  	
  	
		
			<li><a href="/chapters/320-packaging.html">Packaging Applications</a>
	  	
  	
		
			<li><a href="/chapters/330-jpms.html">JPMS Libraries</a>
	  	
  	
		
			<li><a href="/chapters/390-wrapping.html">Wrapping Libraries to OSGi Bundles</a>
	  	
  	
		
			<li><a href="/chapters/395-generating-documentation.html">Generating Documentation</a>
	  	
  	
		
			<li><a href="/chapters/400-commands.html">Commands</a>
	  	
  	
		
			<li><a href="/chapters/600-developer.html">For Developers</a>
	  	
  	
		
			<li><a href="/chapters/650-windows.html">Tips for Windows users</a>
	  	
  	
		
			<li><a href="/chapters/700-tools.html">Tools bound to bnd</a>
	  	
  	
		
			<li><a href="/chapters/790-reference.html">Reference</a>
	  	
  	
		
			<li><a href="/chapters/800-headers.html">Headers</a>
	  	
  	
		
			<li><a href="/chapters/820-instructions.html">Instruction Reference</a>
	  	
  	
		
			<li><a href="/chapters/825-instructions-ref.html">Instruction Index</a>
	  	
  	
		
			<li><a href="/chapters/850-macros.html">Macro Reference</a>
	  	
  	
		
			<li><a href="/chapters/855-macros-ref.html">Macro Index</a>
	  	
  	
		
			<li><a href="/chapters/870-plugins.html">Plugins</a>
	  	
  	
		
			<li><a href="/chapters/875-external-plugins.html">External Plugins</a>
	  	
  	
		
			<li><a href="/chapters/880-settings.html">Settings</a>
	  	
  	
		
			<li><a href="/chapters/900-errors.html">Errors</a>
	  	
  	
		
			<li><a href="/chapters/910-warnings.html">Warnings</a>
	  	
  	
		
			<li><a href="/chapters/920-faq.html">Frequently Asked Questions</a>
	  	
  	
</ul>

			</div>
			
		<li span=9>
			<div class=notes-margin>
			
				<h1> -consumer-policy VERSION-MASK               
                 <div class="pageclass" onclick="window.location.href='/chapters/790-reference.html';">
                     Project
                   </div>
                     
				</h1>
				<p>The <code class="language-plaintext highlighter-rouge">-consumer-policy</code> instruction defines the semantic versioning policy to be used when a type is a <em>consumer</em>. A consumer is in general a type that is implemented by classes that are just users of the package. In contrast, a <em>provider</em> is the party that is basically responsible for the contract defined in the package. For example, when you implement Event Admin, the org.osgi.service.event package is your responsibility so the types you need to implement like <code class="language-plaintext highlighter-rouge">EventAdmin</code> are <em>provider types</em>. (These types are annotated with a <code class="language-plaintext highlighter-rouge">@ProviderType</code> annotation.) A casual user of the Event Admin service will be a consumer, the <code class="language-plaintext highlighter-rouge">EventHandler</code> type is therefore annotated with a<code class="language-plaintext highlighter-rouge">@ConsumerType</code>.</p>

<p>The purpose of this distinction is <a href="/chapters/170-versioning.html">semantic versioning</a>. It turns out that the relation between a consumer and a provider is not symmetric. A provider is tightly bound to a contract while a consumer is expected to have backward compatibility. Virtually any change to the contract requires the provider to adapt while a consumer is in almost all cases protect against changes.</p>

<p>This asymmetry has a consequence for the semantic versioning. In the OSGi, the semantics are defined that a micro change does not affect the provider nor the consumer. A minor change affects the provider, and a major change affects both. Therefore, a bundle that implements a provider type must import a range from <code class="language-plaintext highlighter-rouge">major.minor.micro</code> … <code class="language-plaintext highlighter-rouge">major.minor+1.0</code>. A bundle that implements a consumer type must import    <code class="language-plaintext highlighter-rouge">major.minor.micro</code> … <code class="language-plaintext highlighter-rouge">major+1.0.0</code>.</p>

<p>In theory, bnd could have hard coded these policies but there are always cases where the policy is just not right. The <code class="language-plaintext highlighter-rouge">-consumer-policy</code> specifies the macro to use for calculating the version range. The default definition is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-consumer-policy ${range;[==,+)} 
-provider-policy ${range;[==,=+)}
</code></pre></div></div>

<p>The <a href="/macros/range.html">range</a> macro works very much like the <a href="/macros/version.html">version</a> macro. It uses a template to define a change the range/version.</p>

<p>The provider and consumer policy are global and this is not very convenient if you want to make an exception just for a specific bundle. For example, a bundle coming from <a href="https://twitter.com/1ovthafew/status/705011392861114368">Gavin King’s Ceylon</a>. For this reason, you can also specify a policy on an import:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Import-Package com.gavinking.*;version="${range;[--,++)}", * 	
</code></pre></div></div>

<p>The counterpart of the <code class="language-plaintext highlighter-rouge">-consumer-policy</code> is of course the <a href="/instructions/provider_policy.html">-provider-policy</a>.</p>


			</div>
	</ul>

	
<nav class=next-prev>
	<a href='/instructions/connection-settings.html'></a> <a href='/instructions/contract.html'></a>
</nav>
<footer class="container12" style="border-top: 1px solid black;padding:10px 0">
	<ul span=12 row>
		<li span=12>
			<ul>
				<li><a href="/">GitHub</a>
			</ul>
	</ul>
</footer>

</body>
</html>
