<!DOCTYPE html>
<html lang="en" ng-app="jpm">

	<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="/css/style.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="/js/releases.js"></script>

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>-maven-release (‘local’ ‘remote’) ( ‘,’ option )* | bnd</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="-maven-release (‘local’ ‘remote’) ( ‘,’ option )*" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The -maven-release instruction provides the context for a release to Maven repository. In the Maven world it is customary that a release has a JAR with sources and a JAR with Javadoc. In the OSGi world this is unnecessary because the sources can be packaged inside the bundle. (Since the source is placed at a standard location, the IDEs can take advantage of this.) However, putting an artifact on Maven Central requires that these extra JARs are included. This instruction allows you to specify additional parameters for this release process." />
<meta property="og:description" content="The -maven-release instruction provides the context for a release to Maven repository. In the Maven world it is customary that a release has a JAR with sources and a JAR with Javadoc. In the OSGi world this is unnecessary because the sources can be packaged inside the bundle. (Since the source is placed at a standard location, the IDEs can take advantage of this.) However, putting an artifact on Maven Central requires that these extra JARs are included. This instruction allows you to specify additional parameters for this release process." />
<meta property="og:site_name" content="bnd" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="-maven-release (‘local’ ‘remote’) ( ‘,’ option )*" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"The -maven-release instruction provides the context for a release to Maven repository. In the Maven world it is customary that a release has a JAR with sources and a JAR with Javadoc. In the OSGi world this is unnecessary because the sources can be packaged inside the bundle. (Since the source is placed at a standard location, the IDEs can take advantage of this.) However, putting an artifact on Maven Central requires that these extra JARs are included. This instruction allows you to specify additional parameters for this release process.","headline":"-maven-release (‘local’ ‘remote’) ( ‘,’ option )*","url":"/instructions/maven-release.html"}</script>
<!-- End Jekyll SEO tag -->


	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

</head>


<body>

	
<ul class="container12 menu-bar" style="display:flex;align-items:center">
	<li span=8><a class=menu-link href="/"><img
			class=menu-logo src="/img/bnd-80x40-white.png"></a>
			<a href="/chapters/110-introduction.html">Intro
			</a><a href="/chapters/800-headers.html">Headers
			</a><a href="/chapters/825-instructions-ref.html">Instructions
			</a><a href="/chapters/855-macros-ref.html">Macros
			</a><a href="/chapters/400-commands.html">Commands
			</a><div class="releases">
			         <button class="dropbtn"><span class="fa fa-bars"></span> master</button>
			         <div class="dropdown-content"></div>
			   </div>
    <li span=4>     
        <div class="search-container">
			<form method="get" id="search" action="https://google.com/search" target="_blank">
			    <input type="hidden" name="as_q" value="site:bndtools.org OR site:bnd.discourse.group"/>
			    <input type="text" name="q" placeholder="Search…" aria-label="Search https://google.com for bnd specific"/>
			    <button type="submit" class="fa fa-search"></button>
            </form>
       </div>
</ul>
<div class=menu-link span=0><script>
    window.onload = function() {
      var currentURL = window.location.href;
      var regex = /https:\/\/bnd.bndtools.org\/(.*\.html)/;
      var matches = currentURL.match(regex);
      var filePath = matches[1];
	  if (filePath.includes("/")) 
		  filePath = "_" + filePath;
      var markdownFileURL = 'https://github.com/bndtools/bnd/blob/master/docs/' + filePath.replace(".html", ".md");
      var repoLink = document.getElementById('repo-link');
      repoLink.href = markdownFileURL;		
    };
</script>

<a id="repo-link" href="https://github.com/bndtools/bnd/docs/" target="_"><img
	style="position:absolute;top:0;right:0;margin:0;padding:0;z-index:100"
	src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67"
	alt="Fork me on GitHub"
	data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
</div>



					

	<ul class=container12>
		<li span=3>
			<div>
			<ul class="side-nav">
	
		
			<li><a href="/chapters/110-introduction.html">Introduction</a>
	  	
  	
		
			<li><a href="/chapters/120-install.html">How to install bnd</a>
	  	
  	
		
			<li><a href="/chapters/123-tour-workspace.html">Guided Tour</a>
	  	
  	
		
			<li><a href="/chapters/125-tour-features.html">Guided Tour Workspace & Projects</a>
	  	
  	
		
			<li><a href="/chapters/130-concepts.html">Concepts</a>
	  	
  	
		
			<li><a href="/chapters/140-best-practices.html">Best practices</a>
	  	
  	
		
			<li><a href="/chapters/150-build.html">Build</a>
	  	
  	
		
			<li><a href="/chapters/155-project-setup.html">Project Setup</a>
	  	
  	
		
			<li><a href="/chapters/160-jars.html">Generating JARs</a>
	  	
  	
		
			<li><a href="/chapters/170-versioning.html">Versioning</a>
	  	
  	
		
			<li><a href="/chapters/180-baselining.html">Baselining</a>
	  	
  	
		
			<li><a href="/chapters/200-components.html">Service Components</a>
	  	
  	
		
			<li><a href="/chapters/210-metatype.html">Metatype</a>
	  	
  	
		
			<li><a href="/chapters/220-contracts.html">Contracts</a>
	  	
  	
		
			<li><a href="/chapters/230-manifest-annotations.html">Bundle Annotations</a>
	  	
  	
		
			<li><a href="/chapters/235-accessor-properties.html">Accessor Properties</a>
	  	
  	
		
			<li><a href="/chapters/240-spi-annotations.html">SPI Annotations</a>
	  	
  	
		
			<li><a href="/chapters/250-resolving.html">Resolving Dependencies</a>
	  	
  	
		
			<li><a href="/chapters/300-launching.html">Launching</a>
	  	
  	
		
			<li><a href="/chapters/305-startlevels.html">Startlevels</a>
	  	
  	
		
			<li><a href="/chapters/310-testing.html">Testing</a>
	  	
  	
		
			<li><a href="/chapters/315-launchpad-testing.html">Testing with Launchpad</a>
	  	
  	
		
			<li><a href="/chapters/320-packaging.html">Packaging Applications</a>
	  	
  	
		
			<li><a href="/chapters/330-jpms.html">JPMS Libraries</a>
	  	
  	
		
			<li><a href="/chapters/390-wrapping.html">Wrapping Libraries to OSGi Bundles</a>
	  	
  	
		
			<li><a href="/chapters/395-generating-documentation.html">Generating Documentation</a>
	  	
  	
		
			<li><a href="/chapters/400-commands.html">Commands</a>
	  	
  	
		
			<li><a href="/chapters/600-developer.html">For Developers</a>
	  	
  	
		
			<li><a href="/chapters/650-windows.html">Tips for Windows users</a>
	  	
  	
		
			<li><a href="/chapters/700-tools.html">Tools bound to bnd</a>
	  	
  	
		
			<li><a href="/chapters/790-reference.html">Reference</a>
	  	
  	
		
			<li><a href="/chapters/800-headers.html">Headers</a>
	  	
  	
		
			<li><a href="/chapters/820-instructions.html">Instruction Reference</a>
	  	
  	
		
			<li><a href="/chapters/825-instructions-ref.html">Instruction Index</a>
	  	
  	
		
			<li><a href="/chapters/850-macros.html">Macro Reference</a>
	  	
  	
		
			<li><a href="/chapters/855-macros-ref.html">Macro Index</a>
	  	
  	
		
			<li><a href="/chapters/870-plugins.html">Plugins</a>
	  	
  	
		
			<li><a href="/chapters/875-external-plugins.html">External Plugins</a>
	  	
  	
		
			<li><a href="/chapters/880-settings.html">Settings</a>
	  	
  	
		
			<li><a href="/chapters/900-errors.html">Errors</a>
	  	
  	
		
			<li><a href="/chapters/910-warnings.html">Warnings</a>
	  	
  	
		
			<li><a href="/chapters/920-faq.html">Frequently Asked Questions</a>
	  	
  	
</ul>

			</div>
			
		<li span=9>
			<div class=notes-margin>
			
				<h1> -maven-release ('local'|'remote') ( ',' option )*               
                 <div class="pageclass" onclick="window.location.href='/chapters/790-reference.html';">
                     Project
                   </div>
                     
				</h1>
				<p>The <code class="language-plaintext highlighter-rouge">-maven-release</code> instruction provides the context for a release to Maven repository. In the Maven world it is customary that a release has a JAR with sources and a JAR with Javadoc. In the OSGi world this is unnecessary because the sources can be packaged inside the bundle. (Since the source is placed at a standard location, the IDEs can take advantage of this.) However, putting an artifact on Maven Central requires that these extra JARs are included. This instruction allows you to specify additional parameters for this release process.</p>

<p>Though this instruction is not specific for a plugin, it was developed in conjunction with the <a href="/plugins/maven">Maven Bnd Repository Plugin</a>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-maven-release ::= ( 'local'|'remote' ( ';' snapshot )? ) ( ',' option )*
snapshot       ::= &lt;value to be used for timestamp&gt;
option         ::= sources | javadoc | pom | sign | archive*
archive          ::= 'archive' 
                   ( ';path=' ( PATH | '{' PATH '}' )?
                   ( ';classifier=' maven-classifier )?
sources        ::= 'sources' 
                   ( ';path=' ( 'NONE' | PATH ) )?
                   ( ';force=' ( 'true' | 'false' ) )?
                   ( ';-sourcepath=' PATH ( ',' PATH )* )?
javadoc        ::= 'javadoc'
                   ( ';path=' ( 'NONE' | PATH ) )?
                   ( ';packages=' ( 'EXPORTS' | 'ALL' ) )?
                   ( ';force=' ( 'true' | 'false' ) )?
                   ( ';' javadoc-option )*
javadoc-option ::= '-' NAME '=' VALUE
pom            ::= 'pom'
                   ( ';path=' ( 'JAR' | PATH ) )?
sign            ::= 'sign'
                   ( ';passphrase=' VALUE )?
</code></pre></div></div>

<p>If <code class="language-plaintext highlighter-rouge">sources</code> or <code class="language-plaintext highlighter-rouge">javadoc</code> has the attribute <code class="language-plaintext highlighter-rouge">force=true</code>, either one will be release to the maven repository even if no <code class="language-plaintext highlighter-rouge">releaseUrl</code> or <code class="language-plaintext highlighter-rouge">snapshotUrl</code> is set or <code class="language-plaintext highlighter-rouge">maven-release=local</code>.</p>

<p>The <code class="language-plaintext highlighter-rouge">aQute.maven.bnd.MavenBndRepository</code> is a bnd plugin that represent the local and a remote Maven repository. The locations of both repositories can be configured. The local repository is always used as a cache for the remote repository.</p>

<p>For a detailed configuration of the <a href="/plugins/maven">Maven Bnd Repository Plugin</a>, please look at the documentation page.</p>

<p>If the Maven Bnd Repository is asked to put a file, it will look up the <code class="language-plaintext highlighter-rouge">-maven-release</code> instruction using merged properties. The property is looked up from the bnd file that built the artifact. However, it should in general be possible to define this header in the workspace using macros like <code class="language-plaintext highlighter-rouge">${project}</code> to specify relative paths.</p>

<p>The <code class="language-plaintext highlighter-rouge">archive</code> option provides a way to add additional files/archives to release. A Maven release always has a pom and then a number of files/archives that are separated by a <em>classifier</em>. The default classifier is generally the jar file. Special classifiers are reserved for the sources and the javadoc.</p>

<p>The <code class="language-plaintext highlighter-rouge">archive</code> option takes the following parameters:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">path</code> : The path to the file that will be placed in the release directory. If the path is surrounded by curly braces, it will be pre-processed.</li>
  <li><code class="language-plaintext highlighter-rouge">classifier</code> : The classifier of the file. This is the maven classifier used.</li>
</ul>

<p>For example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> -maven-release \
       archive;\
        path=files/feature.json;
        classifier=feature
</code></pre></div></div>

<h1 id="signing">Signing</h1>

<p>If the instruction contains the sign attribute  and release build is detected the repository tries to apply <a href="https://gnupg.org/">gnupg</a> via a command process to create <code class="language-plaintext highlighter-rouge">.asc</code> files for all deployed artifacts. This requires a Version of <a href="https://gnupg.org/">gnupg</a> installed on your build system. By default it uses the <code class="language-plaintext highlighter-rouge">gpg</code> command. If the <code class="language-plaintext highlighter-rouge">passphrase</code> is configured, it will hand it over to the command as standard input. The command will be constructed as follows: <code class="language-plaintext highlighter-rouge">gpg --batch --passphrase-fd 0 --output &lt;filetosign&gt;.asc --detach-sign --armor &lt;filetosign&gt;</code>. Some newer gnupg versions will ignore the passphrase via standard input for the first try and ask again with password screen. This will crash the process. Have a look <a href="https://stackoverflow.com/questions/19895122/how-to-use-gnupgs-passphrase-fd-argument">here</a> to teach gnupg otherwise. The command can be exchanged or amended with additional options by defining a property named <code class="language-plaintext highlighter-rouge">gpg</code> in your workspace (e.g. <code class="language-plaintext highlighter-rouge">build.bnd</code> or somewhere in the ext directory).</p>

<p>Example config could look like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># use the env macro to avoid to set the passphrase somehwere in your project
-maven-release: pom,sign;passphrase=${env;GNUPG_PASSPHRASE}
gpg: gpg --homedir /mnt/n/tmp/gpg/.gnupg --pinentry-mode loopback
</code></pre></div></div>


			</div>
	</ul>

	
<nav class=next-prev>
	<a href='/instructions/maven-dependencies.html'></a> <a href='/instructions/maven-scope.html'></a>
</nav>
<footer class="container12" style="border-top: 1px solid black;padding:10px 0">
	<ul span=12 row>
		<li span=12>
			<ul>
				<li><a href="/">GitHub</a>
			</ul>
	</ul>
</footer>

</body>
</html>
