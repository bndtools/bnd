<!DOCTYPE html>
<html lang="en" ng-app="jpm">

	<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="/css/style.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="/js/releases.js"></script>

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>-prepare makespec ( ‘,’ makespec )* | bnd</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="-prepare makespec ( ‘,’ makespec )*" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An typical use case for the -prepare instruction is the generation of CSS files from a less or sccs specification. The prepare instruction will execute a number of commands in the shell before it starts the build process." />
<meta property="og:description" content="An typical use case for the -prepare instruction is the generation of CSS files from a less or sccs specification. The prepare instruction will execute a number of commands in the shell before it starts the build process." />
<meta property="og:site_name" content="bnd" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="-prepare makespec ( ‘,’ makespec )*" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"An typical use case for the -prepare instruction is the generation of CSS files from a less or sccs specification. The prepare instruction will execute a number of commands in the shell before it starts the build process.","headline":"-prepare makespec ( ‘,’ makespec )*","url":"/instructions/prepare.html"}</script>
<!-- End Jekyll SEO tag -->


	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

</head>


<body>

	
<ul class="container12 menu-bar" style="display:flex;align-items:center">
	<li span=8><a class=menu-link href="/"><img
			class=menu-logo src="/img/bnd-80x40-white.png"></a>
			<a href="/chapters/110-introduction.html">Intro
			</a><a href="/chapters/800-headers.html">Headers
			</a><a href="/chapters/825-instructions-ref.html">Instructions
			</a><a href="/chapters/855-macros-ref.html">Macros
			</a><a href="/chapters/400-commands.html">Commands
			</a><div class="releases">
			         <button class="dropbtn"><span class="fa fa-bars"></span> master</button>
			         <div class="dropdown-content"></div>
			   </div>
    <li span=4>     
        <div class="search-container">
			<form method="get" id="search" action="https://google.com/search" target="_blank">
			    <input type="hidden" name="as_q" value="site:bndtools.org OR site:bnd.discourse.group"/>
			    <input type="text" name="q" placeholder="Search…" aria-label="Search https://google.com for bnd specific"/>
			    <button type="submit" class="fa fa-search"></button>
            </form>
       </div>
</ul>
<div class=menu-link span=0><script>
    window.onload = function() {
      var currentURL = window.location.href;
      var regex = /https:\/\/bnd.bndtools.org\/(.*\.html)/;
      var matches = currentURL.match(regex);
      var filePath = matches[1];
	  if (filePath.includes("/")) 
		  filePath = "_" + filePath;
      var markdownFileURL = 'https://github.com/bndtools/bnd/blob/master/docs/' + filePath.replace(".html", ".md");
      var repoLink = document.getElementById('repo-link');
      repoLink.href = markdownFileURL;		
    };
</script>

<a id="repo-link" href="https://github.com/bndtools/bnd/docs/" target="_"><img
	style="position:absolute;top:0;right:0;margin:0;padding:0;z-index:100"
	src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67"
	alt="Fork me on GitHub"
	data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
</div>



					

	<ul class=container12>
		<li span=3>
			<div>
			<ul class="side-nav">
	
		
			<li><a href="/chapters/110-introduction.html">Introduction</a>
	  	
  	
		
			<li><a href="/chapters/120-install.html">How to install bnd</a>
	  	
  	
		
			<li><a href="/chapters/123-tour-workspace.html">Guided Tour</a>
	  	
  	
		
			<li><a href="/chapters/125-tour-features.html">Guided Tour Workspace & Projects</a>
	  	
  	
		
			<li><a href="/chapters/130-concepts.html">Concepts</a>
	  	
  	
		
			<li><a href="/chapters/140-best-practices.html">Best practices</a>
	  	
  	
		
			<li><a href="/chapters/150-build.html">Build</a>
	  	
  	
		
			<li><a href="/chapters/155-project-setup.html">Project Setup</a>
	  	
  	
		
			<li><a href="/chapters/160-jars.html">Generating JARs</a>
	  	
  	
		
			<li><a href="/chapters/170-versioning.html">Versioning</a>
	  	
  	
		
			<li><a href="/chapters/180-baselining.html">Baselining</a>
	  	
  	
		
			<li><a href="/chapters/200-components.html">Service Components</a>
	  	
  	
		
			<li><a href="/chapters/210-metatype.html">Metatype</a>
	  	
  	
		
			<li><a href="/chapters/220-contracts.html">Contracts</a>
	  	
  	
		
			<li><a href="/chapters/230-manifest-annotations.html">Bundle Annotations</a>
	  	
  	
		
			<li><a href="/chapters/235-accessor-properties.html">Accessor Properties</a>
	  	
  	
		
			<li><a href="/chapters/240-spi-annotations.html">SPI Annotations</a>
	  	
  	
		
			<li><a href="/chapters/250-resolving.html">Resolving Dependencies</a>
	  	
  	
		
			<li><a href="/chapters/300-launching.html">Launching</a>
	  	
  	
		
			<li><a href="/chapters/305-startlevels.html">Startlevels</a>
	  	
  	
		
			<li><a href="/chapters/310-testing.html">Testing</a>
	  	
  	
		
			<li><a href="/chapters/315-launchpad-testing.html">Testing with Launchpad</a>
	  	
  	
		
			<li><a href="/chapters/320-packaging.html">Packaging Applications</a>
	  	
  	
		
			<li><a href="/chapters/330-jpms.html">JPMS Libraries</a>
	  	
  	
		
			<li><a href="/chapters/390-wrapping.html">Wrapping Libraries to OSGi Bundles</a>
	  	
  	
		
			<li><a href="/chapters/395-generating-documentation.html">Generating Documentation</a>
	  	
  	
		
			<li><a href="/chapters/400-commands.html">Commands</a>
	  	
  	
		
			<li><a href="/chapters/600-developer.html">For Developers</a>
	  	
  	
		
			<li><a href="/chapters/650-windows.html">Tips for Windows users</a>
	  	
  	
		
			<li><a href="/chapters/700-tools.html">Tools bound to bnd</a>
	  	
  	
		
			<li><a href="/chapters/790-reference.html">Reference</a>
	  	
  	
		
			<li><a href="/chapters/800-headers.html">Headers</a>
	  	
  	
		
			<li><a href="/chapters/820-instructions.html">Instruction Reference</a>
	  	
  	
		
			<li><a href="/chapters/825-instructions-ref.html">Instruction Index</a>
	  	
  	
		
			<li><a href="/chapters/850-macros.html">Macro Reference</a>
	  	
  	
		
			<li><a href="/chapters/855-macros-ref.html">Macro Index</a>
	  	
  	
		
			<li><a href="/chapters/870-plugins.html">Plugins</a>
	  	
  	
		
			<li><a href="/chapters/875-external-plugins.html">External Plugins</a>
	  	
  	
		
			<li><a href="/chapters/880-settings.html">Settings</a>
	  	
  	
		
			<li><a href="/chapters/900-errors.html">Errors</a>
	  	
  	
		
			<li><a href="/chapters/910-warnings.html">Warnings</a>
	  	
  	
		
			<li><a href="/chapters/920-faq.html">Frequently Asked Questions</a>
	  	
  	
</ul>

			</div>
			
		<li span=9>
			<div class=notes-margin>
			
				<h1> -prepare makespec ( ',' makespec )*               
                 <div class="pageclass" onclick="window.location.href='/chapters/790-reference.html';">
                     Project
                   </div>
                     
				</h1>
				<p>An typical use case for the <code class="language-plaintext highlighter-rouge">-prepare</code> instruction is the generation of CSS files from a <code class="language-plaintext highlighter-rouge">less</code> or <code class="language-plaintext highlighter-rouge">sccs</code> specification. The prepare instruction will execute a number of commands in the shell before it starts the build process.</p>

<p>The commands used in the shell must work on the platform. Since the shell is so different in a Windows environment this function is not guaranteed to work.</p>

<h2 id="example">Example</h2>

<p>The following example compiles typescript code in the <code class="language-plaintext highlighter-rouge">typescript</code> directory. The output goes to <code class="language-plaintext highlighter-rouge">web/repository.js</code>. To install the <code class="language-plaintext highlighter-rouge">tsc</code> command, see <code class="language-plaintext highlighter-rouge">npm</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-prepare: \
	web/foo.js &lt;= typescript/*.ts ; \
		command:=tsc -p typescript --out $@
</code></pre></div></div>

<h2 id="syntax">Syntax</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-prepare     ::= makespec ( ',' makespec )
makespec     ::= dependency ( ';' parameter )+
dependency   ::= PATH ( '&lt;=' FILESPEC )?
parameter    ::= command | report | name | env
command      ::= 'command:=' &lt;shell&gt; # mandatory
report       ::= 'report:=' PATTERN
name         ::= 'name:=' STRING
env          ::= key '=' value
</code></pre></div></div>

<p>A <code class="language-plaintext highlighter-rouge">makespec</code> defines a dependency in the file system. It must start with a file path, this is the output file of the command.  It can be followed with a <code class="language-plaintext highlighter-rouge">dependency</code>. A <code class="language-plaintext highlighter-rouge">dependency</code> is a <code class="language-plaintext highlighter-rouge">FILESPEC</code>. The <code class="language-plaintext highlighter-rouge">FILESPEC</code> defines the set of input files to the command. If specified, then the command is only executed when the target file is older than any of the dependencies and the project bnd files.</p>

<p>It is possible to specify a <code class="language-plaintext highlighter-rouge">name</code> for the command, this name is then used for any error reporting.</p>

<p>The <code class="language-plaintext highlighter-rouge">command</code> parameter specifies the shell command. It must be a valid shell command. Any <code class="language-plaintext highlighter-rouge">$@</code> and <code class="language-plaintext highlighter-rouge">$&lt;</code> macros are replaced by the target file path and the set of files in the dependency.</p>

<table>
  <tbody>
    <tr>
      <td>The shell is supposed to support multiple commands (separate with ‘;’) and pipes (‘</td>
      <td>’). The working directory the command will run in is the project directory.</td>
    </tr>
  </tbody>
</table>

<p>Any attributes (i.e. not directives) are added as an environment variable for the command.</p>

<p>If the executed command provides diagnostic output with file names, line numbers, etc. then it is possible in some cases to report these to the IDE so the error/warning appears on the right place. This requires the specification of a regular expression. This regular expression must specify named groups. A named group is like <code class="language-plaintext highlighter-rouge">(?&lt;name&gt;.*)</code>. The expression must find error messages from the console output or the error output.</p>

<p>The following names can be used in the regular expression:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>file           relative file name
line           zero based line number
line-1         one based line number
type           `error` | `warning`
message        the message
</code></pre></div></div>

<p>For example, the report pattern for the Microsoft TypeScript compiler tsc:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"(^|\n)(?&lt;file&gt;[^(]+)\\((?&lt;line&gt;[0-9]+),(?&lt;column&gt;[0-9]+)\\):(?&lt;message&gt;[^\n]*)"
</code></pre></div></div>

<h2 id="path">Path</h2>

<p>It is possible to set the platforms command search path with the <code class="language-plaintext highlighter-rouge">-PATH</code> macro. This macro must contain a comma separated list of PATH, specifying places where to look. If this <code class="language-plaintext highlighter-rouge">-PATH</code> macro contains <code class="language-plaintext highlighter-rouge">${@}</code> then this will be replaced with the platforms current PATH. By not specifying the <code class="language-plaintext highlighter-rouge">${@}</code> it is possible to limit the available commands.</p>

			</div>
	</ul>

	
<nav class=next-prev>
	<a href='/instructions/pom.html'></a> <a href='/instructions/preprocessmatchers.html'></a>
</nav>
<footer class="container12" style="border-top: 1px solid black;padding:10px 0">
	<ul span=12 row>
		<li span=12>
			<ul>
				<li><a href="/">GitHub</a>
			</ul>
	</ul>
</footer>

</body>
</html>
