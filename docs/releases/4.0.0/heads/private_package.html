<!DOCTYPE html>
<html lang="en" ng-app="jpm">

	<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="/releases/4.0.0/css/style.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="/js/releases.js"></script>
<!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Private-Package PACKAGE-SPEC ( ‘,’ PACKAGE-SPEC )*</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Private-Package PACKAGE-SPEC ( ‘,’ PACKAGE-SPEC )*" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Private Package The method of inclusion is identical to the Export-Package header, the only difference is, is that these packages are not exported. This header will be copied to the manifest. If a package is selected by noth the export and private package headers, then the export takes precedence." />
<meta property="og:description" content="Private Package The method of inclusion is identical to the Export-Package header, the only difference is, is that these packages are not exported. This header will be copied to the manifest. If a package is selected by noth the export and private package headers, then the export takes precedence." />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-10-12T20:27:56-04:00" />
<script type="application/ld+json">
{"datePublished":"2019-10-12T20:27:56-04:00","description":"Private Package The method of inclusion is identical to the Export-Package header, the only difference is, is that these packages are not exported. This header will be copied to the manifest. If a package is selected by noth the export and private package headers, then the export takes precedence.","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"/releases/4.0.0/heads/private_package.html"},"url":"/releases/4.0.0/heads/private_package.html","headline":"Private-Package PACKAGE-SPEC ( ‘,’ PACKAGE-SPEC )*","dateModified":"2019-10-12T20:27:56-04:00","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->








































































</head>


<body>


<ul class="container12 menu-bar">
	<li span=11><a class=menu-link href="/releases/4.0.0/"><img
			class=menu-logo src='/releases/4.0.0/img/bnd-80x40-white.png'></a>
			<a href="/releases/4.0.0/chapters/110-introduction.html">Intro
			</a><a href="/releases/4.0.0/chapters/800-headers.html">Headers
			</a><a href="/releases/4.0.0/chapters/820-instructions.html">Instructions
			</a><a href="/releases/4.0.0/chapters/850-macros.html">Macros
			</a><div class="releases"><button class="dropbtn">4.0.0</button><div class="dropdown-content"></div></div>

	<li class=menu-link span=1>
			<a href="https://github.com/bndtools/bnd" target="_"><img
	style="position:absolute;top:0;right:0;margin:0;padding:0;z-index:100"
	src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67"
	alt="Fork me on GitHub"
	data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
</ul>




	<ul class=container12>
		<li span=3>
			<div>
			<ul class="side-nav">


			<li><a href="/releases/4.0.0/chapters/100-release.html">Release</a>



			<li><a href="/releases/4.0.0/chapters/110-introduction.html">Introduction</a>



			<li><a href="/releases/4.0.0/chapters/120-install.html">How to install bnd</a>



			<li><a href="/releases/4.0.0/chapters/123-tour-workspace.html">Guided Tour</a>



			<li><a href="/releases/4.0.0/chapters/125-tour-features.html">Guided Tour Workspace & Projects</a>



			<li><a href="/releases/4.0.0/chapters/130-concepts.html">Concepts</a>



			<li><a href="/releases/4.0.0/chapters/140-best-practices.html">Best practices</a>



			<li><a href="/releases/4.0.0/chapters/150-build.html">Build</a>



			<li><a href="/releases/4.0.0/chapters/160-jars.html">Generating JARs</a>



			<li><a href="/releases/4.0.0/chapters/170-versioning.html">Versioning</a>



			<li><a href="/releases/4.0.0/chapters/180-baselining.html">Baselining</a>



			<li><a href="/releases/4.0.0/chapters/200-components.html">Service Components</a>



			<li><a href="/releases/4.0.0/chapters/210-metatype.html">Metatype</a>



			<li><a href="/releases/4.0.0/chapters/220-contracts.html">Contracts</a>



			<li><a href="/releases/4.0.0/chapters/230-manifest-annotations.html">Manifest Annotations</a>



			<li><a href="/releases/4.0.0/chapters/250-resolving.html">Resolving Dependencies</a>



			<li><a href="/releases/4.0.0/chapters/300-launching.html">Launching</a>



			<li><a href="/releases/4.0.0/chapters/310-testing.html">Testing</a>



			<li><a href="/releases/4.0.0/chapters/320-packaging.html">Packaging Applications</a>



			<li><a href="/releases/4.0.0/chapters/390-wrapping.html">Wrapping Libraries to OSGi Bundles</a>



			<li><a href="/releases/4.0.0/chapters/400-commandline.html">From the command line</a>



			<li><a href="/releases/4.0.0/chapters/600-developer.html">For Developers</a>



			<li><a href="/releases/4.0.0/chapters/610-plugin.html">Plugins</a>



			<li><a href="/releases/4.0.0/chapters/700-tools.html">Tools bound to bnd</a>



			<li><a href="/releases/4.0.0/chapters/790-format.html">File Format</a>



			<li><a href="/releases/4.0.0/chapters/800-headers.html">Header Reference</a>



			<li><a href="/releases/4.0.0/chapters/820-instructions.html">Instruction</a>



			<li><a href="/releases/4.0.0/chapters/825-instructions-ref.html">Instruction Index</a>



			<li><a href="/releases/4.0.0/chapters/850-macros.html">Macro Reference</a>



			<li><a href="/releases/4.0.0/chapters/860-commands.html">Command Reference</a>



			<li><a href="/releases/4.0.0/chapters/870-plugins.html">Plugins Reference</a>



			<li><a href="/releases/4.0.0/chapters/880-settings.html">Settings</a>



			<li><a href="/releases/4.0.0/chapters/900-errors.html">Errors</a>



			<li><a href="/releases/4.0.0/chapters/910-warnings.html">Warnings</a>



			<li><a href="/releases/4.0.0/chapters/920-faq.html">Frequently Asked Questions</a>


</ul>

			<div class=enroute><a href="https://enroute.osgi.org">Supported by OSGi enRoute <img src="/releases/4.0.0/img/EnRouteIcon_CMYK.png"></a></div>
			</div>

		<li span=9>
			<div class=notes-margin>
				<h1> Private-Package PACKAGE-SPEC ( ',' PACKAGE-SPEC )*</h1>
				<h2 id="private-package">Private Package</h2>
<p>The method of inclusion is identical to the Export-Package header, the only difference is, is that these packages are not exported. This header will be copied to the manifest. If a package is selected by noth the export and private package headers, then the export takes precedence.</p>

<p>Private-Package= com.*</p>

<p>###Split packages
Bnd traverse the packages on the classpath and copies them to the output based on the instructions given by the Export-Package and Private-Package headers. This opens up for the possibility that there are multiple packages with the same name on the class path. It is better to avoid this situation because it means there is no cohesive definition of the package and it is just, eh, messy. However, there are valid cases that packages should be merged from different sources. For example, when a standard package needs to be merged with implementation code like the osgi packages sometimes (unfortunately) do. Without any extra instructions, bnd will merge multiple packages where the last one wins if the packages contain duplicate resources, but it will give a warning to notify the unwanted case of split packages.</p>

<p>The <code class="highlighter-rouge">-split-package:</code> directive on the Export-Package/Private-Package clause allows fine grained control over what should be done with split packages. The following values are architected:</p>

<table>
  <tbody>
    <tr>
      <td> </td>
      <td><code class="highlighter-rouge">merge-first</code></td>
      <td> </td>
      <td>Merge split packages but do not add resources that come later in the classpath. That is, the first resource wins. This is the default, although the default will generate a warning</td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td><code class="highlighter-rouge">merge-last</code></td>
      <td> </td>
      <td>Merge split packages but overwrite resources that come earlier in the classpath. That is, the last resource wins.</td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td><code class="highlighter-rouge">first</code></td>
      <td> </td>
      <td>Do not merge, only use the first package found</td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td><code class="highlighter-rouge">error</code></td>
      <td> </td>
      <td>Generate an error when a split package is detected</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>For example:</p>

<p>Private-Package: test.pack;-split-package:=merge-first</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>private void doExpand(Jar dot) {

	// Build an index of the class path that we can then
	// use destructively
	MultiMap&lt;String,Jar&gt; packages = new MultiMap&lt;String,Jar&gt;();
	for (Jar srce : getClasspath()) {
		dot.updateModified(srce.lastModified, srce + " (" + srce.lastModifiedReason + ")");
		for (Entry&lt;String,Map&lt;String,Resource&gt;&gt; e : srce.getDirectories().entrySet()) {
			if (e.getValue() != null)
				packages.add(e.getKey(), srce);
		}
	}

	Parameters privatePackages = getPrivatePackage();
	if (isTrue(getProperty(Constants.UNDERTEST))) {
		String h = getProperty(Constants.TESTPACKAGES, "test;presence:=optional");
		privatePackages.putAll(parseHeader(h));
	}

	if (!privatePackages.isEmpty()) {
		Instructions privateFilter = new Instructions(privatePackages);
		Set&lt;Instruction&gt; unused = doExpand(dot, packages, privateFilter);

		if (!unused.isEmpty()) {
			warning("Unused " + Constants.PRIVATE_PACKAGE + " instructions, no such package(s) on the class path: %s", unused);
		}
	}

	Parameters exportedPackage = getExportPackage();
	if (!exportedPackage.isEmpty()) {
		Instructions exportedFilter = new Instructions(exportedPackage);

		// We ignore unused instructions for exports, they should show
		// up as errors during analysis. Otherwise any overlapping
		// packages with the private packages should show up as
		// unused

		doExpand(dot, packages, exportedFilter);
	}
}






	/**
 * Allow any local initialization by subclasses before we build.
 */
public void init() throws Exception {
	begin();
	doRequireBnd();

	// Check if we have sensible setup

	if (getClasspath().size() == 0
			&amp;&amp; (getProperty(EXPORT_PACKAGE) != null || getProperty(EXPORT_PACKAGE) != null || getProperty(PRIVATE_PACKAGE) != null || getProperty(PRIVATEPACKAGE) != null))
		warning("Classpath is empty. " + Constants.PRIVATE_PACKAGE + " (-privatepackage) and " + EXPORT_PACKAGE + " can only expand from the classpath when there is one");

}



	/**
 * Check if the given resource is in scope of this bundle. That is, it
 * checks if the Include-Resource includes this resource or if it is a class
 * file it is on the class path and the Export-Package or Private-Package
 * include this resource.
 *
 * @param f
 * @return
 */
public boolean isInScope(Collection&lt;File&gt; resources) throws Exception {
	Parameters clauses = parseHeader(getProperty(Constants.EXPORT_PACKAGE));
	clauses.putAll(parseHeader(getProperty(Constants.PRIVATE_PACKAGE)));
	clauses.putAll(parseHeader(getProperty(Constants.PRIVATEPACKAGE)));
	if (isTrue(getProperty(Constants.UNDERTEST))) {
		clauses.putAll(parseHeader(getProperty(Constants.TESTPACKAGES, "test;presence:=optional")));
	}

	Collection&lt;String&gt; ir = getIncludedResourcePrefixes();

	Instructions instructions = new Instructions(clauses);

	for (File r : resources) {
		String cpEntry = getClasspathEntrySuffix(r);

		if (cpEntry != null) {

			if (cpEntry.equals("")) // Meaning we actually have a CPE
				return true;

			String pack = Descriptors.getPackage(cpEntry);
			Instruction i = matches(instructions, pack, null, r.getName());
			if (i != null)
				return !i.isNegated();
		}

		// Check if this resource starts with one of the I-C header
		// paths.
		String path = r.getAbsolutePath();
		for (String p : ir) {
			if (path.startsWith(p))
				return true;
		}
	}
	return false;
}
</code></pre></div></div>


			</div>
	</ul>


<nav class=next-prev>
	<a href='/releases/4.0.0/heads/meta_persistence.html'></a> <a href='/releases/4.0.0/heads/provide_capabaility.html'></a>
</nav>
<footer class="container12" style="border-top: 1px solid black;padding:10px 0">
	<ul span=12 row>
		<li span=3>
			<ul>
				<li><a href="/releases/4.0.0/contact.html">Contact</a>
			</ul>
		<li span=3>
			<ul>
				<li><a href="/releases/4.0.0/">Developers</a>
			</ul>
		<li span=3>
			<ul>
				<li><a href="/releases/4.0.0/">More</a>
			</ul>
	</ul>
</footer>

</body>
</html>
